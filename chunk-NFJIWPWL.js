import{Ca as hr,Fa as St,La as yc,a as hc,b as dc,ba as mc,ea as gc,f as A,ha as ur,ic as Ic,ja as _c,jc as vc,k as xi,la as Ke,p as fc,q as pc,s as Vi,sa as lr,t as Li,u as Mi}from"./chunk-FDHTTD3A.js";var wc=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},lh=function(n){let e=[],t=0,r=0;for(;t<n.length;){let s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){let o=n[t++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){let o=n[t++],c=n[t++],l=n[t++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{let o=n[t++],c=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},Tc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){let o=n[s],c=s+1<n.length,l=c?n[s+1]:0,d=s+2<n.length,f=d?n[s+2]:0,E=o>>2,b=(o&3)<<4|l>>4,S=(l&15)<<2|f>>6,D=f&63;d||(D=64,c||(S=64)),r.push(t[E],t[b],t[S],t[D])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(wc(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lh(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){let o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;let f=s<n.length?t[n.charAt(s)]:64;++s;let b=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||f==null||b==null)throw new Ui;let S=o<<2|l>>4;if(r.push(S),f!==64){let D=l<<4&240|f>>2;if(r.push(D),b!==64){let k=f<<6&192|b;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ui=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},hh=function(n){let e=wc(n);return Tc.encodeByteArray(e,!0)},mn=function(n){return hh(n).replace(/\./g,"")},qi=function(n){try{return Tc.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function dh(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var fh=()=>dh().__FIREBASE_DEFAULTS__,ph=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mh=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&qi(n[1]);return e&&JSON.parse(e)},fr=()=>{try{return fh()||ph()||mh()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ac=n=>{var e,t;return(t=(e=fr())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},bc=n=>{let e=Ac(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},$i=()=>{var n;return(n=fr())===null||n===void 0?void 0:n.config},Sc=n=>{var e;return(e=fr())===null||e===void 0?void 0:e[`_${n}`]};var dr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Rc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[mn(JSON.stringify(t)),mn(JSON.stringify(c)),""].join(".")}function Ie(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Pc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ie())}function gh(){var n;let e=(n=fr())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Cc(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Dc(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kc(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Nc(){return!gh()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zi(){try{return typeof indexedDB=="object"}catch{return!1}}function Oc(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var _h="FirebaseError",we=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=_h,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Le.prototype.create)}},Le=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?yh(o,r):"Error",l=`${this.serviceName}: ${c} (${s}).`;return new we(s,l,r)}};function yh(n,e){return n.replace(Ih,(t,r)=>{let s=e[r];return s!=null?String(s):`<${r}?>`})}var Ih=/\{\$([^}]+)}/g;function Rt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let s of t){if(!r.includes(s))return!1;let o=n[s],c=e[s];if(Ec(o)&&Ec(c)){if(!Rt(o,c))return!1}else if(o!==c)return!1}for(let s of r)if(!t.includes(s))return!1;return!0}function Ec(n){return n!==null&&typeof n=="object"}function ji(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xc(n,e){let t=new Bi(n,e);return t.subscribe.bind(t)}var Bi=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");vh(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Fi),s.error===void 0&&(s.error=Fi),s.complete===void 0&&(s.complete=Fi);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function vh(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fi(){}var $m=4*60*60*1e3;function Se(n){return n&&n._delegate?n._delegate:n}var Te=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var at="[DEFAULT]";var Gi=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new dr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),s=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wh(e))try{this.getOrInitializeService({instanceIdentifier:at})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let s=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=at){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return A(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=at){return this.instances.has(e)}getOptions(e=at){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,c]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(o);r===l&&c.resolve(s)}return s}onInit(e,t){var r;let s=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(s,o);let c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Eh(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=at){return this.component?this.component.multipleInstances?e:at:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Eh(n){return n===at?void 0:n}function wh(n){return n.instantiationMode==="EAGER"}var pr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Gi(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Th=[],M=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(M||{}),Ah={debug:M.DEBUG,verbose:M.VERBOSE,info:M.INFO,warn:M.WARN,error:M.ERROR,silent:M.SILENT},bh=M.INFO,Sh={[M.DEBUG]:"log",[M.VERBOSE]:"log",[M.INFO]:"info",[M.WARN]:"warn",[M.ERROR]:"error"},Rh=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),s=Sh[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},He=class{constructor(e){this.name=e,this._logLevel=bh,this._logHandler=Rh,this._userLogHandler=null,Th.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in M))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ah[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,M.DEBUG,...e),this._logHandler(this,M.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,M.VERBOSE,...e),this._logHandler(this,M.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,M.INFO,...e),this._logHandler(this,M.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,M.WARN,...e),this._logHandler(this,M.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,M.ERROR,...e),this._logHandler(this,M.ERROR,...e)}};var Ph=(n,e)=>e.some(t=>n instanceof t),Vc,Lc;function Ch(){return Vc||(Vc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Dh(){return Lc||(Lc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Mc=new WeakMap,Ki=new WeakMap,Fc=new WeakMap,Wi=new WeakMap,Qi=new WeakMap;function kh(n){let e=new Promise((t,r)=>{let s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(Re(n.result)),s()},c=()=>{r(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Mc.set(t,n)}).catch(()=>{}),Qi.set(e,n),e}function Nh(n){if(Ki.has(n))return;let e=new Promise((t,r)=>{let s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});Ki.set(n,e)}var Hi={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ki.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Fc.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Re(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Uc(n){Hi=n(Hi)}function Oh(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(mr(this),e,...t);return Fc.set(r,e.sort?e.sort():[e]),Re(r)}:Dh().includes(n)?function(...e){return n.apply(mr(this),e),Re(Mc.get(this))}:function(...e){return Re(n.apply(mr(this),e))}}function xh(n){return typeof n=="function"?Oh(n):(n instanceof IDBTransaction&&Nh(n),Ph(n,Ch())?new Proxy(n,Hi):n)}function Re(n){if(n instanceof IDBRequest)return kh(n);if(Wi.has(n))return Wi.get(n);let e=xh(n);return e!==n&&(Wi.set(n,e),Qi.set(e,n)),e}var mr=n=>Qi.get(n);function qc(n,e,{blocked:t,upgrade:r,blocking:s,terminated:o}={}){let c=indexedDB.open(n,e),l=Re(c);return r&&c.addEventListener("upgradeneeded",d=>{r(Re(c.result),d.oldVersion,d.newVersion,Re(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}var Vh=["get","getKey","getAll","getAllKeys","count"],Lh=["put","add","delete","clear"],Ji=new Map;function Bc(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ji.get(e))return Ji.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,s=Lh.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Vh.includes(t)))return;let o=function(c,...l){return A(this,null,function*(){let d=this.transaction(c,s?"readwrite":"readonly"),f=d.store;return r&&(f=f.index(l.shift())),(yield Promise.all([f[t](...l),s&&d.done]))[0]})};return Ji.set(e,o),o}Uc(n=>dc(hc({},n),{get:(e,t,r)=>Bc(e,t)||n.get(e,t,r),has:(e,t)=>!!Bc(e,t)||n.has(e,t)}));var Xi=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Mh(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Mh(n){let e=n.getComponent();return e?.type==="VERSION"}var Zi="@firebase/app",$c="0.10.12";var Me=new He("@firebase/app"),Fh="@firebase/app-compat",Uh="@firebase/analytics-compat",Bh="@firebase/analytics",qh="@firebase/app-check-compat",$h="@firebase/app-check",zh="@firebase/auth",jh="@firebase/auth-compat",Gh="@firebase/database",Wh="@firebase/data-connect",Kh="@firebase/database-compat",Hh="@firebase/functions",Qh="@firebase/functions-compat",Jh="@firebase/installations",Yh="@firebase/installations-compat",Xh="@firebase/messaging",Zh="@firebase/messaging-compat",ed="@firebase/performance",td="@firebase/performance-compat",nd="@firebase/remote-config",rd="@firebase/remote-config-compat",id="@firebase/storage",sd="@firebase/storage-compat",od="@firebase/firestore",ad="@firebase/vertexai-preview",cd="@firebase/firestore-compat",ud="firebase",ld="10.14.0";var es="[DEFAULT]",hd={[Zi]:"fire-core",[Fh]:"fire-core-compat",[Bh]:"fire-analytics",[Uh]:"fire-analytics-compat",[$h]:"fire-app-check",[qh]:"fire-app-check-compat",[zh]:"fire-auth",[jh]:"fire-auth-compat",[Gh]:"fire-rtdb",[Wh]:"fire-data-connect",[Kh]:"fire-rtdb-compat",[Hh]:"fire-fn",[Qh]:"fire-fn-compat",[Jh]:"fire-iid",[Yh]:"fire-iid-compat",[Xh]:"fire-fcm",[Zh]:"fire-fcm-compat",[ed]:"fire-perf",[td]:"fire-perf-compat",[nd]:"fire-rc",[rd]:"fire-rc-compat",[id]:"fire-gcs",[sd]:"fire-gcs-compat",[od]:"fire-fst",[cd]:"fire-fst-compat",[ad]:"fire-vertex","fire-js":"fire-js",[ud]:"fire-js-all"};var gn=new Map,dd=new Map,ts=new Map;function zc(n,e){try{n.container.addComponent(e)}catch(t){Me.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Je(n){let e=n.name;if(ts.has(e))return Me.debug(`There were multiple attempts to register component ${e}.`),!1;ts.set(e,n);for(let t of gn.values())zc(t,n);for(let t of dd.values())zc(t,n);return!0}function ss(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Pt(n){return n.settings!==void 0}var fd={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qe=new Le("app","Firebase",fd);var ns=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Te("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qe.create("app-deleted",{appName:this._name})}};var Ct=ld;function os(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:es,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Qe.create("bad-app-name",{appName:String(s)});if(t||(t=$i()),!t)throw Qe.create("no-options");let o=gn.get(s);if(o){if(Rt(t,o.options)&&Rt(r,o.config))return o;throw Qe.create("duplicate-app",{appName:s})}let c=new pr(s);for(let d of ts.values())c.addComponent(d);let l=new ns(t,r,c);return gn.set(s,l),l}function yn(n=es){let e=gn.get(n);if(!e&&n===es&&$i())return os();if(!e)throw Qe.create("no-app",{appName:n});return e}function gr(){return Array.from(gn.values())}function re(n,e,t){var r;let s=(r=hd[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);let o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){let l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&l.push("and"),c&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Me.warn(l.join(" "));return}Je(new Te(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}var pd="firebase-heartbeat-database",md=1,_n="firebase-heartbeat-store",Yi=null;function Kc(){return Yi||(Yi=qc(pd,md,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_n)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qe.create("idb-open",{originalErrorMessage:n.message})})),Yi}function gd(n){return A(this,null,function*(){try{let t=(yield Kc()).transaction(_n),r=yield t.objectStore(_n).get(Hc(n));return yield t.done,r}catch(e){if(e instanceof we)Me.warn(e.message);else{let t=Qe.create("idb-get",{originalErrorMessage:e?.message});Me.warn(t.message)}}})}function jc(n,e){return A(this,null,function*(){try{let r=(yield Kc()).transaction(_n,"readwrite");yield r.objectStore(_n).put(e,Hc(n)),yield r.done}catch(t){if(t instanceof we)Me.warn(t.message);else{let r=Qe.create("idb-set",{originalErrorMessage:t?.message});Me.warn(r.message)}}})}function Hc(n){return`${n.name}!${n.options.appId}`}var _d=1024,yd=30*24*60*60*1e3,rs=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new is(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return A(this,null,function*(){var e,t;try{let s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Gc();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{let l=new Date(c.date).valueOf();return Date.now()-l<=yd}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Me.warn(r)}})}getHeartbeatsHeader(){return A(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Gc(),{heartbeatsToSend:r,unsentEntries:s}=Id(this._heartbeatsCache.heartbeats),o=mn(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Me.warn(t),""}})}};function Gc(){return new Date().toISOString().substring(0,10)}function Id(n,e=_d){let t=[],r=n.slice();for(let s of n){let o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),Wc(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Wc(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var is=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(this,null,function*(){return zi()?Oc().then(()=>!0).catch(()=>!1):!1})}read(){return A(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield gd(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let s=yield this.read();return jc(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let s=yield this.read();return jc(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return})}};function Wc(n){return mn(JSON.stringify({version:2,heartbeats:n})).length}function vd(n){Je(new Te("platform-logger",e=>new Xi(e),"PRIVATE")),Je(new Te("heartbeat",e=>new rs(e),"PRIVATE")),re(Zi,$c,n),re(Zi,$c,"esm2017"),re("fire-js","")}vd("");var Ed="firebase",wd="10.14.0";re(Ed,wd,"app");var kt=new Ic("ANGULARFIRE2_VERSION");function cs(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(c=>c.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var vn=(n,e)=>{let t=e?[e]:gr(),r=[];return t.forEach(s=>{s.container.getProvider(n).instances.forEach(c=>{r.includes(c)||r.push(c)})}),r},In=class{constructor(){return vn(Td)}},Td="app-check";function Dt(){}var _r=class{zone;delegate;constructor(e,t=pc){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let s=this.zone,o=function(c){s.runGuarded(()=>{e.apply(this,[c])})};return this.delegate.schedule(o,t,r)}},as=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Dt,{},Dt,Dt)),t.pipe(mc({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},En=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new _r(Zone.current)),this.insideAngular=t.run(()=>new _r(Zone.current,fc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(_c(St))};static \u0275prov=gc({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yr(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Ad(n){return yr().ngZone.runOutsideAngular(()=>n())}function ct(n){return yr().ngZone.run(()=>n())}function bd(n){return Sd(yr())(n)}function Sd(n){return function(t){return t=t.lift(new as(n.ngZone)),t.pipe(Mi(n.outsideAngular),Li(n.insideAngular))}}var Rd=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ct(()=>n.apply(void 0,r))},Ye=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=ct(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Dt,{},Dt,Dt))),r[o]=Rd(r[o],t));let s=Ad(()=>n.apply(this,r));if(!e)if(s instanceof xi){let o=yr();return s.pipe(Mi(o.outsideAngular),Li(o.insideAngular))}else return ct(()=>s);return s instanceof xi?s.pipe(bd):s instanceof Promise?ct(()=>new Promise((o,c)=>s.then(l=>ct(()=>o(l)),l=>ct(()=>c(l))))):typeof s=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),s.apply(this,arguments)}:ct(()=>s)};var ut=class{constructor(e){return e}},wn=class{constructor(){return gr()}};function Pd(n){return n&&n.length===1?n[0]:new ut(yn())}var us=new ur("angularfire2._apps"),Cd={provide:ut,useFactory:Pd,deps:[[new Ke,us]]},Dd={provide:wn,deps:[[new Ke,us]]};function kd(n){return(e,t)=>{let r=t.get(yc);re("angularfire",kt.full,"core"),re("angularfire",kt.full,"app"),re("angular",vc.full,r.toString());let s=e.runOutsideAngular(()=>n(t));return new ut(s)}}function Cg(n,...e){return lr([Cd,Dd,{provide:us,useFactory:kd(n),multi:!0,deps:[St,hr,En,...e]}])}var Dg=Ye(os,!0);function nu(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var ru=nu,iu=new Le("auth","Firebase",nu());var wr=new He("@firebase/auth");function Od(n,...e){wr.logLevel<=M.WARN&&wr.warn(`Auth (${Ct}): ${n}`,...e)}function vr(n,...e){wr.logLevel<=M.ERROR&&wr.error(`Auth (${Ct}): ${n}`,...e)}function Qc(n,...e){throw Es(n,...e)}function vs(n,...e){return Es(n,...e)}function su(n,e,t){let r=Object.assign(Object.assign({},ru()),{[e]:t});return new Le("auth","Firebase",r).create(e,{appName:n.name})}function Er(n){return su(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Es(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return iu.create(n,...e)}function q(n,e,...t){if(!n)throw Es(e,...t)}function Tn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw vr(e),new Error(e)}function Tr(n,e){n||Tn(e)}function xd(){return Jc()==="http:"||Jc()==="https:"}function Jc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Vd(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xd()||Dc()||"connection"in navigator)?navigator.onLine:!0}function Ld(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ht=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Tr(t>e,"Short delay should be less than long delay!"),this.isMobile=Pc()||kc()}get(){return Vd()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Md(n,e){Tr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ar=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Fd={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Ud=new ht(3e4,6e4);function ou(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Pr(o,c,l,d){return A(this,arguments,function*(n,e,t,r,s={}){return au(n,s,()=>A(this,null,function*(){let f={},E={};r&&(e==="GET"?E=r:f={body:JSON.stringify(r)});let b=ji(Object.assign({key:n.config.apiKey},E)).slice(1),S=yield n._getAdditionalHeaders();S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode);let D=Object.assign({method:e,headers:S},f);return Cc()||(D.referrerPolicy="no-referrer"),Ar.fetch()(cu(n,n.config.apiHost,t,b),D)}))})}function au(n,e,t){return A(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Fd),e);try{let s=new ds(n),o=yield Promise.race([t(),s.promise]);s.clearNetworkTimeout();let c=yield o.json();if("needConfirmation"in c)throw Ir(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{let l=o.ok?c.errorMessage:c.error.message,[d,f]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ir(n,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw Ir(n,"email-already-in-use",c);if(d==="USER_DISABLED")throw Ir(n,"user-disabled",c);let E=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw su(n,E,f);Qc(n,E)}}catch(s){if(s instanceof we)throw s;Qc(n,"network-request-failed",{message:String(s)})}})}function cu(n,e,t,r){let s=`${e}${t}?${r}`;return n.config.emulator?Md(n.config,s):`${n.config.apiScheme}://${s}`}var ds=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(vs(this.auth,"network-request-failed")),Ud.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Ir(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let s=vs(n,e,r);return s.customData._tokenResponse=t,s}function Bd(n,e){return A(this,null,function*(){return Pr(n,"POST","/v1/accounts:delete",e)})}function uu(n,e){return A(this,null,function*(){return Pr(n,"POST","/v1/accounts:lookup",e)})}function An(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function ws(n,e=!1){return A(this,null,function*(){let t=Se(n),r=yield t.getIdToken(e),s=lu(r);q(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");let o=typeof s.firebase=="object"?s.firebase:void 0,c=o?.sign_in_provider;return{claims:s,token:r,authTime:An(ls(s.auth_time)),issuedAtTime:An(ls(s.iat)),expirationTime:An(ls(s.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function ls(n){return Number(n)*1e3}function lu(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return vr("JWT malformed, contained fewer than 3 sections"),null;try{let s=qi(t);return s?JSON.parse(s):(vr("Failed to decode base64 JWT payload"),null)}catch(s){return vr("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Yc(n){let e=lu(n);return q(e,"internal-error"),q(typeof e.exp<"u","internal-error"),q(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function fs(n,e,t=!1){return A(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof we&&qd(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function qd({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ps=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>A(this,null,function*(){yield this.iteration()}),t)}iteration(){return A(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Sn=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=An(this.lastLoginAt),this.creationTime=An(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function br(n){return A(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),s=yield fs(n,uu(t,{idToken:r}));q(s?.users.length,t,"internal-error");let o=s.users[0];n._notifyReloadListener(o);let c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?hu(o.providerUserInfo):[],l=$d(n.providerData,c),d=n.isAnonymous,f=!(n.email&&o.passwordHash)&&!l?.length,E=d?f:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Sn(o.createdAt,o.lastLoginAt),isAnonymous:E};Object.assign(n,b)})}function Ts(n){return A(this,null,function*(){let e=Se(n);yield br(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function $d(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function hu(n){return n.map(e=>{var{providerId:t}=e,r=Vi(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function zd(n,e){return A(this,null,function*(){let t=yield au(n,{},()=>A(this,null,function*(){let r=ji({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,c=cu(n,s,"/v1/token",`key=${o}`),l=yield n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Ar.fetch()(c,{method:"POST",headers:l,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function jd(n,e){return A(this,null,function*(){return Pr(n,"POST","/v2/accounts:revokeToken",ou(n,e))})}var bn=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){q(e.idToken,"internal-error"),q(typeof e.idToken<"u","internal-error"),q(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yc(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){q(e.length!==0,"internal-error");let t=Yc(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return A(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(q(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return A(this,null,function*(){let{accessToken:r,refreshToken:s,expiresIn:o}=yield zd(e,t);this.updateTokensAndExpiration(r,s,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:s,expirationTime:o}=t,c=new n;return r&&(q(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),s&&(q(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&(q(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Tn("not implemented")}};function Xe(n,e){q(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Rn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,o=Vi(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ps(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Sn(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return A(this,null,function*(){let t=yield fs(this,this.stsTokenManager.getToken(this.auth,e));return q(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return ws(this,e)}reload(){return Ts(this)}_assign(e){this!==e&&(q(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return A(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield br(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return A(this,null,function*(){if(Pt(this.auth.app))return Promise.reject(Er(this.auth));let e=yield this.getIdToken();return yield fs(this,Bd(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,o,c,l,d,f,E;let b=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(s=t.email)!==null&&s!==void 0?s:void 0,D=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,k=(c=t.photoURL)!==null&&c!==void 0?c:void 0,V=(l=t.tenantId)!==null&&l!==void 0?l:void 0,O=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,W=(f=t.createdAt)!==null&&f!==void 0?f:void 0,j=(E=t.lastLoginAt)!==null&&E!==void 0?E:void 0,{uid:K,emailVerified:te,isAnonymous:be,providerData:ne,stsTokenManager:I}=t;q(K&&I,e,"internal-error");let p=bn.fromJSON(this.name,I);q(typeof K=="string",e,"internal-error"),Xe(b,e.name),Xe(S,e.name),q(typeof te=="boolean",e,"internal-error"),q(typeof be=="boolean",e,"internal-error"),Xe(D,e.name),Xe(k,e.name),Xe(V,e.name),Xe(O,e.name),Xe(W,e.name),Xe(j,e.name);let g=new n({uid:K,auth:e,email:S,emailVerified:te,displayName:b,isAnonymous:be,photoURL:k,phoneNumber:D,tenantId:V,stsTokenManager:p,createdAt:W,lastLoginAt:j});return ne&&Array.isArray(ne)&&(g.providerData=ne.map(_=>Object.assign({},_))),O&&(g._redirectEventId=O),g}static _fromIdTokenResponse(e,t,r=!1){return A(this,null,function*(){let s=new bn;s.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return yield br(o),o})}static _fromGetAccountInfoResponse(e,t,r){return A(this,null,function*(){let s=t.users[0];q(s.localId!==void 0,"internal-error");let o=s.providerUserInfo!==void 0?hu(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!o?.length,l=new bn;l.updateFromIdToken(r);let d=new n({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:c}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Sn(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(d,f),d})}};var Xc=new Map;function lt(n){Tr(n instanceof Function,"Expected a class definition");let e=Xc.get(n);return e?(Tr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Xc.set(n,e),e)}var Gd=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(this,null,function*(){return!0})}_set(t,r){return A(this,null,function*(){this.storage[t]=r})}_get(t){return A(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return A(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ms=Gd;function hs(n,e,t){return`firebase:${n}:${e}:${t}`}var Sr=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:s,name:o}=this.auth;this.fullUserKey=hs(this.userKey,s.apiKey,o),this.fullPersistenceKey=hs("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return A(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Rn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return A(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return A(this,null,function*(){if(!t.length)return new n(lt(ms),e,r);let s=(yield Promise.all(t.map(f=>A(this,null,function*(){if(yield f._isAvailable())return f})))).filter(f=>f),o=s[0]||lt(ms),c=hs(r,e.config.apiKey,e.name),l=null;for(let f of t)try{let E=yield f._get(c);if(E){let b=Rn._fromJSON(e,E);f!==o&&(l=b),o=f;break}}catch{}let d=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new n(o,e,r):(o=d[0],l&&(yield o._set(c,l.toJSON())),yield Promise.all(t.map(f=>A(this,null,function*(){if(f!==o)try{yield f._remove(c)}catch{}}))),new n(o,e,r))})}};function Zc(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Qd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Wd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Yd(e))return"Blackberry";if(Xd(e))return"Webos";if(Kd(e))return"Safari";if((e.includes("chrome/")||Hd(e))&&!e.includes("edge/"))return"Chrome";if(Jd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Wd(n=Ie()){return/firefox\//i.test(n)}function Kd(n=Ie()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Hd(n=Ie()){return/crios\//i.test(n)}function Qd(n=Ie()){return/iemobile/i.test(n)}function Jd(n=Ie()){return/android/i.test(n)}function Yd(n=Ie()){return/blackberry/i.test(n)}function Xd(n=Ie()){return/webos/i.test(n)}function du(n,e=[]){let t;switch(n){case"Browser":t=Zc(Ie());break;case"Worker":t=`${Zc(Ie())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ct}/${r}`}var gs=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((c,l)=>{try{let d=e(o);c(d)}catch(d){l(d)}});r.onAbort=t,this.queue.push(r);let s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(e){return A(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Zd(t){return A(this,arguments,function*(n,e={}){return Pr(n,"GET","/v2/passwordPolicy",ou(n,e))})}var ef=6,_s=class{constructor(e){var t,r,s,o;let c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:ef,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,o,c,l;let d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(c=d.containsNumericCharacter)!==null&&c!==void 0?c:!0),d.isValid&&(d.isValid=(l=d.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),d}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var ys=class{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rr(this),this.idTokenSubscription=new Rr(this),this.beforeStateQueue=new gs(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=lt(t)),this._initializationPromise=this.queue(()=>A(this,null,function*(){var r,s;if(!this._deleted&&(this.persistenceManager=yield Sr.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return A(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return A(this,null,function*(){try{let t=yield uu(this,{idToken:e}),r=yield Rn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return A(this,null,function*(){var t;if(Pt(this.app)){let c=this.app.settings.authIdToken;return c?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(l,l))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),s=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=s?._redirectEventId,d=yield this.tryRedirectSignIn(e);(!c||c===l)&&d?.user&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(s)}catch(c){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return q(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)})}tryRedirectSignIn(e){return A(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return A(this,null,function*(){try{yield br(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Ld()}_delete(){return A(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return A(this,null,function*(){if(Pt(this.app))return Promise.reject(Er(this));let t=e?Se(e):null;return t&&q(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return A(this,null,function*(){if(!this._deleted)return e&&q(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>A(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return A(this,null,function*(){return Pt(this.app)?Promise.reject(Er(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Pt(this.app)?Promise.reject(Er(this)):this.queue(()=>A(this,null,function*(){yield this.assertedPersistence.setPersistence(lt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return A(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return A(this,null,function*(){let e=yield Zd(this),t=new _s(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Le("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return A(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield jd(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return A(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return A(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&lt(e)||this._popupRedirectResolver;q(t,this,"argument-error"),this.redirectPersistenceManager=yield Sr.create(this,[lt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return A(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>A(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return A(this,null,function*(){if(e===this.currentUser)return this.queue(()=>A(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),c=!1,l=this._isInitialized?Promise.resolve():this._initializationPromise;if(q(l,this,"internal-error"),l.then(()=>{c||o(this.currentUser)}),typeof t=="function"){let d=e.addObserver(t,r,s);return()=>{c=!0,d()}}else{let d=e.addObserver(t);return()=>{c=!0,d()}}}directlySetCurrentUser(e){return A(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=du(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return A(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let s=yield this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t})}_getAppCheckToken(){return A(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Od(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function tf(n){return Se(n)}var Rr=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=xc(t=>this.observer=t)}get next(){return q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var nf={loadJS(){return A(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rf(n){nf=n}function sf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function of(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(lt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var $g=sf("rcb"),zg=new ht(3e4,6e4);var jg=new ht(2e3,1e4);var Gg=10*60*1e3;var Wg=new ht(3e4,6e4);var Kg=new ht(5e3,15e3);var Hg=encodeURIComponent("fac");var eu="@firebase/auth",tu="1.7.9";var Is=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return A(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function af(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cf(n){Je(new Te("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:l}=r.options;q(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});let d={apiKey:c,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:du(n)},f=new ys(r,s,o,d);return of(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Je(new Te("auth-internal",e=>{let t=tf(e.getProvider("auth").getImmediate());return(r=>new Is(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),re(eu,tu,af(n)),re(eu,tu,"esm2017")}var uf=5*60,Qg=Sc("authIdTokenMaxAge")||uf;function lf(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}rf({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{let o=vs("internal-error");o.customData=s,t(o)},r.type="text/javascript",r.charset="UTF-8",lf().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cf("Browser");var up="auth";var Cr=class{constructor(){return vn(up)}};var fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pu={};var As,mu;(function(){var n;function e(I,p){function g(){}g.prototype=p.prototype,I.D=p.prototype,I.prototype=new g,I.prototype.constructor=I,I.C=function(_,y,w){for(var m=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)m[Oe-2]=arguments[Oe];return p.prototype[y].apply(_,m)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,p,g){g||(g=0);var _=Array(16);if(typeof p=="string")for(var y=0;16>y;++y)_[y]=p.charCodeAt(g++)|p.charCodeAt(g++)<<8|p.charCodeAt(g++)<<16|p.charCodeAt(g++)<<24;else for(y=0;16>y;++y)_[y]=p[g++]|p[g++]<<8|p[g++]<<16|p[g++]<<24;p=I.g[0],g=I.g[1],y=I.g[2];var w=I.g[3],m=p+(w^g&(y^w))+_[0]+3614090360&4294967295;p=g+(m<<7&4294967295|m>>>25),m=w+(y^p&(g^y))+_[1]+3905402710&4294967295,w=p+(m<<12&4294967295|m>>>20),m=y+(g^w&(p^g))+_[2]+606105819&4294967295,y=w+(m<<17&4294967295|m>>>15),m=g+(p^y&(w^p))+_[3]+3250441966&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(w^g&(y^w))+_[4]+4118548399&4294967295,p=g+(m<<7&4294967295|m>>>25),m=w+(y^p&(g^y))+_[5]+1200080426&4294967295,w=p+(m<<12&4294967295|m>>>20),m=y+(g^w&(p^g))+_[6]+2821735955&4294967295,y=w+(m<<17&4294967295|m>>>15),m=g+(p^y&(w^p))+_[7]+4249261313&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(w^g&(y^w))+_[8]+1770035416&4294967295,p=g+(m<<7&4294967295|m>>>25),m=w+(y^p&(g^y))+_[9]+2336552879&4294967295,w=p+(m<<12&4294967295|m>>>20),m=y+(g^w&(p^g))+_[10]+4294925233&4294967295,y=w+(m<<17&4294967295|m>>>15),m=g+(p^y&(w^p))+_[11]+2304563134&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(w^g&(y^w))+_[12]+1804603682&4294967295,p=g+(m<<7&4294967295|m>>>25),m=w+(y^p&(g^y))+_[13]+4254626195&4294967295,w=p+(m<<12&4294967295|m>>>20),m=y+(g^w&(p^g))+_[14]+2792965006&4294967295,y=w+(m<<17&4294967295|m>>>15),m=g+(p^y&(w^p))+_[15]+1236535329&4294967295,g=y+(m<<22&4294967295|m>>>10),m=p+(y^w&(g^y))+_[1]+4129170786&4294967295,p=g+(m<<5&4294967295|m>>>27),m=w+(g^y&(p^g))+_[6]+3225465664&4294967295,w=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(w^p))+_[11]+643717713&4294967295,y=w+(m<<14&4294967295|m>>>18),m=g+(w^p&(y^w))+_[0]+3921069994&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^w&(g^y))+_[5]+3593408605&4294967295,p=g+(m<<5&4294967295|m>>>27),m=w+(g^y&(p^g))+_[10]+38016083&4294967295,w=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(w^p))+_[15]+3634488961&4294967295,y=w+(m<<14&4294967295|m>>>18),m=g+(w^p&(y^w))+_[4]+3889429448&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^w&(g^y))+_[9]+568446438&4294967295,p=g+(m<<5&4294967295|m>>>27),m=w+(g^y&(p^g))+_[14]+3275163606&4294967295,w=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(w^p))+_[3]+4107603335&4294967295,y=w+(m<<14&4294967295|m>>>18),m=g+(w^p&(y^w))+_[8]+1163531501&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(y^w&(g^y))+_[13]+2850285829&4294967295,p=g+(m<<5&4294967295|m>>>27),m=w+(g^y&(p^g))+_[2]+4243563512&4294967295,w=p+(m<<9&4294967295|m>>>23),m=y+(p^g&(w^p))+_[7]+1735328473&4294967295,y=w+(m<<14&4294967295|m>>>18),m=g+(w^p&(y^w))+_[12]+2368359562&4294967295,g=y+(m<<20&4294967295|m>>>12),m=p+(g^y^w)+_[5]+4294588738&4294967295,p=g+(m<<4&4294967295|m>>>28),m=w+(p^g^y)+_[8]+2272392833&4294967295,w=p+(m<<11&4294967295|m>>>21),m=y+(w^p^g)+_[11]+1839030562&4294967295,y=w+(m<<16&4294967295|m>>>16),m=g+(y^w^p)+_[14]+4259657740&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^w)+_[1]+2763975236&4294967295,p=g+(m<<4&4294967295|m>>>28),m=w+(p^g^y)+_[4]+1272893353&4294967295,w=p+(m<<11&4294967295|m>>>21),m=y+(w^p^g)+_[7]+4139469664&4294967295,y=w+(m<<16&4294967295|m>>>16),m=g+(y^w^p)+_[10]+3200236656&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^w)+_[13]+681279174&4294967295,p=g+(m<<4&4294967295|m>>>28),m=w+(p^g^y)+_[0]+3936430074&4294967295,w=p+(m<<11&4294967295|m>>>21),m=y+(w^p^g)+_[3]+3572445317&4294967295,y=w+(m<<16&4294967295|m>>>16),m=g+(y^w^p)+_[6]+76029189&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(g^y^w)+_[9]+3654602809&4294967295,p=g+(m<<4&4294967295|m>>>28),m=w+(p^g^y)+_[12]+3873151461&4294967295,w=p+(m<<11&4294967295|m>>>21),m=y+(w^p^g)+_[15]+530742520&4294967295,y=w+(m<<16&4294967295|m>>>16),m=g+(y^w^p)+_[2]+3299628645&4294967295,g=y+(m<<23&4294967295|m>>>9),m=p+(y^(g|~w))+_[0]+4096336452&4294967295,p=g+(m<<6&4294967295|m>>>26),m=w+(g^(p|~y))+_[7]+1126891415&4294967295,w=p+(m<<10&4294967295|m>>>22),m=y+(p^(w|~g))+_[14]+2878612391&4294967295,y=w+(m<<15&4294967295|m>>>17),m=g+(w^(y|~p))+_[5]+4237533241&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~w))+_[12]+1700485571&4294967295,p=g+(m<<6&4294967295|m>>>26),m=w+(g^(p|~y))+_[3]+2399980690&4294967295,w=p+(m<<10&4294967295|m>>>22),m=y+(p^(w|~g))+_[10]+4293915773&4294967295,y=w+(m<<15&4294967295|m>>>17),m=g+(w^(y|~p))+_[1]+2240044497&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~w))+_[8]+1873313359&4294967295,p=g+(m<<6&4294967295|m>>>26),m=w+(g^(p|~y))+_[15]+4264355552&4294967295,w=p+(m<<10&4294967295|m>>>22),m=y+(p^(w|~g))+_[6]+2734768916&4294967295,y=w+(m<<15&4294967295|m>>>17),m=g+(w^(y|~p))+_[13]+1309151649&4294967295,g=y+(m<<21&4294967295|m>>>11),m=p+(y^(g|~w))+_[4]+4149444226&4294967295,p=g+(m<<6&4294967295|m>>>26),m=w+(g^(p|~y))+_[11]+3174756917&4294967295,w=p+(m<<10&4294967295|m>>>22),m=y+(p^(w|~g))+_[2]+718787259&4294967295,y=w+(m<<15&4294967295|m>>>17),m=g+(w^(y|~p))+_[9]+3951481745&4294967295,I.g[0]=I.g[0]+p&4294967295,I.g[1]=I.g[1]+(y+(m<<21&4294967295|m>>>11))&4294967295,I.g[2]=I.g[2]+y&4294967295,I.g[3]=I.g[3]+w&4294967295}r.prototype.u=function(I,p){p===void 0&&(p=I.length);for(var g=p-this.blockSize,_=this.B,y=this.h,w=0;w<p;){if(y==0)for(;w<=g;)s(this,I,w),w+=this.blockSize;if(typeof I=="string"){for(;w<p;)if(_[y++]=I.charCodeAt(w++),y==this.blockSize){s(this,_),y=0;break}}else for(;w<p;)if(_[y++]=I[w++],y==this.blockSize){s(this,_),y=0;break}}this.h=y,this.o+=p},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var p=1;p<I.length-8;++p)I[p]=0;var g=8*this.o;for(p=I.length-8;p<I.length;++p)I[p]=g&255,g/=256;for(this.u(I),I=Array(16),p=g=0;4>p;++p)for(var _=0;32>_;_+=8)I[g++]=this.g[p]>>>_&255;return I};function o(I,p){var g=l;return Object.prototype.hasOwnProperty.call(g,I)?g[I]:g[I]=p(I)}function c(I,p){this.h=p;for(var g=[],_=!0,y=I.length-1;0<=y;y--){var w=I[y]|0;_&&w==p||(g[y]=w,_=!1)}this.g=g}var l={};function d(I){return-128<=I&&128>I?o(I,function(p){return new c([p|0],0>p?-1:0)}):new c([I|0],0>I?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return b;if(0>I)return O(f(-I));for(var p=[],g=1,_=0;I>=g;_++)p[_]=I/g|0,g*=4294967296;return new c(p,0)}function E(I,p){if(I.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(I.charAt(0)=="-")return O(E(I.substring(1),p));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var g=f(Math.pow(p,8)),_=b,y=0;y<I.length;y+=8){var w=Math.min(8,I.length-y),m=parseInt(I.substring(y,y+w),p);8>w?(w=f(Math.pow(p,w)),_=_.j(w).add(f(m))):(_=_.j(g),_=_.add(f(m)))}return _}var b=d(0),S=d(1),D=d(16777216);n=c.prototype,n.m=function(){if(V(this))return-O(this).m();for(var I=0,p=1,g=0;g<this.g.length;g++){var _=this.i(g);I+=(0<=_?_:4294967296+_)*p,p*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k(this))return"0";if(V(this))return"-"+O(this).toString(I);for(var p=f(Math.pow(I,6)),g=this,_="";;){var y=te(g,p).g;g=W(g,y.j(p));var w=((0<g.g.length?g.g[0]:g.h)>>>0).toString(I);if(g=y,k(g))return w+_;for(;6>w.length;)w="0"+w;_=w+_}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function k(I){if(I.h!=0)return!1;for(var p=0;p<I.g.length;p++)if(I.g[p]!=0)return!1;return!0}function V(I){return I.h==-1}n.l=function(I){return I=W(this,I),V(I)?-1:k(I)?0:1};function O(I){for(var p=I.g.length,g=[],_=0;_<p;_++)g[_]=~I.g[_];return new c(g,~I.h).add(S)}n.abs=function(){return V(this)?O(this):this},n.add=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0,y=0;y<=p;y++){var w=_+(this.i(y)&65535)+(I.i(y)&65535),m=(w>>>16)+(this.i(y)>>>16)+(I.i(y)>>>16);_=m>>>16,w&=65535,m&=65535,g[y]=m<<16|w}return new c(g,g[g.length-1]&-2147483648?-1:0)};function W(I,p){return I.add(O(p))}n.j=function(I){if(k(this)||k(I))return b;if(V(this))return V(I)?O(this).j(O(I)):O(O(this).j(I));if(V(I))return O(this.j(O(I)));if(0>this.l(D)&&0>I.l(D))return f(this.m()*I.m());for(var p=this.g.length+I.g.length,g=[],_=0;_<2*p;_++)g[_]=0;for(_=0;_<this.g.length;_++)for(var y=0;y<I.g.length;y++){var w=this.i(_)>>>16,m=this.i(_)&65535,Oe=I.i(y)>>>16,Qt=I.i(y)&65535;g[2*_+2*y]+=m*Qt,j(g,2*_+2*y),g[2*_+2*y+1]+=w*Qt,j(g,2*_+2*y+1),g[2*_+2*y+1]+=m*Oe,j(g,2*_+2*y+1),g[2*_+2*y+2]+=w*Oe,j(g,2*_+2*y+2)}for(_=0;_<p;_++)g[_]=g[2*_+1]<<16|g[2*_];for(_=p;_<2*p;_++)g[_]=0;return new c(g,0)};function j(I,p){for(;(I[p]&65535)!=I[p];)I[p+1]+=I[p]>>>16,I[p]&=65535,p++}function K(I,p){this.g=I,this.h=p}function te(I,p){if(k(p))throw Error("division by zero");if(k(I))return new K(b,b);if(V(I))return p=te(O(I),p),new K(O(p.g),O(p.h));if(V(p))return p=te(I,O(p)),new K(O(p.g),p.h);if(30<I.g.length){if(V(I)||V(p))throw Error("slowDivide_ only works with positive integers.");for(var g=S,_=p;0>=_.l(I);)g=be(g),_=be(_);var y=ne(g,1),w=ne(_,1);for(_=ne(_,2),g=ne(g,2);!k(_);){var m=w.add(_);0>=m.l(I)&&(y=y.add(g),w=m),_=ne(_,1),g=ne(g,1)}return p=W(I,y.j(p)),new K(y,p)}for(y=b;0<=I.l(p);){for(g=Math.max(1,Math.floor(I.m()/p.m())),_=Math.ceil(Math.log(g)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),w=f(g),m=w.j(p);V(m)||0<m.l(I);)g-=_,w=f(g),m=w.j(p);k(w)&&(w=S),y=y.add(w),I=W(I,m)}return new K(y,I)}n.A=function(I){return te(this,I).h},n.and=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)&I.i(_);return new c(g,this.h&I.h)},n.or=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)|I.i(_);return new c(g,this.h|I.h)},n.xor=function(I){for(var p=Math.max(this.g.length,I.g.length),g=[],_=0;_<p;_++)g[_]=this.i(_)^I.i(_);return new c(g,this.h^I.h)};function be(I){for(var p=I.g.length+1,g=[],_=0;_<p;_++)g[_]=I.i(_)<<1|I.i(_-1)>>>31;return new c(g,I.h)}function ne(I,p){var g=p>>5;p%=32;for(var _=I.g.length-g,y=[],w=0;w<_;w++)y[w]=0<p?I.i(w+g)>>>p|I.i(w+g+1)<<32-p:I.i(w+g);return new c(y,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,mu=pu.Md5=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=f,c.fromString=E,As=pu.Integer=c}).apply(typeof fu<"u"?fu:typeof self<"u"?self:typeof window<"u"?window:{});var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fe={};var bs,lp,Nt,Ss,Pn,kr,Rs,Ps,Cs;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,a,u){return i==Array.prototype||i==Object.prototype||(i[a]=u.value),i};function t(i){i=[typeof globalThis=="object"&&globalThis,i,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dr=="object"&&Dr];for(var a=0;a<i.length;++a){var u=i[a];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function s(i,a){if(a)e:{var u=r;i=i.split(".");for(var h=0;h<i.length-1;h++){var v=i[h];if(!(v in u))break e;u=u[v]}i=i[i.length-1],h=u[i],a=a(h),a!=h&&a!=null&&e(u,i,{configurable:!0,writable:!0,value:a})}}function o(i,a){i instanceof String&&(i+="");var u=0,h=!1,v={next:function(){if(!h&&u<i.length){var T=u++;return{value:a(T,i[T]),done:!1}}return h=!0,{done:!0,value:void 0}}};return v[Symbol.iterator]=function(){return v},v}s("Array.prototype.values",function(i){return i||function(){return o(this,function(a,u){return u})}});var c=c||{},l=this||self;function d(i){var a=typeof i;return a=a!="object"?a:i?Array.isArray(i)?"array":a:"null",a=="array"||a=="object"&&typeof i.length=="number"}function f(i){var a=typeof i;return a=="object"&&i!=null||a=="function"}function E(i,a,u){return i.call.apply(i.bind,arguments)}function b(i,a,u){if(!i)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var v=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(v,h),i.apply(a,v)}}return function(){return i.apply(a,arguments)}}function S(i,a,u){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?E:b,S.apply(null,arguments)}function D(i,a){var u=Array.prototype.slice.call(arguments,1);return function(){var h=u.slice();return h.push.apply(h,arguments),i.apply(this,h)}}function k(i,a){function u(){}u.prototype=a.prototype,i.aa=a.prototype,i.prototype=new u,i.prototype.constructor=i,i.Qb=function(h,v,T){for(var C=Array(arguments.length-2),$=2;$<arguments.length;$++)C[$-2]=arguments[$];return a.prototype[v].apply(h,C)}}function V(i){let a=i.length;if(0<a){let u=Array(a);for(let h=0;h<a;h++)u[h]=i[h];return u}return[]}function O(i,a){for(let u=1;u<arguments.length;u++){let h=arguments[u];if(d(h)){let v=i.length||0,T=h.length||0;i.length=v+T;for(let C=0;C<T;C++)i[v+C]=h[C]}else i.push(h)}}class W{constructor(a,u){this.i=a,this.j=u,this.h=0,this.g=null}get(){let a;return 0<this.h?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.i(),a}}function j(i){return/^[\s\xa0]*$/.test(i)}function K(){var i=l.navigator;return i&&(i=i.userAgent)?i:""}function te(i){return te[" "](i),i}te[" "]=function(){};var be=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function ne(i,a,u){for(let h in i)a.call(u,i[h],h,i)}function I(i,a){for(let u in i)a.call(void 0,i[u],u,i)}function p(i){let a={};for(let u in i)a[u]=i[u];return a}let g="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(i,a){let u,h;for(let v=1;v<arguments.length;v++){h=arguments[v];for(u in h)i[u]=h[u];for(let T=0;T<g.length;T++)u=g[T],Object.prototype.hasOwnProperty.call(h,u)&&(i[u]=h[u])}}function y(i){var a=1;i=i.split(":");let u=[];for(;0<a&&i.length;)u.push(i.shift()),a--;return i.length&&u.push(i.join(":")),u}function w(i){l.setTimeout(()=>{throw i},0)}function m(){var i=ui;let a=null;return i.g&&(a=i.g,i.g=i.g.next,i.g||(i.h=null),a.next=null),a}class Oe{constructor(){this.h=this.g=null}add(a,u){let h=Qt.get();h.set(a,u),this.h?this.h.next=h:this.g=h,this.h=h}}var Qt=new W(()=>new Dl,i=>i.reset());class Dl{constructor(){this.next=this.g=this.h=null}set(a,u){this.h=a,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let Jt,Yt=!1,ui=new Oe,la=()=>{let i=l.Promise.resolve(void 0);Jt=()=>{i.then(kl)}};var kl=()=>{for(var i;i=m();){try{i.h.call(i.g)}catch(u){w(u)}var a=Qt;a.j(i),100>a.h&&(a.h++,i.next=a.g,a.g=i)}Yt=!1};function ze(){this.s=this.s,this.C=this.C}ze.prototype.s=!1,ze.prototype.ma=function(){this.s||(this.s=!0,this.N())},ze.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(i,a){this.type=i,this.g=this.target=a,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var Nl=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var i=!1,a=Object.defineProperty({},"passive",{get:function(){i=!0}});try{let u=()=>{};l.addEventListener("test",u,a),l.removeEventListener("test",u,a)}catch{}return i}();function Xt(i,a){if(ce.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var u=this.type=i.type,h=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=a,a=i.relatedTarget){if(be){e:{try{te(a.nodeName);var v=!0;break e}catch{}v=!1}v||(a=null)}}else u=="mouseover"?a=i.fromElement:u=="mouseout"&&(a=i.toElement);this.relatedTarget=a,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:Ol[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&Xt.aa.h.call(this)}}k(Xt,ce);var Ol={2:"touch",3:"pen",4:"mouse"};Xt.prototype.h=function(){Xt.aa.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var Zt="closure_listenable_"+(1e6*Math.random()|0),xl=0;function Vl(i,a,u,h,v){this.listener=i,this.proxy=null,this.src=a,this.type=u,this.capture=!!h,this.ha=v,this.key=++xl,this.da=this.fa=!1}function Wn(i){i.da=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function Kn(i){this.src=i,this.g={},this.h=0}Kn.prototype.add=function(i,a,u,h,v){var T=i.toString();i=this.g[T],i||(i=this.g[T]=[],this.h++);var C=hi(i,a,h,v);return-1<C?(a=i[C],u||(a.fa=!1)):(a=new Vl(a,this.src,T,!!h,v),a.fa=u,i.push(a)),a};function li(i,a){var u=a.type;if(u in i.g){var h=i.g[u],v=Array.prototype.indexOf.call(h,a,void 0),T;(T=0<=v)&&Array.prototype.splice.call(h,v,1),T&&(Wn(a),i.g[u].length==0&&(delete i.g[u],i.h--))}}function hi(i,a,u,h){for(var v=0;v<i.length;++v){var T=i[v];if(!T.da&&T.listener==a&&T.capture==!!u&&T.ha==h)return v}return-1}var di="closure_lm_"+(1e6*Math.random()|0),fi={};function ha(i,a,u,h,v){if(h&&h.once)return fa(i,a,u,h,v);if(Array.isArray(a)){for(var T=0;T<a.length;T++)ha(i,a[T],u,h,v);return null}return u=_i(u),i&&i[Zt]?i.K(a,u,f(h)?!!h.capture:!!h,v):da(i,a,u,!1,h,v)}function da(i,a,u,h,v,T){if(!a)throw Error("Invalid event type");var C=f(v)?!!v.capture:!!v,$=mi(i);if($||(i[di]=$=new Kn(i)),u=$.add(a,u,h,C,T),u.proxy)return u;if(h=Ll(),u.proxy=h,h.src=i,h.listener=u,i.addEventListener)Nl||(v=C),v===void 0&&(v=!1),i.addEventListener(a.toString(),h,v);else if(i.attachEvent)i.attachEvent(ma(a.toString()),h);else if(i.addListener&&i.removeListener)i.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Ll(){function i(u){return a.call(i.src,i.listener,u)}let a=Ml;return i}function fa(i,a,u,h,v){if(Array.isArray(a)){for(var T=0;T<a.length;T++)fa(i,a[T],u,h,v);return null}return u=_i(u),i&&i[Zt]?i.L(a,u,f(h)?!!h.capture:!!h,v):da(i,a,u,!0,h,v)}function pa(i,a,u,h,v){if(Array.isArray(a))for(var T=0;T<a.length;T++)pa(i,a[T],u,h,v);else h=f(h)?!!h.capture:!!h,u=_i(u),i&&i[Zt]?(i=i.i,a=String(a).toString(),a in i.g&&(T=i.g[a],u=hi(T,u,h,v),-1<u&&(Wn(T[u]),Array.prototype.splice.call(T,u,1),T.length==0&&(delete i.g[a],i.h--)))):i&&(i=mi(i))&&(a=i.g[a.toString()],i=-1,a&&(i=hi(a,u,h,v)),(u=-1<i?a[i]:null)&&pi(u))}function pi(i){if(typeof i!="number"&&i&&!i.da){var a=i.src;if(a&&a[Zt])li(a.i,i);else{var u=i.type,h=i.proxy;a.removeEventListener?a.removeEventListener(u,h,i.capture):a.detachEvent?a.detachEvent(ma(u),h):a.addListener&&a.removeListener&&a.removeListener(h),(u=mi(a))?(li(u,i),u.h==0&&(u.src=null,a[di]=null)):Wn(i)}}}function ma(i){return i in fi?fi[i]:fi[i]="on"+i}function Ml(i,a){if(i.da)i=!0;else{a=new Xt(a,this);var u=i.listener,h=i.ha||i.src;i.fa&&pi(i),i=u.call(h,a)}return i}function mi(i){return i=i[di],i instanceof Kn?i:null}var gi="__closure_events_fn_"+(1e9*Math.random()>>>0);function _i(i){return typeof i=="function"?i:(i[gi]||(i[gi]=function(a){return i.handleEvent(a)}),i[gi])}function ue(){ze.call(this),this.i=new Kn(this),this.M=this,this.F=null}k(ue,ze),ue.prototype[Zt]=!0,ue.prototype.removeEventListener=function(i,a,u,h){pa(this,i,a,u,h)};function me(i,a){var u,h=i.F;if(h)for(u=[];h;h=h.F)u.push(h);if(i=i.M,h=a.type||a,typeof a=="string")a=new ce(a,i);else if(a instanceof ce)a.target=a.target||i;else{var v=a;a=new ce(h,i),_(a,v)}if(v=!0,u)for(var T=u.length-1;0<=T;T--){var C=a.g=u[T];v=Hn(C,h,!0,a)&&v}if(C=a.g=i,v=Hn(C,h,!0,a)&&v,v=Hn(C,h,!1,a)&&v,u)for(T=0;T<u.length;T++)C=a.g=u[T],v=Hn(C,h,!1,a)&&v}ue.prototype.N=function(){if(ue.aa.N.call(this),this.i){var i=this.i,a;for(a in i.g){for(var u=i.g[a],h=0;h<u.length;h++)Wn(u[h]);delete i.g[a],i.h--}}this.F=null},ue.prototype.K=function(i,a,u,h){return this.i.add(String(i),a,!1,u,h)},ue.prototype.L=function(i,a,u,h){return this.i.add(String(i),a,!0,u,h)};function Hn(i,a,u,h){if(a=i.i.g[String(a)],!a)return!0;a=a.concat();for(var v=!0,T=0;T<a.length;++T){var C=a[T];if(C&&!C.da&&C.capture==u){var $=C.listener,ae=C.ha||C.src;C.fa&&li(i.i,C),v=$.call(ae,h)!==!1&&v}}return v&&!h.defaultPrevented}function ga(i,a,u){if(typeof i=="function")u&&(i=S(i,u));else if(i&&typeof i.handleEvent=="function")i=S(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:l.setTimeout(i,a||0)}function _a(i){i.g=ga(()=>{i.g=null,i.i&&(i.i=!1,_a(i))},i.l);let a=i.h;i.h=null,i.m.apply(null,a)}class Fl extends ze{constructor(a,u){super(),this.m=a,this.l=u,this.h=null,this.i=!1,this.g=null}j(a){this.h=arguments,this.g?this.i=!0:_a(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(i){ze.call(this),this.h=i,this.g={}}k(en,ze);var ya=[];function Ia(i){ne(i.g,function(a,u){this.g.hasOwnProperty(u)&&pi(a)},i),i.g={}}en.prototype.N=function(){en.aa.N.call(this),Ia(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yi=l.JSON.stringify,Ul=l.JSON.parse,Bl=class{stringify(i){return l.JSON.stringify(i,void 0)}parse(i){return l.JSON.parse(i,void 0)}};function Ii(){}Ii.prototype.h=null;function va(i){return i.h||(i.h=i.i())}function Ea(){}var tn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vi(){ce.call(this,"d")}k(vi,ce);function Ei(){ce.call(this,"c")}k(Ei,ce);var rt={},wa=null;function Qn(){return wa=wa||new ue}rt.La="serverreachability";function Ta(i){ce.call(this,rt.La,i)}k(Ta,ce);function nn(i){let a=Qn();me(a,new Ta(a))}rt.STAT_EVENT="statevent";function Aa(i,a){ce.call(this,rt.STAT_EVENT,i),this.stat=a}k(Aa,ce);function ge(i){let a=Qn();me(a,new Aa(a,i))}rt.Ma="timingevent";function ba(i,a){ce.call(this,rt.Ma,i),this.size=a}k(ba,ce);function rn(i,a){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){i()},a)}function sn(){this.g=!0}sn.prototype.xa=function(){this.g=!1};function ql(i,a,u,h,v,T){i.info(function(){if(i.g)if(T)for(var C="",$=T.split("&"),ae=0;ae<$.length;ae++){var B=$[ae].split("=");if(1<B.length){var le=B[0];B=B[1];var he=le.split("_");C=2<=he.length&&he[1]=="type"?C+(le+"="+B+"&"):C+(le+"=redacted&")}}else C=null;else C=T;return"XMLHTTP REQ ("+h+") [attempt "+v+"]: "+a+`
`+u+`
`+C})}function $l(i,a,u,h,v,T,C){i.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+v+"]: "+a+`
`+u+`
`+T+" "+C})}function wt(i,a,u,h){i.info(function(){return"XMLHTTP TEXT ("+a+"): "+jl(i,u)+(h?" "+h:"")})}function zl(i,a){i.info(function(){return"TIMEOUT: "+a})}sn.prototype.info=function(){};function jl(i,a){if(!i.g)return a;if(!a)return null;try{var u=JSON.parse(a);if(u){for(i=0;i<u.length;i++)if(Array.isArray(u[i])){var h=u[i];if(!(2>h.length)){var v=h[1];if(Array.isArray(v)&&!(1>v.length)){var T=v[0];if(T!="noop"&&T!="stop"&&T!="close")for(var C=1;C<v.length;C++)v[C]=""}}}}return yi(u)}catch{return a}}var Jn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Sa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wi;function Yn(){}k(Yn,Ii),Yn.prototype.g=function(){return new XMLHttpRequest},Yn.prototype.i=function(){return{}},wi=new Yn;function je(i,a,u,h){this.j=i,this.i=a,this.l=u,this.R=h||1,this.U=new en(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ra}function Ra(){this.i=null,this.g="",this.h=!1}var Pa={},Ti={};function Ai(i,a,u){i.L=1,i.v=tr(xe(a)),i.m=u,i.P=!0,Ca(i,null)}function Ca(i,a){i.F=Date.now(),Xn(i),i.A=xe(i.v);var u=i.A,h=i.R;Array.isArray(h)||(h=[String(h)]),za(u.i,"t",h),i.C=0,u=i.j.J,i.h=new Ra,i.g=ac(i.j,u?a:null,!i.m),0<i.O&&(i.M=new Fl(S(i.Y,i,i.g),i.O)),a=i.U,u=i.g,h=i.ca;var v="readystatechange";Array.isArray(v)||(v&&(ya[0]=v.toString()),v=ya);for(var T=0;T<v.length;T++){var C=ha(u,v[T],h||a.handleEvent,!1,a.h||a);if(!C)break;a.g[C.key]=C}a=i.H?p(i.H):{},i.m?(i.u||(i.u="POST"),a["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.m,a)):(i.u="GET",i.g.ea(i.A,i.u,null,a)),nn(),ql(i.i,i.u,i.A,i.l,i.R,i.m)}je.prototype.ca=function(i){i=i.target;let a=this.M;a&&Ve(i)==3?a.j():this.Y(i)},je.prototype.Y=function(i){try{if(i==this.g)e:{let he=Ve(this.g);var a=this.g.Ba();let bt=this.g.Z();if(!(3>he)&&(he!=3||this.g&&(this.h.h||this.g.oa()||Ja(this.g)))){this.J||he!=4||a==7||(a==8||0>=bt?nn(3):nn(2)),bi(this);var u=this.g.Z();this.X=u;t:if(Da(this)){var h=Ja(this.g);i="";var v=h.length,T=Ve(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){it(this),on(this);var C="";break t}this.h.i=new l.TextDecoder}for(a=0;a<v;a++)this.h.h=!0,i+=this.h.i.decode(h[a],{stream:!(T&&a==v-1)});h.length=0,this.h.g+=i,this.C=0,C=this.h.g}else C=this.g.oa();if(this.o=u==200,$l(this.i,this.u,this.A,this.l,this.R,he,u),this.o){if(this.T&&!this.K){t:{if(this.g){var $,ae=this.g;if(($=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j($)){var B=$;break t}}B=null}if(u=B)wt(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Si(this,u);else{this.o=!1,this.s=3,ge(12),it(this),on(this);break e}}if(this.P){u=!0;let Ae;for(;!this.J&&this.C<C.length;)if(Ae=Gl(this,C),Ae==Ti){he==4&&(this.s=4,ge(14),u=!1),wt(this.i,this.l,null,"[Incomplete Response]");break}else if(Ae==Pa){this.s=4,ge(15),wt(this.i,this.l,C,"[Invalid Chunk]"),u=!1;break}else wt(this.i,this.l,Ae,null),Si(this,Ae);if(Da(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),he!=4||C.length!=0||this.h.h||(this.s=1,ge(16),u=!1),this.o=this.o&&u,!u)wt(this.i,this.l,C,"[Invalid Chunked Response]"),it(this),on(this);else if(0<C.length&&!this.W){this.W=!0;var le=this.j;le.g==this&&le.ba&&!le.M&&(le.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Ni(le),le.M=!0,ge(11))}}else wt(this.i,this.l,C,null),Si(this,C);he==4&&it(this),this.o&&!this.J&&(he==4?rc(this.j,this):(this.o=!1,Xn(this)))}else ch(this.g),u==400&&0<C.indexOf("Unknown SID")?(this.s=3,ge(12)):(this.s=0,ge(13)),it(this),on(this)}}}catch{}finally{}};function Da(i){return i.g?i.u=="GET"&&i.L!=2&&i.j.Ca:!1}function Gl(i,a){var u=i.C,h=a.indexOf(`
`,u);return h==-1?Ti:(u=Number(a.substring(u,h)),isNaN(u)?Pa:(h+=1,h+u>a.length?Ti:(a=a.slice(h,h+u),i.C=h+u,a)))}je.prototype.cancel=function(){this.J=!0,it(this)};function Xn(i){i.S=Date.now()+i.I,ka(i,i.I)}function ka(i,a){if(i.B!=null)throw Error("WatchDog timer not null");i.B=rn(S(i.ba,i),a)}function bi(i){i.B&&(l.clearTimeout(i.B),i.B=null)}je.prototype.ba=function(){this.B=null;let i=Date.now();0<=i-this.S?(zl(this.i,this.A),this.L!=2&&(nn(),ge(17)),it(this),this.s=2,on(this)):ka(this,this.S-i)};function on(i){i.j.G==0||i.J||rc(i.j,i)}function it(i){bi(i);var a=i.M;a&&typeof a.ma=="function"&&a.ma(),i.M=null,Ia(i.U),i.g&&(a=i.g,i.g=null,a.abort(),a.ma())}function Si(i,a){try{var u=i.j;if(u.G!=0&&(u.g==i||Ri(u.h,i))){if(!i.K&&Ri(u.h,i)&&u.G==3){try{var h=u.Da.g.parse(a)}catch{h=null}if(Array.isArray(h)&&h.length==3){var v=h;if(v[0]==0){e:if(!u.u){if(u.g)if(u.g.F+3e3<i.F)or(u),ir(u);else break e;ki(u),ge(18)}}else u.za=v[1],0<u.za-u.T&&37500>v[2]&&u.F&&u.v==0&&!u.C&&(u.C=rn(S(u.Za,u),6e3));if(1>=xa(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else ot(u,11)}else if((i.K||u.g==i)&&or(u),!j(a))for(v=u.Da.g.parse(a),a=0;a<v.length;a++){let B=v[a];if(u.T=B[0],B=B[1],u.G==2)if(B[0]=="c"){u.K=B[1],u.ia=B[2];let le=B[3];le!=null&&(u.la=le,u.j.info("VER="+u.la));let he=B[4];he!=null&&(u.Aa=he,u.j.info("SVER="+u.Aa));let bt=B[5];bt!=null&&typeof bt=="number"&&0<bt&&(h=1.5*bt,u.L=h,u.j.info("backChannelRequestTimeoutMs_="+h)),h=u;let Ae=i.g;if(Ae){let cr=Ae.g?Ae.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cr){var T=h.h;T.g||cr.indexOf("spdy")==-1&&cr.indexOf("quic")==-1&&cr.indexOf("h2")==-1||(T.j=T.l,T.g=new Set,T.h&&(Pi(T,T.h),T.h=null))}if(h.D){let Oi=Ae.g?Ae.g.getResponseHeader("X-HTTP-Session-Id"):null;Oi&&(h.ya=Oi,H(h.I,h.D,Oi))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-i.F,u.j.info("Handshake RTT: "+u.R+"ms")),h=u;var C=i;if(h.qa=oc(h,h.J?h.ia:null,h.W),C.K){Va(h.h,C);var $=C,ae=h.L;ae&&($.I=ae),$.B&&(bi($),Xn($)),h.g=C}else tc(h);0<u.i.length&&sr(u)}else B[0]!="stop"&&B[0]!="close"||ot(u,7);else u.G==3&&(B[0]=="stop"||B[0]=="close"?B[0]=="stop"?ot(u,7):Di(u):B[0]!="noop"&&u.l&&u.l.ta(B),u.v=0)}}nn(4)}catch{}}var Wl=class{constructor(i,a){this.g=i,this.map=a}};function Na(i){this.l=i||10,l.PerformanceNavigationTiming?(i=l.performance.getEntriesByType("navigation"),i=0<i.length&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Oa(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function xa(i){return i.h?1:i.g?i.g.size:0}function Ri(i,a){return i.h?i.h==a:i.g?i.g.has(a):!1}function Pi(i,a){i.g?i.g.add(a):i.h=a}function Va(i,a){i.h&&i.h==a?i.h=null:i.g&&i.g.has(a)&&i.g.delete(a)}Na.prototype.cancel=function(){if(this.i=La(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let i of this.g.values())i.cancel();this.g.clear()}};function La(i){if(i.h!=null)return i.i.concat(i.h.D);if(i.g!=null&&i.g.size!==0){let a=i.i;for(let u of i.g.values())a=a.concat(u.D);return a}return V(i.i)}function Kl(i){if(i.V&&typeof i.V=="function")return i.V();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if(typeof i=="string")return i.split("");if(d(i)){for(var a=[],u=i.length,h=0;h<u;h++)a.push(i[h]);return a}a=[],u=0;for(h in i)a[u++]=i[h];return a}function Hl(i){if(i.na&&typeof i.na=="function")return i.na();if(!i.V||typeof i.V!="function"){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(d(i)||typeof i=="string"){var a=[];i=i.length;for(var u=0;u<i;u++)a.push(u);return a}a=[],u=0;for(let h in i)a[u++]=h;return a}}}function Ma(i,a){if(i.forEach&&typeof i.forEach=="function")i.forEach(a,void 0);else if(d(i)||typeof i=="string")Array.prototype.forEach.call(i,a,void 0);else for(var u=Hl(i),h=Kl(i),v=h.length,T=0;T<v;T++)a.call(void 0,h[T],u&&u[T],i)}var Fa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ql(i,a){if(i){i=i.split("&");for(var u=0;u<i.length;u++){var h=i[u].indexOf("="),v=null;if(0<=h){var T=i[u].substring(0,h);v=i[u].substring(h+1)}else T=i[u];a(T,v?decodeURIComponent(v.replace(/\+/g," ")):"")}}}function st(i){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,i instanceof st){this.h=i.h,Zn(this,i.j),this.o=i.o,this.g=i.g,er(this,i.s),this.l=i.l;var a=i.i,u=new un;u.i=a.i,a.g&&(u.g=new Map(a.g),u.h=a.h),Ua(this,u),this.m=i.m}else i&&(a=String(i).match(Fa))?(this.h=!1,Zn(this,a[1]||"",!0),this.o=an(a[2]||""),this.g=an(a[3]||"",!0),er(this,a[4]),this.l=an(a[5]||"",!0),Ua(this,a[6]||"",!0),this.m=an(a[7]||"")):(this.h=!1,this.i=new un(null,this.h))}st.prototype.toString=function(){var i=[],a=this.j;a&&i.push(cn(a,Ba,!0),":");var u=this.g;return(u||a=="file")&&(i.push("//"),(a=this.o)&&i.push(cn(a,Ba,!0),"@"),i.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&i.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&i.push("/"),i.push(cn(u,u.charAt(0)=="/"?Xl:Yl,!0))),(u=this.i.toString())&&i.push("?",u),(u=this.m)&&i.push("#",cn(u,eh)),i.join("")};function xe(i){return new st(i)}function Zn(i,a,u){i.j=u?an(a,!0):a,i.j&&(i.j=i.j.replace(/:$/,""))}function er(i,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);i.s=a}else i.s=null}function Ua(i,a,u){a instanceof un?(i.i=a,th(i.i,i.h)):(u||(a=cn(a,Zl)),i.i=new un(a,i.h))}function H(i,a,u){i.i.set(a,u)}function tr(i){return H(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function an(i,a){return i?a?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function cn(i,a,u){return typeof i=="string"?(i=encodeURI(i).replace(a,Jl),u&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function Jl(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var Ba=/[#\/\?@]/g,Yl=/[#\?:]/g,Xl=/[#\?]/g,Zl=/[#\?@]/g,eh=/#/g;function un(i,a){this.h=this.g=null,this.i=i||null,this.j=!!a}function Ge(i){i.g||(i.g=new Map,i.h=0,i.i&&Ql(i.i,function(a,u){i.add(decodeURIComponent(a.replace(/\+/g," ")),u)}))}n=un.prototype,n.add=function(i,a){Ge(this),this.i=null,i=Tt(this,i);var u=this.g.get(i);return u||this.g.set(i,u=[]),u.push(a),this.h+=1,this};function qa(i,a){Ge(i),a=Tt(i,a),i.g.has(a)&&(i.i=null,i.h-=i.g.get(a).length,i.g.delete(a))}function $a(i,a){return Ge(i),a=Tt(i,a),i.g.has(a)}n.forEach=function(i,a){Ge(this),this.g.forEach(function(u,h){u.forEach(function(v){i.call(a,v,h,this)},this)},this)},n.na=function(){Ge(this);let i=Array.from(this.g.values()),a=Array.from(this.g.keys()),u=[];for(let h=0;h<a.length;h++){let v=i[h];for(let T=0;T<v.length;T++)u.push(a[h])}return u},n.V=function(i){Ge(this);let a=[];if(typeof i=="string")$a(this,i)&&(a=a.concat(this.g.get(Tt(this,i))));else{i=Array.from(this.g.values());for(let u=0;u<i.length;u++)a=a.concat(i[u])}return a},n.set=function(i,a){return Ge(this),this.i=null,i=Tt(this,i),$a(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[a]),this.h+=1,this},n.get=function(i,a){return i?(i=this.V(i),0<i.length?String(i[0]):a):a};function za(i,a,u){qa(i,a),0<u.length&&(i.i=null,i.g.set(Tt(i,a),V(u)),i.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let i=[],a=Array.from(this.g.keys());for(var u=0;u<a.length;u++){var h=a[u];let T=encodeURIComponent(String(h)),C=this.V(h);for(h=0;h<C.length;h++){var v=T;C[h]!==""&&(v+="="+encodeURIComponent(String(C[h]))),i.push(v)}}return this.i=i.join("&")};function Tt(i,a){return a=String(a),i.j&&(a=a.toLowerCase()),a}function th(i,a){a&&!i.j&&(Ge(i),i.i=null,i.g.forEach(function(u,h){var v=h.toLowerCase();h!=v&&(qa(this,h),za(this,v,u))},i)),i.j=a}function nh(i,a){let u=new sn;if(l.Image){let h=new Image;h.onload=D(We,u,"TestLoadImage: loaded",!0,a,h),h.onerror=D(We,u,"TestLoadImage: error",!1,a,h),h.onabort=D(We,u,"TestLoadImage: abort",!1,a,h),h.ontimeout=D(We,u,"TestLoadImage: timeout",!1,a,h),l.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=i}else a(!1)}function rh(i,a){let u=new sn,h=new AbortController,v=setTimeout(()=>{h.abort(),We(u,"TestPingServer: timeout",!1,a)},1e4);fetch(i,{signal:h.signal}).then(T=>{clearTimeout(v),T.ok?We(u,"TestPingServer: ok",!0,a):We(u,"TestPingServer: server error",!1,a)}).catch(()=>{clearTimeout(v),We(u,"TestPingServer: error",!1,a)})}function We(i,a,u,h,v){try{v&&(v.onload=null,v.onerror=null,v.onabort=null,v.ontimeout=null),h(u)}catch{}}function ih(){this.g=new Bl}function sh(i,a,u){let h=u||"";try{Ma(i,function(v,T){let C=v;f(v)&&(C=yi(v)),a.push(h+T+"="+encodeURIComponent(C))})}catch(v){throw a.push(h+"type="+encodeURIComponent("_badmap")),v}}function ln(i){this.l=i.Ub||null,this.j=i.eb||!1}k(ln,Ii),ln.prototype.g=function(){return new nr(this.l,this.j)},ln.prototype.i=function(i){return function(){return i}}({});function nr(i,a){ue.call(this),this.D=i,this.o=a,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(nr,ue),n=nr.prototype,n.open=function(i,a){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=i,this.A=a,this.readyState=1,dn(this)},n.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let a={headers:this.u,method:this.B,credentials:this.m,cache:void 0};i&&(a.body=i),(this.D||l).fetch(new Request(this.A,a)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hn(this)),this.readyState=0},n.Sa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,dn(this)),this.g&&(this.readyState=3,dn(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ja(this)}else i.text().then(this.Ra.bind(this),this.ga.bind(this))};function ja(i){i.j.read().then(i.Pa.bind(i)).catch(i.ga.bind(i))}n.Pa=function(i){if(this.g){if(this.o&&i.value)this.response.push(i.value);else if(!this.o){var a=i.value?i.value:new Uint8Array(0);(a=this.v.decode(a,{stream:!i.done}))&&(this.response=this.responseText+=a)}i.done?hn(this):dn(this),this.readyState==3&&ja(this)}},n.Ra=function(i){this.g&&(this.response=this.responseText=i,hn(this))},n.Qa=function(i){this.g&&(this.response=i,hn(this))},n.ga=function(){this.g&&hn(this)};function hn(i){i.readyState=4,i.l=null,i.j=null,i.v=null,dn(i)}n.setRequestHeader=function(i,a){this.u.append(i,a)},n.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let i=[],a=this.h.entries();for(var u=a.next();!u.done;)u=u.value,i.push(u[0]+": "+u[1]),u=a.next();return i.join(`\r
`)};function dn(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(nr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});function Ga(i){let a="";return ne(i,function(u,h){a+=h,a+=":",a+=u,a+=`\r
`}),a}function Ci(i,a,u){e:{for(h in u){var h=!1;break e}h=!0}h||(u=Ga(u),typeof i=="string"?u!=null&&encodeURIComponent(String(u)):H(i,a,u))}function Q(i){ue.call(this),this.headers=new Map,this.o=i||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(Q,ue);var oh=/^https?$/i,ah=["POST","PUT"];n=Q.prototype,n.Ha=function(i){this.J=i},n.ea=function(i,a,u,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+i);a=a?a.toUpperCase():"GET",this.D=i,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wi.g(),this.v=this.o?va(this.o):va(wi),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(a,String(i),!0),this.B=!1}catch(T){Wa(this,T);return}if(i=u||"",u=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var v in h)u.set(v,h[v]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(let T of h.keys())u.set(T,h.get(T));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(u.keys()).find(T=>T.toLowerCase()=="content-type"),v=l.FormData&&i instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ah,a,void 0))||h||v||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[T,C]of u)this.g.setRequestHeader(T,C);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qa(this),this.u=!0,this.g.send(i),this.u=!1}catch(T){Wa(this,T)}};function Wa(i,a){i.h=!1,i.g&&(i.j=!0,i.g.abort(),i.j=!1),i.l=a,i.m=5,Ka(i),rr(i)}function Ka(i){i.A||(i.A=!0,me(i,"complete"),me(i,"error"))}n.abort=function(i){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=i||7,me(this,"complete"),me(this,"abort"),rr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rr(this,!0)),Q.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ha(this):this.bb())},n.bb=function(){Ha(this)};function Ha(i){if(i.h&&typeof c<"u"&&(!i.v[1]||Ve(i)!=4||i.Z()!=2)){if(i.u&&Ve(i)==4)ga(i.Ea,0,i);else if(me(i,"readystatechange"),Ve(i)==4){i.h=!1;try{let C=i.Z();e:switch(C){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break e;default:a=!1}var u;if(!(u=a)){var h;if(h=C===0){var v=String(i.D).match(Fa)[1]||null;!v&&l.self&&l.self.location&&(v=l.self.location.protocol.slice(0,-1)),h=!oh.test(v?v.toLowerCase():"")}u=h}if(u)me(i,"complete"),me(i,"success");else{i.m=6;try{var T=2<Ve(i)?i.g.statusText:""}catch{T=""}i.l=T+" ["+i.Z()+"]",Ka(i)}}finally{rr(i)}}}}function rr(i,a){if(i.g){Qa(i);let u=i.g,h=i.v[0]?()=>{}:null;i.g=null,i.v=null,a||me(i,"ready");try{u.onreadystatechange=h}catch{}}}function Qa(i){i.I&&(l.clearTimeout(i.I),i.I=null)}n.isActive=function(){return!!this.g};function Ve(i){return i.g?i.g.readyState:0}n.Z=function(){try{return 2<Ve(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(i){if(this.g){var a=this.g.responseText;return i&&a.indexOf(i)==0&&(a=a.substring(i.length)),Ul(a)}};function Ja(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.H){case"":case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function ch(i){let a={};i=(i.g&&2<=Ve(i)&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<i.length;h++){if(j(i[h]))continue;var u=y(i[h]);let v=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let T=a[v]||[];a[v]=T,T.push(u)}I(a,function(h){return h.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fn(i,a,u){return u&&u.internalChannelParams&&u.internalChannelParams[i]||a}function Ya(i){this.Aa=0,this.i=[],this.j=new sn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fn("failFast",!1,i),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fn("baseRetryDelayMs",5e3,i),this.cb=fn("retryDelaySeedMs",1e4,i),this.Wa=fn("forwardChannelMaxRetries",2,i),this.wa=fn("forwardChannelRequestTimeoutMs",2e4,i),this.pa=i&&i.xmlHttpFactory||void 0,this.Xa=i&&i.Tb||void 0,this.Ca=i&&i.useFetchStreams||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.h=new Na(i&&i.concurrentRequestLimit),this.Da=new ih,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=i&&i.Rb||!1,i&&i.xa&&this.j.xa(),i&&i.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&i&&i.detectBufferingProxy||!1,this.ja=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.ja=i.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ya.prototype,n.la=8,n.G=1,n.connect=function(i,a,u,h){ge(0),this.W=i,this.H=a||{},u&&h!==void 0&&(this.H.OSID=u,this.H.OAID=h),this.F=this.X,this.I=oc(this,null,this.W),sr(this)};function Di(i){if(Xa(i),i.G==3){var a=i.U++,u=xe(i.I);if(H(u,"SID",i.K),H(u,"RID",a),H(u,"TYPE","terminate"),pn(i,u),a=new je(i,i.j,a),a.L=2,a.v=tr(xe(u)),u=!1,l.navigator&&l.navigator.sendBeacon)try{u=l.navigator.sendBeacon(a.v.toString(),"")}catch{}!u&&l.Image&&(new Image().src=a.v,u=!0),u||(a.g=ac(a.j,null),a.g.ea(a.v)),a.F=Date.now(),Xn(a)}sc(i)}function ir(i){i.g&&(Ni(i),i.g.cancel(),i.g=null)}function Xa(i){ir(i),i.u&&(l.clearTimeout(i.u),i.u=null),or(i),i.h.cancel(),i.s&&(typeof i.s=="number"&&l.clearTimeout(i.s),i.s=null)}function sr(i){if(!Oa(i.h)&&!i.s){i.s=!0;var a=i.Ga;Jt||la(),Yt||(Jt(),Yt=!0),ui.add(a,i),i.B=0}}function uh(i,a){return xa(i.h)>=i.h.j-(i.s?1:0)?!1:i.s?(i.i=a.D.concat(i.i),!0):i.G==1||i.G==2||i.B>=(i.Va?0:i.Wa)?!1:(i.s=rn(S(i.Ga,i,a),ic(i,i.B)),i.B++,!0)}n.Ga=function(i){if(this.s)if(this.s=null,this.G==1){if(!i){this.U=Math.floor(1e5*Math.random()),i=this.U++;let v=new je(this,this.j,i),T=this.o;if(this.S&&(T?(T=p(T),_(T,this.S)):T=this.S),this.m!==null||this.O||(v.H=T,T=null),this.P)e:{for(var a=0,u=0;u<this.i.length;u++){t:{var h=this.i[u];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break t}h=void 0}if(h===void 0)break;if(a+=h,4096<a){a=u;break e}if(a===4096||u===this.i.length-1){a=u+1;break e}}a=1e3}else a=1e3;a=ec(this,v,a),u=xe(this.I),H(u,"RID",i),H(u,"CVER",22),this.D&&H(u,"X-HTTP-Session-Id",this.D),pn(this,u),T&&(this.O?a="headers="+encodeURIComponent(String(Ga(T)))+"&"+a:this.m&&Ci(u,this.m,T)),Pi(this.h,v),this.Ua&&H(u,"TYPE","init"),this.P?(H(u,"$req",a),H(u,"SID","null"),v.T=!0,Ai(v,u,null)):Ai(v,u,a),this.G=2}}else this.G==3&&(i?Za(this,i):this.i.length==0||Oa(this.h)||Za(this))};function Za(i,a){var u;a?u=a.l:u=i.U++;let h=xe(i.I);H(h,"SID",i.K),H(h,"RID",u),H(h,"AID",i.T),pn(i,h),i.m&&i.o&&Ci(h,i.m,i.o),u=new je(i,i.j,u,i.B+1),i.m===null&&(u.H=i.o),a&&(i.i=a.D.concat(i.i)),a=ec(i,u,1e3),u.I=Math.round(.5*i.wa)+Math.round(.5*i.wa*Math.random()),Pi(i.h,u),Ai(u,h,a)}function pn(i,a){i.H&&ne(i.H,function(u,h){H(a,h,u)}),i.l&&Ma({},function(u,h){H(a,h,u)})}function ec(i,a,u){u=Math.min(i.i.length,u);var h=i.l?S(i.l.Na,i.l,i):null;e:{var v=i.i;let T=-1;for(;;){let C=["count="+u];T==-1?0<u?(T=v[0].g,C.push("ofs="+T)):T=0:C.push("ofs="+T);let $=!0;for(let ae=0;ae<u;ae++){let B=v[ae].g,le=v[ae].map;if(B-=T,0>B)T=Math.max(0,v[ae].g-100),$=!1;else try{sh(le,C,"req"+B+"_")}catch{h&&h(le)}}if($){h=C.join("&");break e}}}return i=i.i.splice(0,u),a.D=i,h}function tc(i){if(!i.g&&!i.u){i.Y=1;var a=i.Fa;Jt||la(),Yt||(Jt(),Yt=!0),ui.add(a,i),i.v=0}}function ki(i){return i.g||i.u||3<=i.v?!1:(i.Y++,i.u=rn(S(i.Fa,i),ic(i,i.v)),i.v++,!0)}n.Fa=function(){if(this.u=null,nc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var i=2*this.R;this.j.info("BP detection timer enabled: "+i),this.A=rn(S(this.ab,this),i)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ge(10),ir(this),nc(this))};function Ni(i){i.A!=null&&(l.clearTimeout(i.A),i.A=null)}function nc(i){i.g=new je(i,i.j,"rpc",i.Y),i.m===null&&(i.g.H=i.o),i.g.O=0;var a=xe(i.qa);H(a,"RID","rpc"),H(a,"SID",i.K),H(a,"AID",i.T),H(a,"CI",i.F?"0":"1"),!i.F&&i.ja&&H(a,"TO",i.ja),H(a,"TYPE","xmlhttp"),pn(i,a),i.m&&i.o&&Ci(a,i.m,i.o),i.L&&(i.g.I=i.L);var u=i.g;i=i.ia,u.L=1,u.v=tr(xe(a)),u.m=null,u.P=!0,Ca(u,i)}n.Za=function(){this.C!=null&&(this.C=null,ir(this),ki(this),ge(19))};function or(i){i.C!=null&&(l.clearTimeout(i.C),i.C=null)}function rc(i,a){var u=null;if(i.g==a){or(i),Ni(i),i.g=null;var h=2}else if(Ri(i.h,a))u=a.D,Va(i.h,a),h=1;else return;if(i.G!=0){if(a.o)if(h==1){u=a.m?a.m.length:0,a=Date.now()-a.F;var v=i.B;h=Qn(),me(h,new ba(h,u)),sr(i)}else tc(i);else if(v=a.s,v==3||v==0&&0<a.X||!(h==1&&uh(i,a)||h==2&&ki(i)))switch(u&&0<u.length&&(a=i.h,a.i=a.i.concat(u)),v){case 1:ot(i,5);break;case 4:ot(i,10);break;case 3:ot(i,6);break;default:ot(i,2)}}}function ic(i,a){let u=i.Ta+Math.floor(Math.random()*i.cb);return i.isActive()||(u*=2),u*a}function ot(i,a){if(i.j.info("Error code "+a),a==2){var u=S(i.fb,i),h=i.Xa;let v=!h;h=new st(h||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Zn(h,"https"),tr(h),v?nh(h.toString(),u):rh(h.toString(),u)}else ge(2);i.G=0,i.l&&i.l.sa(a),sc(i),Xa(i)}n.fb=function(i){i?(this.j.info("Successfully pinged google.com"),ge(2)):(this.j.info("Failed to ping google.com"),ge(1))};function sc(i){if(i.G=0,i.ka=[],i.l){let a=La(i.h);(a.length!=0||i.i.length!=0)&&(O(i.ka,a),O(i.ka,i.i),i.h.i.length=0,V(i.i),i.i.length=0),i.l.ra()}}function oc(i,a,u){var h=u instanceof st?xe(u):new st(u);if(h.g!="")a&&(h.g=a+"."+h.g),er(h,h.s);else{var v=l.location;h=v.protocol,a=a?a+"."+v.hostname:v.hostname,v=+v.port;var T=new st(null);h&&Zn(T,h),a&&(T.g=a),v&&er(T,v),u&&(T.l=u),h=T}return u=i.D,a=i.ya,u&&a&&H(h,u,a),H(h,"VER",i.la),pn(i,h),h}function ac(i,a,u){if(a&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return a=i.Ca&&!i.pa?new Q(new ln({eb:u})):new Q(i.pa),a.Ha(i.J),a}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cc(){}n=cc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ar(){}ar.prototype.g=function(i,a){return new ye(i,a)};function ye(i,a){ue.call(this),this.g=new Ya(a),this.l=i,this.h=a&&a.messageUrlParams||null,i=a&&a.messageHeaders||null,a&&a.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.o=i,i=a&&a.initMessageHeaders||null,a&&a.messageContentType&&(i?i["X-WebChannel-Content-Type"]=a.messageContentType:i={"X-WebChannel-Content-Type":a.messageContentType}),a&&a.va&&(i?i["X-WebChannel-Client-Profile"]=a.va:i={"X-WebChannel-Client-Profile":a.va}),this.g.S=i,(i=a&&a.Sb)&&!j(i)&&(this.g.m=i),this.v=a&&a.supportsCrossDomainXhr||!1,this.u=a&&a.sendRawJson||!1,(a=a&&a.httpSessionIdParam)&&!j(a)&&(this.g.D=a,i=this.h,i!==null&&a in i&&(i=this.h,a in i&&delete i[a])),this.j=new At(this)}k(ye,ue),ye.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ye.prototype.close=function(){Di(this.g)},ye.prototype.o=function(i){var a=this.g;if(typeof i=="string"){var u={};u.__data__=i,i=u}else this.u&&(u={},u.__data__=yi(i),i=u);a.i.push(new Wl(a.Ya++,i)),a.G==3&&sr(a)},ye.prototype.N=function(){this.g.l=null,delete this.j,Di(this.g),delete this.g,ye.aa.N.call(this)};function uc(i){vi.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var a=i.__sm__;if(a){e:{for(let u in a){i=u;break e}i=void 0}(this.i=i)&&(i=this.i,a=a!==null&&i in a?a[i]:void 0),this.data=a}else this.data=i}k(uc,vi);function lc(){Ei.call(this),this.status=1}k(lc,Ei);function At(i){this.g=i}k(At,cc),At.prototype.ua=function(){me(this.g,"a")},At.prototype.ta=function(i){me(this.g,new uc(i))},At.prototype.sa=function(i){me(this.g,new lc)},At.prototype.ra=function(){me(this.g,"b")},ar.prototype.createWebChannel=ar.prototype.g,ye.prototype.send=ye.prototype.o,ye.prototype.open=ye.prototype.m,ye.prototype.close=ye.prototype.close,Cs=Fe.createWebChannelTransport=function(){return new ar},Ps=Fe.getStatEventTarget=function(){return Qn()},Rs=Fe.Event=rt,kr=Fe.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jn.NO_ERROR=0,Jn.TIMEOUT=8,Jn.HTTP_ERROR=6,Pn=Fe.ErrorCode=Jn,Sa.COMPLETE="complete",Ss=Fe.EventType=Sa,Ea.EventType=tn,tn.OPEN="a",tn.CLOSE="b",tn.ERROR="c",tn.MESSAGE="d",ue.prototype.listen=ue.prototype.K,Nt=Fe.WebChannel=Ea,lp=Fe.FetchXmlHttpFactory=ln,Q.prototype.listenOnce=Q.prototype.L,Q.prototype.getLastError=Q.prototype.Ka,Q.prototype.getLastErrorCode=Q.prototype.Ba,Q.prototype.getStatus=Q.prototype.Z,Q.prototype.getResponseJson=Q.prototype.Oa,Q.prototype.getResponseText=Q.prototype.oa,Q.prototype.send=Q.prototype.ea,Q.prototype.setWithCredentials=Q.prototype.Ha,bs=Fe.XhrIo=Q}).apply(typeof Dr<"u"?Dr:typeof self<"u"?self:typeof window<"u"?window:{});var gu="@firebase/firestore";var ie=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ie.UNAUTHENTICATED=new ie(null),ie.GOOGLE_CREDENTIALS=new ie("google-credentials-uid"),ie.FIRST_PARTY=new ie("first-party-uid"),ie.MOCK_USER=new ie("mock-user");var Ht="10.14.0";var mt=new He("@firebase/firestore");function Cn(){return mt.logLevel}function N(n,...e){if(mt.logLevel<=M.DEBUG){let t=e.map(Zo);mt.debug(`Firestore (${Ht}): ${n}`,...t)}}function gt(n,...e){if(mt.logLevel<=M.ERROR){let t=e.map(Zo);mt.error(`Firestore (${Ht}): ${n}`,...t)}}function Mr(n,...e){if(mt.logLevel<=M.WARN){let t=e.map(Zo);mt.warn(`Firestore (${Ht}): ${n}`,...t)}}function Zo(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function F(n="Unexpected state"){let e=`FIRESTORE (${Ht}) INTERNAL ASSERTION FAILED: `+n;throw gt(e),new Error(e)}function Y(n,e){n||F()}function G(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends we{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ue=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Fr=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Os=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ie.UNAUTHENTICATED))}shutdown(){}},xs=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Vs=class{constructor(e){this.t=e,this.currentUser=ie.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0);let r=this.i,s=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve(),o=new Ue;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ue,e.enqueueRetryable(()=>s(this.currentUser))};let c=()=>{let d=o;e.enqueueRetryable(()=>A(this,null,function*(){yield d.promise,yield s(this.currentUser)}))},l=d=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){let d=this.t.getImmediate({optional:!0});d?l(d):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ue)}},0),c()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new Fr(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new ie(e)}},Ls=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ie.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Ms=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ls(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ie.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Fs=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Us=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Y(this.o===void 0);let r=o=>{o.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let c=o.token!==this.R;return this.R=o.token,N("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let s=o=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?s(o):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string"),this.R=t.token,new Fs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function hp(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ur=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let s=hp(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<t&&(r+=e.charAt(s[o]%e.length))}return r}};function z(n,e){return n<e?-1:n>e?1:0}function Lt(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}var pe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?z(this.nanoseconds,e.nanoseconds):z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var J=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new pe(0,0))}static max(){return new n(new pe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Br=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&F(),r===void 0?r=e.length-t:r>e.length-t&&F(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let s=0;s<r;s++){let o=e.get(s),c=t.get(s);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},se=class n extends Br{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new n(t)}static emptyPath(){return new n([])}},dp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ve=class n extends Br{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return dp.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",s=0,o=()=>{if(r.length===0)throw new x(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},c=!1;for(;s<e.length;){let l=e[s];if(l==="\\"){if(s+1===e.length)throw new x(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new x(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,s+=2}else l==="`"?(c=!c,s++):l!=="."||c?(r+=l,s++):(o(),s++)}if(o(),c)throw new x(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(se.fromString(e))}static fromName(e){return new n(se.fromString(e).popFirst(5))}static empty(){return new n(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new se(e.slice()))}};var Bs=class{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}};Bs.UNKNOWN_ID=-1;function fp(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=J.fromTimestamp(r===1e9?new pe(t+1,0):new pe(t,r));return new _t(s,L.empty(),e)}function pp(n){return new _t(n.readTime,n.key,-1)}var _t=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(J.min(),L.empty(),-1)}static max(){return new n(J.max(),L.empty(),-1)}};function mp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:z(n.largestBatchId,e.largestBatchId))}var gp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qs=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Fu(n){return A(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==gp)throw n;N("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let s=0,o=0,c=!1;e.forEach(l=>{++s,l.next(()=>{++o,c&&o===s&&t()},d=>r(d))}),c=!0,o===s&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(s=>s?n.resolve(s):r());return t}static forEach(e,t){let r=[];return e.forEach((s,o)=>{r.push(t.call(this,s,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,s)=>{let o=e.length,c=new Array(o),l=0;for(let d=0;d<o;d++){let f=d;t(e[f]).next(E=>{c[f]=E,++l,l===o&&r(c)},E=>s(E))}})}static doWhile(e,t){return new n((r,s)=>{let o=()=>{e()===!0?t().next(()=>{o()},s):r()};o()})}};function _p(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ii(n){return n.name==="IndexedDbTransactionError"}var yp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=s=>this.ie(s),this.se=s=>r.writeSequenceNumber(s))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function ea(n){return n==null}function Vn(n){return n===0&&1/n==-1/0}function Ip(n){return typeof n=="number"&&Number.isInteger(n)&&!Vn(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var vp=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],J_=[...vp,"documentOverlays"],Ep=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wp=Ep,Tp=[...wp,"indexConfiguration","indexState","indexEntries"];var Y_=[...Tp,"globals"];function _u(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $n(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Uu(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ee=class n{constructor(e,t){this.comparator=e,this.root=t||ke.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ke.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ke.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xt(this.root,e,this.comparator,!1)}getReverseIterator(){return new xt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xt(this.root,e,this.comparator,!0)}},xt=class{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ke=class n{constructor(e,t,r,s,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,o){return new n(e??this.key,t??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this,o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,r),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return n.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();let e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}};ke.EMPTY=null,ke.RED=!0,ke.BLACK=!1;ke.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(e,t,r,s,o){return this}insert(e,t,r){return new ke(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var _e=class n{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qr(this.data.getIterator())}getIteratorFrom(e){return new qr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let s=t.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},qr=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var De=class n{constructor(e){this.fields=e,e.sort(ve.comparator)}static empty(){return new n([])}unionWith(e){let t=new _e(ve.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lt(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var $s=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var qe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new $s("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};qe.EMPTY_BYTE_STRING=new qe("");var Ap=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ze(n){if(Y(!!n),typeof n=="string"){let e=0,t=Ap.exec(n);if(Y(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ee(n.seconds),nanos:ee(n.nanos)}}function ee(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Mt(n){return typeof n=="string"?qe.fromBase64String(n):qe.fromUint8Array(n)}function ta(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Bu(n){let e=n.mapValue.fields.__previous_value__;return ta(e)?Bu(e):e}function $r(n){let e=Ze(n.mapValue.fields.__local_write_time__.timestampValue);return new pe(e.seconds,e.nanos)}var zs=class{constructor(e,t,r,s,o,c,l,d,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=f}},js=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Nr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ft(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ta(n)?4:$u(n)?9007199254740991:qu(n)?10:11:F()}function Ne(n,e){if(n===e)return!0;let t=Ft(n);if(t!==Ft(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $r(n).isEqual($r(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;let c=Ze(s.timestampValue),l=Ze(o.timestampValue);return c.seconds===l.seconds&&c.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,o){return Mt(s.bytesValue).isEqual(Mt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,o){return ee(s.geoPointValue.latitude)===ee(o.geoPointValue.latitude)&&ee(s.geoPointValue.longitude)===ee(o.geoPointValue.longitude)}(n,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return ee(s.integerValue)===ee(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){let c=ee(s.doubleValue),l=ee(o.doubleValue);return c===l?Vn(c)===Vn(l):isNaN(c)&&isNaN(l)}return!1}(n,e);case 9:return Lt(n.arrayValue.values||[],e.arrayValue.values||[],Ne);case 10:case 11:return function(s,o){let c=s.mapValue.fields||{},l=o.mapValue.fields||{};if(_u(c)!==_u(l))return!1;for(let d in c)if(c.hasOwnProperty(d)&&(l[d]===void 0||!Ne(c[d],l[d])))return!1;return!0}(n,e);default:return F()}}function Ln(n,e){return(n.values||[]).find(t=>Ne(t,e))!==void 0}function Ut(n,e){if(n===e)return 0;let t=Ft(n),r=Ft(e);if(t!==r)return z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return z(n.booleanValue,e.booleanValue);case 2:return function(o,c){let l=ee(o.integerValue||o.doubleValue),d=ee(c.integerValue||c.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(n,e);case 3:return yu(n.timestampValue,e.timestampValue);case 4:return yu($r(n),$r(e));case 5:return z(n.stringValue,e.stringValue);case 6:return function(o,c){let l=Mt(o),d=Mt(c);return l.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(o,c){let l=o.split("/"),d=c.split("/");for(let f=0;f<l.length&&f<d.length;f++){let E=z(l[f],d[f]);if(E!==0)return E}return z(l.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,c){let l=z(ee(o.latitude),ee(c.latitude));return l!==0?l:z(ee(o.longitude),ee(c.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Iu(n.arrayValue,e.arrayValue);case 10:return function(o,c){var l,d,f,E;let b=o.fields||{},S=c.fields||{},D=(l=b.value)===null||l===void 0?void 0:l.arrayValue,k=(d=S.value)===null||d===void 0?void 0:d.arrayValue,V=z(((f=D?.values)===null||f===void 0?void 0:f.length)||0,((E=k?.values)===null||E===void 0?void 0:E.length)||0);return V!==0?V:Iu(D,k)}(n.mapValue,e.mapValue);case 11:return function(o,c){if(o===Nr.mapValue&&c===Nr.mapValue)return 0;if(o===Nr.mapValue)return 1;if(c===Nr.mapValue)return-1;let l=o.fields||{},d=Object.keys(l),f=c.fields||{},E=Object.keys(f);d.sort(),E.sort();for(let b=0;b<d.length&&b<E.length;++b){let S=z(d[b],E[b]);if(S!==0)return S;let D=Ut(l[d[b]],f[E[b]]);if(D!==0)return D}return z(d.length,E.length)}(n.mapValue,e.mapValue);default:throw F()}}function yu(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return z(n,e);let t=Ze(n),r=Ze(e),s=z(t.seconds,r.seconds);return s!==0?s:z(t.nanos,r.nanos)}function Iu(n,e){let t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){let o=Ut(t[s],r[s]);if(o)return o}return z(t.length,r.length)}function Bt(n){return Gs(n)}function Gs(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Ze(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Mt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(let o of t.values||[])s?s=!1:r+=",",r+=Gs(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),s="{",o=!0;for(let c of r)o?o=!1:s+=",",s+=`${c}:${Gs(t.fields[c])}`;return s+"}"}(n.mapValue):F()}function Ws(n){return!!n&&"integerValue"in n}function na(n){return!!n&&"arrayValue"in n}function Vr(n){return!!n&&"mapValue"in n}function qu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function kn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return $n(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=kn(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=kn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $u(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ce=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Vr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=kn(t)}setAll(e){let t=ve.emptyPath(),r={},s=[];e.forEach((c,l)=>{if(!t.isImmediateParentOf(l)){let d=this.getFieldsMap(t);this.applyChanges(d,r,s),r={},s=[],t=l.popLast()}c?r[l.lastSegment()]=kn(c):s.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,s)}delete(e){let t=this.field(e.popLast());Vr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ne(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Vr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){$n(t,(s,o)=>e[s]=o);for(let s of r)delete e[s]}clone(){return new n(kn(this.value))}};function zu(n){let e=[];return $n(n.fields,(t,r)=>{let s=new ve([t]);if(Vr(r)){let o=zu(r.mapValue).fields;if(o.length===0)e.push(s);else for(let c of o)e.push(s.child(c))}else e.push(s)}),new De(e)}var qt=class n{constructor(e,t,r,s,o,c,l){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=o,this.data=c,this.documentState=l}static newInvalidDocument(e){return new n(e,0,J.min(),J.min(),J.min(),Ce.empty(),0)}static newFoundDocument(e,t,r,s){return new n(e,1,t,J.min(),r,s,0)}static newNoDocument(e,t){return new n(e,2,t,J.min(),J.min(),Ce.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,J.min(),J.min(),Ce.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ce.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ce.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var $t=class{constructor(e,t){this.position=e,this.inclusive=t}};function vu(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){let o=e[s],c=n.position[s];if(o.field.isKeyField()?r=L.comparator(L.fromName(c.referenceValue),t.key):r=Ut(c,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Eu(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ne(n.position[t],e.position[t]))return!1;return!0}var zt=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function bp(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var zr=class{},oe=class n extends zr{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Hs(e,t,r):t==="array-contains"?new Ys(e,r):t==="in"?new Xs(e,r):t==="not-in"?new Zs(e,r):t==="array-contains-any"?new eo(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Qs(e,r):new Js(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ut(t,this.value)):t!==null&&Ft(this.value)===Ft(t)&&this.matchesComparison(Ut(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},et=class n extends zr{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ju(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ju(n){return n.op==="and"}function Gu(n){return Sp(n)&&ju(n)}function Sp(n){for(let e of n.filters)if(e instanceof et)return!1;return!0}function Ks(n){if(n instanceof oe)return n.field.canonicalString()+n.op.toString()+Bt(n.value);if(Gu(n))return n.filters.map(e=>Ks(e)).join(",");{let e=n.filters.map(t=>Ks(t)).join(",");return`${n.op}(${e})`}}function Wu(n,e){return n instanceof oe?function(r,s){return s instanceof oe&&r.op===s.op&&r.field.isEqual(s.field)&&Ne(r.value,s.value)}(n,e):n instanceof et?function(r,s){return s instanceof et&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,c,l)=>o&&Wu(c,s.filters[l]),!0):!1}(n,e):void F()}function Ku(n){return n instanceof oe?function(t){return`${t.field.canonicalString()} ${t.op} ${Bt(t.value)}`}(n):n instanceof et?function(t){return t.op.toString()+" {"+t.getFilters().map(Ku).join(" ,")+"}"}(n):"Filter"}var Hs=class extends oe{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},Qs=class extends oe{constructor(e,t){super(e,"in",t),this.keys=Hu("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Js=class extends oe{constructor(e,t){super(e,"not-in",t),this.keys=Hu("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Hu(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var Ys=class extends oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return na(t)&&Ln(t.arrayValue,this.value)}},Xs=class extends oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ln(this.value.arrayValue,t)}},Zs=class extends oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ln(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ln(this.value.arrayValue,t)}},eo=class extends oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!na(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ln(this.value.arrayValue,r))}};var to=class{constructor(e,t=null,r=[],s=[],o=null,c=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=c,this.endAt=l,this.ue=null}};function wu(n,e=null,t=[],r=[],s=null,o=null,c=null){return new to(n,e,t,r,s,o,c)}function ra(n){let e=G(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ks(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),ea(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Bt(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Bt(r)).join(",")),e.ue=t}return e.ue}function ia(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bp(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Wu(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Eu(n.startAt,e.startAt)&&Eu(n.endAt,e.endAt)}var jt=class{constructor(e,t=null,r=[],s=[],o=null,c="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=c,this.startAt=l,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Rp(n,e,t,r,s,o,c,l){return new jt(n,e,t,r,s,o,c,l)}function Pp(n){return new jt(n)}function Tu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Cp(n){return n.collectionGroup!==null}function Nn(n){let e=G(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let l=new _e(ve.comparator);return c.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new zt(o,r))}),t.has(ve.keyField().canonicalString())||e.ce.push(new zt(ve.keyField(),r))}return e.ce}function ft(n){let e=G(n);return e.le||(e.le=Dp(e,Nn(n))),e.le}function Dp(n,e){if(n.limitType==="F")return wu(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{let o=s.dir==="desc"?"asc":"desc";return new zt(s.field,o)});let t=n.endAt?new $t(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new $t(n.startAt.position,n.startAt.inclusive):null;return wu(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function no(n,e,t){return new jt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qu(n,e){return ia(ft(n),ft(e))&&n.limitType===e.limitType}function Ju(n){return`${ra(ft(n))}|lt:${n.limitType}`}function Dn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>Ku(s)).join(", ")}]`),ea(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Bt(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Bt(s)).join(",")),`Target(${r})`}(ft(n))}; limitType=${n.limitType})`}function sa(n,e){return e.isFoundDocument()&&function(r,s){let o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,s){for(let o of Nn(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,s){for(let o of r.filters)if(!o.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(c,l,d){let f=vu(c,l,d);return c.inclusive?f<=0:f<0}(r.startAt,Nn(r),s)||r.endAt&&!function(c,l,d){let f=vu(c,l,d);return c.inclusive?f>=0:f>0}(r.endAt,Nn(r),s))}(n,e)}function kp(n){return(e,t)=>{let r=!1;for(let s of Nn(n)){let o=Np(s,e,t);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function Np(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(o,c,l){let d=c.data.field(o),f=l.data.field(o);return d!==null&&f!==null?Ut(d,f):F()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return F()}}var tt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$n(this.inner,(t,r)=>{for(let[s,o]of r)e(s,o)})}isEmpty(){return Uu(this.inner)}size(){return this.innerSize}};var Op=new Ee(L.comparator);function jr(){return Op}var Yu=new Ee(L.comparator);function Or(...n){let e=Yu;for(let t of n)e=e.insert(t.key,t);return e}function Xu(n){let e=Yu;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function dt(){return On()}function Zu(){return On()}function On(){return new tt(n=>n.toString(),(n,e)=>n.isEqual(e))}var xp=new Ee(L.comparator),Vp=new _e(L.comparator);function fe(...n){let e=Vp;for(let t of n)e=e.add(t);return e}var Lp=new _e(z);function Mp(){return Lp}function oa(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vn(e)?"-0":e}}function el(n){return{integerValue:""+n}}function tl(n,e){return Ip(e)?el(e):oa(n,e)}var Gt=class{constructor(){this._=void 0}};function Fp(n,e,t){return n instanceof Wt?function(s,o){let c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&ta(o)&&(o=Bu(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}}(t,e):n instanceof yt?rl(n,e):n instanceof It?il(n,e):function(s,o){let c=nl(s,o),l=Au(c)+Au(s.Pe);return Ws(c)&&Ws(s.Pe)?el(l):oa(s.serializer,l)}(n,e)}function Up(n,e,t){return n instanceof yt?rl(n,e):n instanceof It?il(n,e):t}function nl(n,e){return n instanceof vt?function(r){return Ws(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Wt=class extends Gt{},yt=class extends Gt{constructor(e){super(),this.elements=e}};function rl(n,e){let t=sl(e);for(let r of n.elements)t.some(s=>Ne(s,r))||t.push(r);return{arrayValue:{values:t}}}var It=class extends Gt{constructor(e){super(),this.elements=e}};function il(n,e){let t=sl(e);for(let r of n.elements)t=t.filter(s=>!Ne(s,r));return{arrayValue:{values:t}}}var vt=class extends Gt{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Au(n){return ee(n.integerValue||n.doubleValue)}function sl(n){return na(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ro=class{constructor(e,t){this.field=e,this.transform=t}};function Bp(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof yt&&s instanceof yt||r instanceof It&&s instanceof It?Lt(r.elements,s.elements,Ne):r instanceof vt&&s instanceof vt?Ne(r.Pe,s.Pe):r instanceof Wt&&s instanceof Wt}(n.transform,e.transform)}var io=class{constructor(e,t){this.version=e,this.transformResults=t}},pt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Lr(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Kt=class{};function ol(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Gr(n.key,pt.none()):new Et(n.key,n.data,pt.none());{let t=n.data,r=Ce.empty(),s=new _e(ve.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?r.delete(o):r.set(o,c),s=s.add(o)}return new $e(n.key,r,new De(s.toArray()),pt.none())}}function qp(n,e,t){n instanceof Et?function(s,o,c){let l=s.value.clone(),d=Su(s.fieldTransforms,o,c.transformResults);l.setAll(d),o.convertToFoundDocument(c.version,l).setHasCommittedMutations()}(n,e,t):n instanceof $e?function(s,o,c){if(!Lr(s.precondition,o))return void o.convertToUnknownDocument(c.version);let l=Su(s.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(al(s)),d.setAll(l),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(n,e,t):function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function xn(n,e,t,r){return n instanceof Et?function(o,c,l,d){if(!Lr(o.precondition,c))return l;let f=o.value.clone(),E=Ru(o.fieldTransforms,d,c);return f.setAll(E),c.convertToFoundDocument(c.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof $e?function(o,c,l,d){if(!Lr(o.precondition,c))return l;let f=Ru(o.fieldTransforms,d,c),E=c.data;return E.setAll(al(o)),E.setAll(f),c.convertToFoundDocument(c.version,E).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(b=>b.field))}(n,e,t,r):function(o,c,l){return Lr(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):l}(n,e,t)}function $p(n,e){let t=null;for(let r of n.fieldTransforms){let s=e.data.field(r.field),o=nl(r.transform,s||null);o!=null&&(t===null&&(t=Ce.empty()),t.set(r.field,o))}return t||null}function bu(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Lt(r,s,(o,c)=>Bp(o,c))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Et=class extends Kt{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}},$e=class extends Kt{constructor(e,t,r,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function al(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Su(n,e,t){let r=new Map;Y(n.length===t.length);for(let s=0;s<t.length;s++){let o=n[s],c=o.transform,l=e.data.field(o.field);r.set(o.field,Up(c,l,t[s]))}return r}function Ru(n,e,t){let r=new Map;for(let s of n){let o=s.transform,c=t.data.field(s.field);r.set(s.field,Fp(o,c,e))}return r}var Gr=class extends Kt{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},so=class extends Kt{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var oo=class{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){let o=this.mutations[s];o.key.isEqual(e.key)&&qp(o,e,r[s])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=xn(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=xn(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Zu();return this.mutations.forEach(s=>{let o=e.get(s.key),c=o.overlayedDocument,l=this.applyToLocalView(c,o.mutatedFields);l=t.has(s.key)?null:l;let d=ol(c,l);d!==null&&r.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&Lt(this.mutations,e.mutations,(t,r)=>bu(t,r))&&Lt(this.baseMutations,e.baseMutations,(t,r)=>bu(t,r))}},ao=class n{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Y(e.mutations.length===r.length);let s=function(){return xp}(),o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,r[c].version);return new n(e,t,r,s)}};var co=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var X,U;function zp(n){switch(n){default:return F();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function jp(n){if(n===void 0)return gt("GRPC error has no .code"),R.UNKNOWN;switch(n){case X.OK:return R.OK;case X.CANCELLED:return R.CANCELLED;case X.UNKNOWN:return R.UNKNOWN;case X.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case X.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case X.INTERNAL:return R.INTERNAL;case X.UNAVAILABLE:return R.UNAVAILABLE;case X.UNAUTHENTICATED:return R.UNAUTHENTICATED;case X.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case X.NOT_FOUND:return R.NOT_FOUND;case X.ALREADY_EXISTS:return R.ALREADY_EXISTS;case X.PERMISSION_DENIED:return R.PERMISSION_DENIED;case X.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case X.ABORTED:return R.ABORTED;case X.OUT_OF_RANGE:return R.OUT_OF_RANGE;case X.UNIMPLEMENTED:return R.UNIMPLEMENTED;case X.DATA_LOSS:return R.DATA_LOSS;default:return F()}}(U=X||(X={}))[U.OK=0]="OK",U[U.CANCELLED=1]="CANCELLED",U[U.UNKNOWN=2]="UNKNOWN",U[U.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",U[U.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",U[U.NOT_FOUND=5]="NOT_FOUND",U[U.ALREADY_EXISTS=6]="ALREADY_EXISTS",U[U.PERMISSION_DENIED=7]="PERMISSION_DENIED",U[U.UNAUTHENTICATED=16]="UNAUTHENTICATED",U[U.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",U[U.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",U[U.ABORTED=10]="ABORTED",U[U.OUT_OF_RANGE=11]="OUT_OF_RANGE",U[U.UNIMPLEMENTED=12]="UNIMPLEMENTED",U[U.INTERNAL=13]="INTERNAL",U[U.UNAVAILABLE=14]="UNAVAILABLE",U[U.DATA_LOSS=15]="DATA_LOSS";var Z_=new As([4294967295,4294967295],0);var uo=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function lo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Wp(n,e){return lo(n,e.toTimestamp())}function Vt(n){return Y(!!n),J.fromTimestamp(function(t){let r=Ze(t);return new pe(r.seconds,r.nanos)}(n))}function cl(n,e){return ho(n,e).canonicalString()}function ho(n,e){let t=function(s){return new se(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Kp(n){let e=se.fromString(n);return Y(tm(e)),e}function fo(n,e){return cl(n.databaseId,e.path)}function Hp(n){let e=Kp(n);return e.length===4?se.emptyPath():Jp(e)}function Qp(n){return new se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Jp(n){return Y(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Pu(n,e,t){return{name:fo(n,e),fields:t.value.mapValue.fields}}function Yp(n,e){let t;if(e instanceof Et)t={update:Pu(n,e.key,e.value)};else if(e instanceof Gr)t={delete:fo(n,e.key)};else if(e instanceof $e)t={update:Pu(n,e.key,e.data),updateMask:em(e.fieldMask)};else{if(!(e instanceof so))return F();t={verify:fo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,c){let l=c.transform;if(l instanceof Wt)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof yt)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof It)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof vt)return{fieldPath:c.field.canonicalString(),increment:l.Pe};throw F()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:Wp(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:F()}(n,e.precondition)),t}function Xp(n,e){return n&&n.length>0?(Y(e!==void 0),n.map(t=>function(s,o){let c=s.updateTime?Vt(s.updateTime):Vt(o);return c.isEqual(J.min())&&(c=Vt(o)),new io(c,s.transformResults||[])}(t,e))):[]}function Zp(n){let e=Hp(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,s=null;if(r>0){Y(r===1);let E=t.from[0];E.allDescendants?s=E.collectionId:e=e.child(E.collectionId)}let o=[];t.where&&(o=function(b){let S=ul(b);return S instanceof et&&Gu(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=function(b){return b.map(S=>function(k){return new zt(Ot(k.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(S))}(t.orderBy));let l=null;t.limit&&(l=function(b){let S;return S=typeof b=="object"?b.value:b,ea(S)?null:S}(t.limit));let d=null;t.startAt&&(d=function(b){let S=!!b.before,D=b.values||[];return new $t(D,S)}(t.startAt));let f=null;return t.endAt&&(f=function(b){let S=!b.before,D=b.values||[];return new $t(D,S)}(t.endAt)),Rp(e,s,c,o,l,"F",d,f)}function ul(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ot(t.unaryFilter.field);return oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let s=Ot(t.unaryFilter.field);return oe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Ot(t.unaryFilter.field);return oe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let c=Ot(t.unaryFilter.field);return oe.create(c,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(n):n.fieldFilter!==void 0?function(t){return oe.create(Ot(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return et.create(t.compositeFilter.filters.map(r=>ul(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return F()}}(t.compositeFilter.op))}(n):F()}function Ot(n){return ve.fromServerFormat(n.fieldPath)}function em(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function tm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var po=class{constructor(e){this.ct=e}};function nm(n){let e=Zp({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?no(e,e.limit,"L"):e}var Wr=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ee(e.integerValue));else if("doubleValue"in e){let r=ee(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Vn(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ze(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Mt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?$u(e)?this.dt(t,Number.MAX_SAFE_INTEGER):qu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):F()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;let o=e.fields||{};this.dt(t,53);let c="value",l=((s=(r=o[c].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(ee(l)),this.Vt(c,t),this.Tt(o[c],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Wr.vt=new Wr;var mo=class{constructor(){this.un=new go}addToCollectionParentIndex(e,t){return this.un.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(_t.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(_t.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},go=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new _e(se.comparator),o=!s.has(r);return this.index[t]=s.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new _e(se.comparator)).toArray()}};var ey=new Uint8Array(0);var Pe=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Pe.DEFAULT_COLLECTION_PERCENTILE=10,Pe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pe.DEFAULT=new Pe(41943040,Pe.DEFAULT_COLLECTION_PERCENTILE,Pe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pe.DISABLED=new Pe(-1,0,0);var Mn=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var _o=class{constructor(){this.changes=new tt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,qt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var yo=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Io=class{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&xn(r.mutation,s,De.empty(),pe.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){let s=dt();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(o=>{let c=Or();return o.forEach((l,d)=>{c=c.insert(l,d.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){let r=dt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){let s=[];return r.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((c,l)=>{t.set(c,l)})})}computeViews(e,t,r,s){let o=jr(),c=On(),l=function(){return On()}();return t.forEach((d,f)=>{let E=r.get(f.key);s.has(f.key)&&(E===void 0||E.mutation instanceof $e)?o=o.insert(f.key,f):E!==void 0?(c.set(f.key,E.mutation.getFieldMask()),xn(E.mutation,f,E.mutation.getFieldMask(),pe.now())):c.set(f.key,De.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((f,E)=>c.set(f,E)),t.forEach((f,E)=>{var b;return l.set(f,new yo(E,(b=c.get(f))!==null&&b!==void 0?b:null))}),l))}recalculateAndSaveOverlays(e,t){let r=On(),s=new Ee((c,l)=>c-l),o=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(let l of c)l.keys().forEach(d=>{let f=t.get(d);if(f===null)return;let E=r.get(d)||De.empty();E=l.applyToLocalView(f,E),r.set(d,E);let b=(s.get(l.batchId)||fe()).add(d);s=s.insert(l.batchId,b)})}).next(()=>{let c=[],l=s.getReverseIterator();for(;l.hasNext();){let d=l.getNext(),f=d.key,E=d.value,b=Zu();E.forEach(S=>{if(!o.has(S)){let D=ol(t.get(S),r.get(S));D!==null&&b.set(S,D),o=o.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,f,b))}return P.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(c){return L.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Cp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(o=>{let c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-o.size):P.resolve(dt()),l=-1,d=o;return c.next(f=>P.forEach(f,(E,b)=>(l<b.largestBatchId&&(l=b.largestBatchId),o.get(E)?P.resolve():this.remoteDocumentCache.getEntry(e,E).next(S=>{d=d.insert(E,S)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,d,f,fe())).next(E=>({batchId:l,changes:Xu(E)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let s=Or();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){let o=t.collectionGroup,c=Or();return this.indexManager.getCollectionParents(e,o).next(l=>P.forEach(l,d=>{let f=function(b,S){return new jt(S,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,s).next(E=>{E.forEach((b,S)=>{c=c.insert(b,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,s))).next(c=>{o.forEach((d,f)=>{let E=f.getKey();c.get(E)===null&&(c=c.insert(E,qt.newInvalidDocument(E)))});let l=Or();return c.forEach((d,f)=>{let E=o.get(d);E!==void 0&&xn(E.mutation,f,De.empty(),pe.now()),sa(t,f)&&(l=l.insert(d,f))}),l})}};var vo=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return P.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Vt(s.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:nm(s.bundledQuery),readTime:Vt(s.readTime)}}(t)),P.resolve()}};var Eo=class{constructor(){this.overlays=new Ee(L.comparator),this.Ir=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=dt();return P.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,o)=>{this.ht(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let s=this.Ir.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let s=dt(),o=t.length+1,c=new L(t.child("")),l=this.overlays.getIteratorFrom(c);for(;l.hasNext();){let d=l.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>r&&s.set(d.getKey(),d)}return P.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let o=new Ee((f,E)=>f-E),c=this.overlays.getIterator();for(;c.hasNext();){let f=c.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let E=o.get(f.largestBatchId);E===null&&(E=dt(),o=o.insert(f.largestBatchId,E)),E.set(f.getKey(),f)}}let l=dt(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,E)=>l.set(f,E)),!(l.size()>=s)););return P.resolve(l)}ht(e,t,r){let s=this.overlays.get(r.key);if(s!==null){let c=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new co(t,r));let o=this.Ir.get(t);o===void 0&&(o=fe(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var wo=class{constructor(){this.sessionToken=qe.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Fn=class{constructor(){this.Tr=new _e(Z.Er),this.dr=new _e(Z.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Z(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Z(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new se([])),r=new Z(t,e),s=new Z(t,e+1),o=[];return this.dr.forEachInRange([r,s],c=>{this.Vr(c),o.push(c.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new se([])),r=new Z(t,e),s=new Z(t,e+1),o=fe();return this.dr.forEachInRange([r,s],c=>{o=o.add(c.key)}),o}containsKey(e){let t=new Z(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Z=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||z(e.wr,t.wr)}static Ar(e,t){return z(e.wr,t.wr)||L.comparator(e.key,t.key)}};var To=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new _e(Z.Er)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let c=new oo(o,t,r,s);this.mutationQueue.push(c);for(let l of s)this.br=this.br.add(new Z(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return P.resolve(c)}lookupMutationBatch(e,t){return P.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,s=this.vr(r),o=s<0?0:s;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Z(t,0),s=new Z(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,s],c=>{let l=this.Dr(c.wr);o.push(l)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new _e(z);return t.forEach(s=>{let o=new Z(s,0),c=new Z(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],l=>{r=r.add(l.wr)})}),P.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,s=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let c=new Z(new L(o),0),l=new _e(z);return this.br.forEachWhile(d=>{let f=d.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(l=l.add(d.wr)),!0)},c),P.resolve(this.Cr(l))}Cr(e){let t=[];return e.forEach(r=>{let s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Y(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return P.forEach(t.mutations,s=>{let o=new Z(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Z(t,0),s=this.br.firstAfterOrEqual(r);return P.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ao=class{constructor(e){this.Mr=e,this.docs=function(){return new Ee(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,s=this.docs.get(r),o=s?s.size:0,c=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():qt.newInvalidDocument(t))}getEntries(e,t){let r=jr();return t.forEach(s=>{let o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():qt.newInvalidDocument(s))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let o=jr(),c=t.path,l=new L(c.child("")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){let{key:f,value:{document:E}}=d.getNext();if(!c.isPrefixOf(f.path))break;f.path.length>c.length+1||mp(pp(E),r)<=0||(s.has(E.key)||sa(t,E))&&(o=o.insert(E.key,E.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,s){F()}Or(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new bo(this)}getSize(e){return P.resolve(this.size)}},bo=class extends _o{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var So=class{constructor(e){this.persistence=e,this.Nr=new tt(t=>ra(t),ia),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Fn,this.targetCount=0,this.kr=Mn.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),P.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Mn(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Kn(t),P.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let s=0,o=[];return this.Nr.forEach((c,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),P.waitFor(o).next(()=>s)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(c=>{o.push(s.markPotentiallyOrphaned(e,c))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Br.containsKey(t))}};var Ro=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new yp(0),this.Kr=!1,this.Kr=!0,this.$r=new wo,this.referenceDelegate=e(this),this.Ur=new So(this),this.indexManager=new mo,this.remoteDocumentCache=function(s){return new Ao(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new po(t),this.Gr=new vo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Eo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new To(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);let s=new Po(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(o=>this.referenceDelegate.jr(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Hr(e,t){return P.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Po=class extends qs{constructor(e){super(),this.currentSequenceNumber=e}},Co=class n{constructor(e){this.persistence=e,this.Jr=new Fn,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw F()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),P.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Xr,r=>{let s=L.fromPath(r);return this.ei(e,s).next(o=>{o||t.removeEntry(s,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return P.or([()=>P.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Do=class n{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=fe(),s=fe();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new n(e,t.fromCache,r,s)}};var ko=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var No=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Nc()?8:_p(Ie())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){let o={result:null};return this.Yi(e,t).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.Zi(e,t,s,r).next(c=>{o.result=c})}).next(()=>{if(o.result)return;let c=new ko;return this.Xi(e,t,c).next(l=>{if(o.result=l,this.zi)return this.es(e,t,c,l.size)})}).next(()=>o.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Cn()<=M.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Dn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),P.resolve()):(Cn()<=M.DEBUG&&N("QueryEngine","Query:",Dn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Cn()<=M.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Dn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ft(t))):P.resolve())}Yi(e,t){if(Tu(t))return P.resolve(null);let r=ft(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=no(t,null,"F"),r=ft(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let c=fe(...o);return this.Ji.getDocuments(e,c).next(l=>this.indexManager.getMinOffset(e,r).next(d=>{let f=this.ts(t,l);return this.ns(t,f,c,d.readTime)?this.Yi(e,no(t,null,"F")):this.rs(e,f,t,d)}))})))}Zi(e,t,r,s){return Tu(t)||s.isEqual(J.min())?P.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let c=this.ts(t,o);return this.ns(t,c,r,s)?P.resolve(null):(Cn()<=M.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Dn(t)),this.rs(e,c,t,fp(s,-1)).next(l=>l))})}ts(e,t){let r=new _e(kp(e));return t.forEach((s,o)=>{sa(e,o)&&(r=r.add(o))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,t,r){return Cn()<=M.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Dn(t)),this.Ji.getDocumentsMatchingQuery(e,t,_t.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(o=>(t.forEach(c=>{o=o.insert(c.key,c)}),o))}};var Oo=class{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Ee(z),this._s=new tt(o=>ra(o),ia),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Io(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function rm(n,e,t,r){return new Oo(n,e,t,r)}function ll(n,e){return A(this,null,function*(){let t=G(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let c=[],l=[],d=fe();for(let f of s){c.push(f.batchId);for(let E of f.mutations)d=d.add(E.key)}for(let f of o){l.push(f.batchId);for(let E of f.mutations)d=d.add(E.key)}return t.localDocuments.getDocuments(r,d).next(f=>({hs:f,removedBatchIds:c,addedBatchIds:l}))})})})}function im(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let s=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,d,f,E){let b=f.batch,S=b.keys(),D=P.resolve();return S.forEach(k=>{D=D.next(()=>E.getEntry(d,k)).next(V=>{let O=f.docVersions.get(k);Y(O!==null),V.version.compareTo(O)<0&&(b.applyToRemoteDocument(V,f),V.isValidDocument()&&(V.setReadTime(f.commitVersion),E.addEntry(V)))})}),D.next(()=>l.mutationQueue.removeMutationBatch(d,b))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let d=fe();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(d=d.add(l.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function sm(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function om(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var Kr=class{constructor(){this.activeTargetIds=Mp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var xo=class{constructor(){this.so=new Kr,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Kr,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Vo=class{_o(e){}shutdown(){}};var Hr=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var xr=null;function Ds(){return xr===null?xr=function(){return 268435456+Math.round(2147483648*Math.random())}():xr++,"0x"+xr.toString(16)}var am={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Lo=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var de="WebChannelConnection",Mo=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(t,r,s,o,c){let l=Ds(),d=this.xo(t,r.toUriEncodedString());N("RestConnection",`Sending RPC '${t}' ${l}:`,d,s);let f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,o,c),this.No(t,d,f,s).then(E=>(N("RestConnection",`Received RPC '${t}' ${l}: `,E),E),E=>{throw Mr("RestConnection",`RPC '${t}' ${l} failed with error: `,E,"url: ",d,"request:",s),E})}Lo(t,r,s,o,c,l){return this.Mo(t,r,s,o,c)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ht}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,c)=>t[c]=o),s&&s.headers.forEach((o,c)=>t[c]=o)}xo(t,r){let s=am[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){let o=Ds();return new Promise((c,l)=>{let d=new bs;d.setWithCredentials(!0),d.listenOnce(Ss.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Pn.NO_ERROR:let E=d.getResponseJson();N(de,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(E)),c(E);break;case Pn.TIMEOUT:N(de,`RPC '${e}' ${o} timed out`),l(new x(R.DEADLINE_EXCEEDED,"Request time out"));break;case Pn.HTTP_ERROR:let b=d.getStatus();if(N(de,`RPC '${e}' ${o} failed with status:`,b,"response text:",d.getResponseText()),b>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let D=S?.error;if(D&&D.status&&D.message){let k=function(O){let W=O.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(W)>=0?W:R.UNKNOWN}(D.status);l(new x(k,D.message))}else l(new x(R.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new x(R.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{N(de,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(s);N(de,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",f,r,15)})}Bo(e,t,r){let s=Ds(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Cs(),l=Ps(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;let E=o.join("");N(de,`Creating RPC '${e}' stream ${s}: ${E}`,d);let b=c.createWebChannel(E,d),S=!1,D=!1,k=new Lo({Io:O=>{D?N(de,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(S||(N(de,`Opening RPC '${e}' stream ${s} transport.`),b.open(),S=!0),N(de,`RPC '${e}' stream ${s} sending:`,O),b.send(O))},To:()=>b.close()}),V=(O,W,j)=>{O.listen(W,K=>{try{j(K)}catch(te){setTimeout(()=>{throw te},0)}})};return V(b,Nt.EventType.OPEN,()=>{D||(N(de,`RPC '${e}' stream ${s} transport opened.`),k.yo())}),V(b,Nt.EventType.CLOSE,()=>{D||(D=!0,N(de,`RPC '${e}' stream ${s} transport closed`),k.So())}),V(b,Nt.EventType.ERROR,O=>{D||(D=!0,Mr(de,`RPC '${e}' stream ${s} transport errored:`,O),k.So(new x(R.UNAVAILABLE,"The operation could not be completed")))}),V(b,Nt.EventType.MESSAGE,O=>{var W;if(!D){let j=O.data[0];Y(!!j);let K=j,te=K.error||((W=K[0])===null||W===void 0?void 0:W.error);if(te){N(de,`RPC '${e}' stream ${s} received error:`,te);let be=te.status,ne=function(g){let _=X[g];if(_!==void 0)return jp(_)}(be),I=te.message;ne===void 0&&(ne=R.INTERNAL,I="Unknown error status: "+be+" with message "+te.message),D=!0,k.So(new x(ne,I)),b.close()}else N(de,`RPC '${e}' stream ${s} received:`,j),k.bo(j)}}),V(l,Rs.STAT_EVENT,O=>{O.stat===kr.PROXY?N(de,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===kr.NOPROXY&&N(de,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}};function ks(){return typeof document<"u"?document:null}function si(n){return new uo(n,!0)}var Qr=class{constructor(e,t,r=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&N("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Fo=class{constructor(e,t,r,s,o,c,l,d){this.ui=e,this.Ho=r,this.Jo=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Qr(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return A(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return A(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return A(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(gt(t.toString()),gt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{let s=new x(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(()=>A(this,null,function*(){this.state=0,this.start()}))}I_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var Uo=class extends Fo{constructor(e,t,r,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Xp(e.writeResults,e.commitTime),r=Vt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Qp(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Yp(this.serializer,r))};this.a_(t)}};var Bo=class extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Mo(e,ho(t,r),s,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(R.UNKNOWN,o.toString())})}Lo(e,t,r,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,l])=>this.connection.Lo(e,ho(t,r),s,c,l,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new x(R.UNKNOWN,c.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},qo=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(gt(t),this.D_=!1):N("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var $o=class{constructor(e,t,r,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(c=>{r.enqueueAndForget(()=>A(this,null,function*(){jn(this)&&(N("RemoteStore","Restarting streams for network reachability change."),yield function(d){return A(this,null,function*(){let f=G(d);f.L_.add(4),yield zn(f),f.q_.set("Unknown"),f.L_.delete(4),yield oi(f)})}(this))}))}),this.q_=new qo(r,s)}};function oi(n){return A(this,null,function*(){if(jn(n))for(let e of n.B_)yield e(!0)})}function zn(n){return A(this,null,function*(){for(let e of n.B_)yield e(!1)})}function jn(n){return G(n).L_.size===0}function hl(n,e,t){return A(this,null,function*(){if(!ii(e))throw e;n.L_.add(1),yield zn(n),n.q_.set("Offline"),t||(t=()=>sm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>A(this,null,function*(){N("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield oi(n)}))})}function dl(n,e){return e().catch(t=>hl(n,t,e))}function ai(n){return A(this,null,function*(){let e=G(n),t=nt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cm(e);)try{let s=yield om(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,um(e,s)}catch(s){yield hl(e,s)}fl(e)&&pl(e)})}function cm(n){return jn(n)&&n.O_.length<10}function um(n,e){n.O_.push(e);let t=nt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function fl(n){return jn(n)&&!nt(n).n_()&&n.O_.length>0}function pl(n){nt(n).start()}function lm(n){return A(this,null,function*(){nt(n).p_()})}function hm(n){return A(this,null,function*(){let e=nt(n);for(let t of n.O_)e.m_(t.mutations)})}function dm(n,e,t){return A(this,null,function*(){let r=n.O_.shift(),s=ao.from(r,e,t);yield dl(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield ai(n)})}function fm(n,e){return A(this,null,function*(){e&&nt(n).V_&&(yield function(r,s){return A(this,null,function*(){if(function(c){return zp(c)&&c!==R.ABORTED}(s.code)){let o=r.O_.shift();nt(r).s_(),yield dl(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield ai(r)}})}(n,e)),fl(n)&&pl(n)})}function Cu(n,e){return A(this,null,function*(){let t=G(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");let r=jn(t);t.L_.add(3),yield zn(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield oi(t)})}function pm(n,e){return A(this,null,function*(){let t=G(n);e?(t.L_.delete(2),yield oi(t)):e||(t.L_.add(2),yield zn(t),t.q_.set("Unknown"))})}function nt(n){return n.U_||(n.U_=function(t,r,s){let o=G(t);return o.w_(),new Uo(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lm.bind(null,n),mo:fm.bind(null,n),f_:hm.bind(null,n),g_:dm.bind(null,n)}),n.B_.push(e=>A(this,null,function*(){e?(n.U_.s_(),yield ai(n)):(yield n.U_.stop(),n.O_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var zo=class n{constructor(e,t,r,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Ue,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,o){let c=Date.now()+r,l=new n(e,t,c,s,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ml(n,e){if(gt("AsyncQueue",`${e}: ${n}`),ii(n))return new x(R.UNAVAILABLE,`${e}: ${n}`);throw n}var jo=class{constructor(){this.queries=Du(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let s=G(t),o=s.queries;s.queries=Du(),o.forEach((c,l)=>{for(let d of l.j_)d.onError(r)})})(this,new x(R.ABORTED,"Firestore shutting down"))}};function Du(){return new tt(n=>Ju(n),Qu)}function mm(n){n.Y_.forEach(e=>{e.next()})}var ku,Nu;(Nu=ku||(ku={})).ea="default",Nu.Cache="cache";var Go=class{constructor(e,t,r,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new tt(l=>Ju(l),Qu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ee(L.comparator),this.Na=new Map,this.La=new Fn,this.Ba={},this.ka=new Map,this.qa=Mn.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function gm(n,e,t){return A(this,null,function*(){let r=vm(n);try{let s=yield function(c,l){let d=G(c),f=pe.now(),E=l.reduce((D,k)=>D.add(k.key),fe()),b,S;return d.persistence.runTransaction("Locally write mutations","readwrite",D=>{let k=jr(),V=fe();return d.cs.getEntries(D,E).next(O=>{k=O,k.forEach((W,j)=>{j.isValidDocument()||(V=V.add(W))})}).next(()=>d.localDocuments.getOverlayedDocuments(D,k)).next(O=>{b=O;let W=[];for(let j of l){let K=$p(j,b.get(j.key).overlayedDocument);K!=null&&W.push(new $e(j.key,K,zu(K.value.mapValue),pt.exists(!0)))}return d.mutationQueue.addMutationBatch(D,f,W,l)}).next(O=>{S=O;let W=O.applyToLocalDocumentSet(b,V);return d.documentOverlayCache.saveOverlays(D,O.batchId,W)})}).then(()=>({batchId:S.batchId,changes:Xu(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(c,l,d){let f=c.Ba[c.currentUser.toKey()];f||(f=new Ee(z)),f=f.insert(l,d),c.Ba[c.currentUser.toKey()]=f}(r,s.batchId,t),yield ci(r,s.changes),yield ai(r.remoteStore)}catch(s){let o=ml(s,"Failed to persist write");t.reject(o)}})}function Ou(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let s=[];r.Fa.forEach((o,c)=>{let l=c.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(c,l){let d=G(c);d.onlineState=l;let f=!1;d.queries.forEach((E,b)=>{for(let S of b.j_)S.Z_(l)&&(f=!0)}),f&&mm(d)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function _m(n,e){return A(this,null,function*(){let t=G(n),r=e.batch.batchId;try{let s=yield im(t.localStore,e);_l(t,r,null),gl(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ci(t,s)}catch(s){yield Fu(s)}})}function ym(n,e,t){return A(this,null,function*(){let r=G(n);try{let s=yield function(c,l){let d=G(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let E;return d.mutationQueue.lookupMutationBatch(f,l).next(b=>(Y(b!==null),E=b.keys(),d.mutationQueue.removeMutationBatch(f,b))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,E,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,E)).next(()=>d.localDocuments.getDocuments(f,E))})}(r.localStore,e);_l(r,e,t),gl(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ci(r,s)}catch(s){yield Fu(s)}})}function gl(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function _l(n,e,t){let r=G(n),s=r.Ba[r.currentUser.toKey()];if(s){let o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function ci(n,e,t){return A(this,null,function*(){let r=G(n),s=[],o=[],c=[];r.Fa.isEmpty()||(r.Fa.forEach((l,d)=>{c.push(r.Ka(d,e,t).then(f=>{var E;if((f||t)&&r.isPrimaryClient){let b=f?!f.fromCache:(E=t?.targetChanges.get(d.targetId))===null||E===void 0?void 0:E.current;r.sharedClientState.updateQueryState(d.targetId,b?"current":"not-current")}if(f){s.push(f);let b=Do.Wi(d.targetId,f);o.push(b)}}))}),yield Promise.all(c),r.Ca.d_(s),yield function(d,f){return A(this,null,function*(){let E=G(d);try{yield E.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>P.forEach(f,S=>P.forEach(S.$i,D=>E.persistence.referenceDelegate.addReference(b,S.targetId,D)).next(()=>P.forEach(S.Ui,D=>E.persistence.referenceDelegate.removeReference(b,S.targetId,D)))))}catch(b){if(!ii(b))throw b;N("LocalStore","Failed to update sequence numbers: "+b)}for(let b of f){let S=b.targetId;if(!b.fromCache){let D=E.os.get(S),k=D.snapshotVersion,V=D.withLastLimboFreeSnapshotVersion(k);E.os=E.os.insert(S,V)}}})}(r.localStore,o))})}function Im(n,e){return A(this,null,function*(){let t=G(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());let r=yield ll(t.localStore,e);t.currentUser=e,function(o,c){o.ka.forEach(l=>{l.forEach(d=>{d.reject(new x(R.CANCELLED,c))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ci(t,r.hs)}})}function vm(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_m.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ym.bind(null,e),e}var xu=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return A(this,null,function*(){this.serializer=si(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return rm(this.persistence,new No,t.initialUser,this.serializer)}Ga(t){return new Ro(Co.Zr,this.serializer)}Wa(t){return new xo}terminate(){return A(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Em=(()=>{class n{initialize(t,r){return A(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Ou(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Im.bind(null,this.syncEngine),yield pm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new jo}()}createDatastore(t){let r=si(t.databaseInfo.databaseId),s=function(c){return new Mo(c)}(t.databaseInfo);return function(c,l,d,f){return new Bo(c,l,d,f)}(t.authCredentials,t.appCheckCredentials,s,r)}createRemoteStore(t){return function(s,o,c,l,d){return new $o(s,o,c,l,d)}(this.localStore,this.datastore,t.asyncQueue,r=>Ou(this.syncEngine,r,0),function(){return Hr.D()?new Hr:new Vo}())}createSyncEngine(t,r){return function(o,c,l,d,f,E,b){let S=new Go(o,c,l,d,f,E);return b&&(S.Qa=!0),S}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return A(this,null,function*(){var t,r;yield function(o){return A(this,null,function*(){let c=G(o);N("RemoteStore","RemoteStore shutting down."),c.L_.add(5),yield zn(c),c.k_.shutdown(),c.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Wo=class{constructor(e,t,r,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=ie.UNAUTHENTICATED,this.clientId=Ur.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,c=>A(this,null,function*(){N("FirestoreClient","Received user=",c.uid),yield this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,c=>(N("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ue;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>A(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ml(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ns(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(s=>A(this,null,function*(){r.isEqual(s)||(yield ll(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Vu(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield wm(n);N("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Cu(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Cu(e.remoteStore,s)),n._onlineComponents=e})}function wm(n){return A(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ns(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(s){return s.name==="FirebaseError"?s.code===R.FAILED_PRECONDITION||s.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Mr("Error using user provided cache. Falling back to memory cache: "+t),yield Ns(n,new xu)}}else N("FirestoreClient","Using default OfflineComponentProvider"),yield Ns(n,new xu);return n._offlineComponents})}function Tm(n){return A(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),yield Vu(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),yield Vu(n,new Em))),n._onlineComponents})}function Am(n){return Tm(n).then(e=>e.syncEngine)}function yl(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Lu=new Map;function bm(n,e,t){if(!t)throw new x(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Sm(n,e,t,r){if(e===!0&&r===!0)throw new x(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Mu(n){if(!L.isDocumentKey(n))throw new x(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function aa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":F()}function Ko(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=aa(n);throw new x(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Jr=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Sm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yl((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Un=class{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jr({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jr(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Os;switch(r.type){case"firstParty":return new Ms(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return A(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Lu.get(t);r&&(N("ComponentProvider","Removing Datastore"),Lu.delete(t),r.terminate())}(this),Promise.resolve()}};function Il(n,e,t,r={}){var s;let o=(n=Ko(n,Un))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&Mr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),r.mockUserToken){let l,d;if(typeof r.mockUserToken=="string")l=r.mockUserToken,d=ie.MOCK_USER;else{l=Rc(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new x(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ie(f)}n._authCredentials=new xs(new Fr(l,d))}}var Ho=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Bn=class n extends Ho{constructor(e,t,r){super(e,t,Pp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function vl(n,e,...t){if(n=Se(n),arguments.length===1&&(e=Ur.newId()),bm("doc","path",e),n instanceof Un){let r=se.fromString(e,...t);return Mu(r),new Be(n,null,new L(r))}{if(!(n instanceof Be||n instanceof Bn))throw new x(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(se.fromString(e,...t));return Mu(r),new Be(n.firestore,n instanceof Bn?n.converter:null,new L(r))}}var Yr=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Qr(this,"async_queue_retry"),this.Vu=()=>{let r=ks();r&&N("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=ks();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=ks();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Ue;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return A(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ii(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let s=function(c){let l=c.message||"";return c.stack&&(l=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),l}(r);throw gt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let s=zo.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(s),s}fu(){this.Eu&&F()}verifyOperationInProgress(){}wu(){return A(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};var Xr=class extends Un{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Yr,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return A(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Yr(e),this._firestoreClient=void 0,yield e}})}};function El(n,e){let t=typeof n=="object"?n:yn(),r=typeof n=="string"?n:e||"(default)",s=ss(t,"firestore").getImmediate({identifier:r});if(!s._initialized){let o=bc("firestore");o&&Il(s,...o)}return s}function Rm(n){if(n._terminated)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Pm(n),n._firestoreClient}function Pm(n){var e,t,r;let s=n._freezeSettings(),o=function(l,d,f,E){return new zs(l,d,f,E.host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,yl(E.experimentalLongPollingOptions),E.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new Wo(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(l){let d=l?._online.build();return{_offline:l?._offline.build(d),_online:d}}(n._componentsProvider))}var Zr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(qe.fromBase64String(e))}catch(t){throw new x(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ei=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var qn=class{constructor(e){this._methodName=e}};var ti=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return z(this._lat,e._lat)||z(this._long,e._long)}};var ni=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0}(this._values,e._values)}};var Cm=/^__.*__$/,Qo=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new $e(e,this.data,this.fieldMask,t,this.fieldTransforms):new Et(e,this.data,t,this.fieldTransforms)}};function wl(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}var Jo=class n{constructor(e,t,r,s,o,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ri(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(wl(this.Cu)&&Cm.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Yo=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||si(e)}Qu(e,t,r,s=!1){return new Jo({Cu:e,methodName:t,qu:r,path:ve.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Dm(n){let e=n._freezeSettings(),t=si(n._databaseId);return new Yo(n._databaseId,!!e.ignoreUndefinedProperties,t)}function km(n,e,t,r,s,o={}){let c=n.Qu(o.merge||o.mergeFields?2:0,e,t,s);Sl("Data must be an object, but it was:",c,r);let l=Al(r,c),d,f;if(o.merge)d=new De(c.fieldMask),f=c.fieldTransforms;else if(o.mergeFields){let E=[];for(let b of o.mergeFields){let S=Nm(e,b,t);if(!c.contains(S))throw new x(R.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);Vm(E,S)||E.push(S)}d=new De(E),f=c.fieldTransforms.filter(b=>d.covers(b.field))}else d=null,f=c.fieldTransforms;return new Qo(new Ce(l),d,f)}var Xo=class n extends qn{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new vt(e.serializer,tl(e.serializer,this.$u));return new ro(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function Tl(n,e){if(bl(n=Se(n)))return Sl("Unsupported field value:",e,n),Al(n,e);if(n instanceof qn)return function(r,s){if(!wl(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){let o=[],c=0;for(let l of r){let d=Tl(l,s.Lu(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}}(n,e)}return function(r,s){if((r=Se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return tl(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=pe.fromDate(r);return{timestampValue:lo(s.serializer,o)}}if(r instanceof pe){let o=new pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lo(s.serializer,o)}}if(r instanceof ti)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zr)return{bytesValue:Gp(s.serializer,r._byteString)};if(r instanceof Be){let o=s.databaseId,c=r.firestore._databaseId;if(!c.isEqual(o))throw s.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:cl(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ni)return function(c,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map(d=>{if(typeof d!="number")throw l.Bu("VectorValues must only contain numeric values.");return oa(l.serializer,d)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${aa(r)}`)}(n,e)}function Al(n,e){let t={};return Uu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$n(n,(r,s)=>{let o=Tl(s,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function bl(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pe||n instanceof ti||n instanceof Zr||n instanceof Be||n instanceof qn||n instanceof ni)}function Sl(n,e,t){if(!bl(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){let r=aa(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Nm(n,e,t){if((e=Se(e))instanceof ei)return e._internalPath;if(typeof e=="string")return xm(n,e);throw ri("Field path arguments must be of type string or ",n,!1,void 0,t)}var Om=new RegExp("[~\\*/\\[\\]]");function xm(n,e,t){if(e.search(Om)>=0)throw ri(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ei(...e.split("."))._internalPath}catch{throw ri(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ri(n,e,t,r,s){let o=r&&!r.isEmpty(),c=s!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${r}`),c&&(d+=` in document ${s}`),d+=")"),new x(R.INVALID_ARGUMENT,l+n+d)}function Vm(n,e){return n.some(t=>t.isEqual(e))}function Lm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function Rl(n,e,t){n=Ko(n,Be);let r=Ko(n.firestore,Xr),s=Lm(n.converter,e,t);return Mm(r,[km(Dm(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,pt.none())])}function Mm(n,e){return function(r,s){let o=new Ue;return r.asyncQueue.enqueueAndForget(()=>A(this,null,function*(){return gm(yield Am(r),s,o)})),o.promise}(Rm(n),e)}function Pl(n){return new Xo("increment",n)}(function(e,t=!0){(function(s){Ht=s})(Ct),Je(new Te("firestore",(r,{instanceIdentifier:s,options:o})=>{let c=r.getProvider("app").getImmediate(),l=new Xr(new Vs(r.getProvider("auth-internal")),new Us(r.getProvider("app-check-internal")),function(f,E){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new x(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new js(f.options.projectId,E)}(c,s),c);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),re(gu,"4.7.3",e),re(gu,"4.7.3","esm2017")})();var Gn=class{constructor(e){return e}},Cl="firestore",ca=class{constructor(){return vn(Cl)}};var ua=new ur("angularfire2.firestore-instances");function Fm(n,e){let t=cs(Cl,n,e);return t&&new Gn(t)}function Um(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Gn(r)}}var Bm={provide:ca,deps:[[new Ke,ua]]},qm={provide:Gn,useFactory:Fm,deps:[[new Ke,ua],ut]};function TI(n,...e){return re("angularfire",kt.full,"fst"),lr([qm,Bm,{provide:ua,useFactory:Um(n),multi:!0,deps:[St,hr,En,wn,[new Ke,Cr],[new Ke,In],...e]}])}var AI=Ye(vl,!0);var bI=Ye(El,!0);var SI=Ye(Pl,!0);var RI=Ye(Rl,!0);export{Cg as a,Dg as b,Gn as c,TI as d,AI as e,bI as f,SI as g,RI as h};

import{g as Gh}from"./chunk-GAGUUXVT.js";import{$ as le,$a as Ge,A as Ne,Aa as jt,Ac as qh,B as _r,Ba as Ih,Bb as Dh,Bc as vr,C as ch,Ca as _n,Cc as Bh,D as Lo,Da as ut,Dc as jh,Ec as Ir,Fa as Bo,Fb as kh,Hb as Nh,I as Bt,Ib as Oh,J as fn,Ja as wh,K as pn,L as Fo,M as gn,N as uh,Q as Li,R as St,S as Uo,Sb as xh,T as lh,Vc as zh,W as hh,Wa as Eh,X as dh,Y as je,Z as fh,a as x,aa as Ce,ab as Th,b as Re,ca as ce,d as b,da as ph,dc as Go,ea as gh,eb as jo,ec as Vh,fa as _e,fb as Ah,fc as Mh,g as nh,ga as $o,gc as Lh,h as rh,ha as ze,hc as Wo,i as ko,ia as F,ic as Ko,j as No,ja as Qe,jb as Sh,jc as Fh,k as Oo,ka as mh,kb as bh,kc as $i,l as Tt,lb as zo,m as Fe,ma as _h,n as ih,na as yh,nb as Rh,nc as qi,o as sh,oa as Fi,ob as Ch,p as At,q as xo,qa as mn,qc as Bi,r as Vo,s as Mo,sa as yr,t as De,ta as Je,u as L,ua as Ui,v as mr,vc as Uh,w as oh,wb as Ph,x as ah,y as X,ya as qo,z as Mi,za as vh,zc as $h}from"./chunk-BXU37XCI.js";var U="primary",Vr=Symbol("RouteTitle"),Xo=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Tn(n){return new Xo(n)}function Dg(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let a=r[o],u=n[o];if(a[0]===":")i[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function kg(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ye(n[t],e[t]))return!1;return!0}function Ye(n,e){let t=n?Zo(n):void 0,r=e?Zo(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!rd(n[i],e[i]))return!1;return!0}function Zo(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function rd(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function id(n){return n.length>0?n[n.length-1]:null}function Ct(n){return oh(n)?n:Lh(n)?De(Promise.resolve(n)):L(n)}var Ng={exact:od,subset:ad},sd={exact:Og,subset:xg,ignored:()=>!0};function Wh(n,e,t){return Ng[t.paths](n.root,e.root,t.matrixParams)&&sd[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Og(n,e){return Ye(n,e)}function od(n,e,t){if(!Gt(n.segments,e.segments)||!Gi(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!od(n.children[r],e.children[r],t))return!1;return!0}function xg(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>rd(n[t],e[t]))}function ad(n,e,t){return cd(n,e,e.segments,t)}function cd(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Gt(i,t)||e.hasChildren()||!Gi(i,t,r))}else if(n.segments.length===t.length){if(!Gt(n.segments,t)||!Gi(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!ad(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Gt(n.segments,i)||!Gi(n.segments,i,r)||!n.children[U]?!1:cd(n.children[U],e,o,r)}}function Gi(n,e,t){return e.every((r,i)=>sd[t](n[i].parameters,r.parameters))}var ht=class{constructor(e=new H([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Tn(this.queryParams),this._queryParamMap}toString(){return Lg.serialize(this)}},H=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wi(this)}},zt=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Tn(this.parameters),this._parameterMap}toString(){return ld(this)}};function Vg(n,e){return Gt(n,e)&&n.every((t,r)=>Ye(t.parameters,e[r].parameters))}function Gt(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Mg(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===U&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==U&&(t=t.concat(e(i,r)))}),t}var Mr=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:()=>new An,providedIn:"root"})}}return n})(),An=class{parse(e){let t=new ta(e);return new ht(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${wr(e.root,!0)}`,r=$g(e.queryParams),i=typeof e.fragment=="string"?`#${Fg(e.fragment)}`:"";return`${t}${r}${i}`}},Lg=new An;function Wi(n){return n.segments.map(e=>ld(e)).join("/")}function wr(n,e){if(!n.hasChildren())return Wi(n);if(e){let t=n.children[U]?wr(n.children[U],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==U&&r.push(`${i}:${wr(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Mg(n,(r,i)=>i===U?[wr(n.children[U],!1)]:[`${i}:${wr(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[U]!=null?`${Wi(n)}/${t[0]}`:`${Wi(n)}/(${t.join("//")})`}}function ud(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ji(n){return ud(n).replace(/%3B/gi,";")}function Fg(n){return encodeURI(n)}function ea(n){return ud(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ki(n){return decodeURIComponent(n)}function Kh(n){return Ki(n.replace(/\+/g,"%20"))}function ld(n){return`${ea(n.path)}${Ug(n.parameters)}`}function Ug(n){return Object.entries(n).map(([e,t])=>`;${ea(e)}=${ea(t)}`).join("")}function $g(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ji(t)}=${ji(i)}`).join("&"):`${ji(t)}=${ji(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var qg=/^[^\/()?;#]+/;function Ho(n){let e=n.match(qg);return e?e[0]:""}var Bg=/^[^\/()?;=#]+/;function jg(n){let e=n.match(Bg);return e?e[0]:""}var zg=/^[^=?&#]+/;function Gg(n){let e=n.match(zg);return e?e[0]:""}var Wg=/^[^&#]+/;function Kg(n){let e=n.match(Wg);return e?e[0]:""}var ta=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new H([],{}):new H([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[U]=new H(e,t)),r}parseSegment(){let e=Ho(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Ce(4009,!1);return this.capture(e),new zt(Ki(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=jg(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Ho(this.remaining);i&&(r=i,this.capture(r))}e[Ki(t)]=Ki(r)}parseQueryParam(e){let t=Gg(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=Kg(this.remaining);a&&(r=a,this.capture(r))}let i=Kh(t),o=Kh(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ho(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Ce(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=U);let a=this.parseChildren();t[o]=Object.keys(a).length===1?a[U]:new H([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Ce(4011,!1)}};function hd(n){return n.segments.length>0?new H([],{[U]:n}):n}function dd(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=dd(i);if(r===U&&o.segments.length===0&&o.hasChildren())for(let[a,u]of Object.entries(o.children))e[a]=u;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new H(n.segments,e);return Hg(t)}function Hg(n){if(n.numberOfChildren===1&&n.children[U]){let e=n.children[U];return new H(n.segments.concat(e.segments),e.children)}return n}function Wt(n){return n instanceof ht}function Qg(n,e,t=null,r=null){let i=fd(n);return pd(i,e,t,r)}function fd(n){let e;function t(o){let a={};for(let l of o.children){let f=t(l);a[l.outlet]=f}let u=new H(o.url,a);return o===n&&(e=u),u}let r=t(n.root),i=hd(r);return e??i}function pd(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Qo(i,i,i,t,r);let o=Jg(e);if(o.toRoot())return Qo(i,i,new H([],{}),t,r);let a=Yg(o,i,n),u=a.processChildren?Ar(a.segmentGroup,a.index,o.commands):md(a.segmentGroup,a.index,o.commands);return Qo(i,a.segmentGroup,u,t,r)}function Hi(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Rr(n){return typeof n=="object"&&n!=null&&n.outlets}function Qo(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([l,f])=>{o[l]=Array.isArray(f)?f.map(_=>`${_}`):`${f}`});let a;n===e?a=t:a=gd(n,e,t);let u=hd(dd(a));return new ht(u,o,i)}function gd(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=gd(o,e,t)}),new H(n.segments,r)}var Qi=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Hi(r[0]))throw new Ce(4003,!1);let i=r.find(Rr);if(i&&i!==id(r))throw new Ce(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Jg(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Qi(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,a)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let u={};return Object.entries(o.outlets).forEach(([l,f])=>{u[l]=typeof f=="string"?f.split("/"):f}),[...i,{outlets:u}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:a===0?(o.split("/").forEach((u,l)=>{l==0&&u==="."||(l==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,o]},[]);return new Qi(t,e,r)}var In=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Yg(n,e,t){if(n.isAbsolute)return new In(e,!0,0);if(!t)return new In(e,!1,NaN);if(t.parent===null)return new In(t,!0,0);let r=Hi(n.commands[0])?0:1,i=t.segments.length-1+r;return Xg(t,i,n.numberOfDoubleDots)}function Xg(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Ce(4005,!1);i=r.segments.length}return new In(r,!1,i-o)}function Zg(n){return Rr(n[0])?n[0].outlets:{[U]:n}}function md(n,e,t){if(n??=new H([],{}),n.segments.length===0&&n.hasChildren())return Ar(n,e,t);let r=em(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new H(n.segments.slice(0,r.pathIndex),{});return o.children[U]=new H(n.segments.slice(r.pathIndex),n.children),Ar(o,0,i)}else return r.match&&i.length===0?new H(n.segments,{}):r.match&&!n.hasChildren()?na(n,e,t):r.match?Ar(n,0,i):na(n,e,t)}function Ar(n,e,t){if(t.length===0)return new H(n.segments,{});{let r=Zg(t),i={};if(Object.keys(r).some(o=>o!==U)&&n.children[U]&&n.numberOfChildren===1&&n.children[U].segments.length===0){let o=Ar(n.children[U],e,t);return new H(n.segments,o.children)}return Object.entries(r).forEach(([o,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[o]=md(n.children[o],e,a))}),Object.entries(n.children).forEach(([o,a])=>{r[o]===void 0&&(i[o]=a)}),new H(n.segments,i)}}function em(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let a=n.segments[i],u=t[r];if(Rr(u))break;let l=`${u}`,f=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&f&&typeof f=="object"&&f.outlets===void 0){if(!Qh(l,f,a))return o;r+=2}else{if(!Qh(l,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function na(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Rr(o)){let l=tm(o.outlets);return new H(r,l)}if(i===0&&Hi(t[0])){let l=n.segments[e];r.push(new zt(l.path,Hh(t[0]))),i++;continue}let a=Rr(o)?o.outlets[U]:`${o}`,u=i<t.length-1?t[i+1]:null;a&&u&&Hi(u)?(r.push(new zt(a,Hh(u))),i+=2):(r.push(new zt(a,{})),i++)}return new H(r,{})}function tm(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=na(new H([],{}),0,r))}),e}function Hh(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Qh(n,e,t){return n==t.path&&Ye(e,t.parameters)}var Sr="imperative",he=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(he||{}),Ue=class{constructor(e,t){this.id=e,this.url=t}},Sn=class extends Ue{constructor(e,t,r="imperative",i=null){super(e,t),this.type=he.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ke=class extends Ue{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=he.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},xe=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(xe||{}),Ji=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Ji||{}),lt=class extends Ue{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=he.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},bt=class extends Ue{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=he.NavigationSkipped}},Cr=class extends Ue{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=he.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yi=class extends Ue{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=he.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ra=class extends Ue{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=he.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ia=class extends Ue{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=he.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},sa=class extends Ue{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=he.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},oa=class extends Ue{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=he.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aa=class{constructor(e){this.route=e,this.type=he.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ca=class{constructor(e){this.route=e,this.type=he.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ua=class{constructor(e){this.snapshot=e,this.type=he.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},la=class{constructor(e){this.snapshot=e,this.type=he.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ha=class{constructor(e){this.snapshot=e,this.type=he.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},da=class{constructor(e){this.snapshot=e,this.type=he.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xi=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=he.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Pr=class{},bn=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function nm(n,e){return n.providers&&!n._injector&&(n._injector=zo(n.providers,e,`Route: ${n.path}`)),n._injector??e}function We(n){return n.outlet||U}function rm(n,e){let t=n.filter(r=>We(r)===e);return t.push(...n.filter(r=>We(r)!==e)),t}function Lr(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var fa=class{get injector(){return Lr(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Fr(this.rootInjector),this.attachRef=null}},Fr=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new fa(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(ze(yr))}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Zi=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=pa(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=pa(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ga(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ga(e,this._root).map(t=>t.value)}};function pa(n,e){if(n===e.value)return e;for(let t of e.children){let r=pa(n,t);if(r)return r}return null}function ga(n,e){if(n===e.value)return[e];for(let t of e.children){let r=ga(n,t);if(r.length)return r.unshift(e),r}return[]}var Oe=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function vn(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var es=class extends Zi{constructor(e,t){super(e),this.snapshot=t,Aa(this,e)}toString(){return this.snapshot.toString()}};function _d(n){let e=im(n),t=new Fe([new zt("",{})]),r=new Fe({}),i=new Fe({}),o=new Fe({}),a=new Fe(""),u=new Rt(t,r,o,a,i,U,n,e.root);return u.snapshot=e.root,new es(new Oe(u,[]),e)}function im(n){let e={},t={},r={},i="",o=new wn([],e,r,i,t,U,n,null,{});return new ns("",new Oe(o,[]))}var Rt=class{constructor(e,t,r,i,o,a,u,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=a,this.component=u,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(X(f=>f[Vr]))??L(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(X(e=>Tn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(X(e=>Tn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function ts(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),n.params),data:x(x({},e.data),n.data),resolve:x(x(x(x({},n.data),e.data),i?.data),n._resolvedData)}:r={params:x({},n.params),data:x({},n.data),resolve:x(x({},n.data),n._resolvedData??{})},i&&vd(i)&&(r.resolve[Vr]=i.title),r}var wn=class{get title(){return this.data?.[Vr]}constructor(e,t,r,i,o,a,u,l,f){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=u,this.routeConfig=l,this._resolve=f}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Tn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Tn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ns=class extends Zi{constructor(e,t){super(t),this.url=e,Aa(this,t)}toString(){return yd(this._root)}};function Aa(n,e){e.value._routerState=n,e.children.forEach(t=>Aa(n,t))}function yd(n){let e=n.children.length>0?` { ${n.children.map(yd).join(", ")} } `:"";return`${n.value}${e}`}function Jo(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ye(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ye(e.params,t.params)||n.paramsSubject.next(t.params),kg(e.url,t.url)||n.urlSubject.next(t.url),Ye(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ma(n,e){let t=Ye(n.params,e.params)&&Vg(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||ma(n.parent,e.parent))}function vd(n){return typeof n.title=="string"||n.title===null}var sm=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=U,this.activateEvents=new _n,this.deactivateEvents=new _n,this.attachEvents=new _n,this.detachEvents=new _n,this.parentContexts=F(Fr),this.location=F(Ah),this.changeDetector=F(qi),this.inputBinder=F(os,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ce(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ce(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ce(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Ce(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,l=new _a(t,u,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Fi({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ui]})}}return n})(),_a=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Rt?this.route:e===Fr?this.childContexts:this.parent.get(e,t)}},os=new _e(""),Jh=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Mi([r.queryParams,r.params,r.data]).pipe(je(([o,a,u],l)=>(u=x(x(x({},o),a),u),l===0?L(u):Promise.resolve(u)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let a=Uh(r.component);if(!a){this.unsubscribeFromRouteData(t);return}for(let{templateName:u}of a.inputs)t.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac})}}return n})();function om(n,e,t){let r=Dr(n,e._root,t?t._root:void 0);return new es(r,e)}function Dr(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=am(n,e,t);return new Oe(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let a=o.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>Dr(n,u)),a}}let r=cm(e.value),i=e.children.map(o=>Dr(n,o));return new Oe(r,i)}}function am(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Dr(n,r,i);return Dr(n,r)})}function cm(n){return new Rt(new Fe(n.url),new Fe(n.params),new Fe(n.queryParams),new Fe(n.fragment),new Fe(n.data),n.outlet,n.component,n)}var kr=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Id="ngNavigationCancelingError";function rs(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Wt(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=wd(!1,xe.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function wd(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Id]=!0,t.cancellationCode=e,t}function um(n){return Ed(n)&&Wt(n.url)}function Ed(n){return!!n&&n[Id]}var lm=(n,e,t,r)=>X(i=>(new ya(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),ya=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Jo(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=vn(t);e.children.forEach(o=>{let a=o.value.outlet;this.deactivateRoutes(o,i[a],r),delete i[a]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=vn(e);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=vn(e);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=vn(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new da(o.value.snapshot))}),e.children.length&&this.forwardEvent(new la(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(Jo(i),i===o)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),Jo(u.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},is=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},En=class{constructor(e,t){this.component=e,this.route=t}};function hm(n,e,t){let r=n._root,i=e?e._root:null;return Er(r,i,t,[r.value])}function dm(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Cn(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!gh(n)?n:e.get(n):r}function Er(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=vn(e);return n.children.forEach(a=>{fm(a,o[a.value.outlet],t,r.concat([a.value]),i),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,u])=>br(u,t.getContext(a),i)),i}function fm(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,a=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){let l=pm(a,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new is(r)):(o.data=a.data,o._resolvedData=a._resolvedData),o.component?Er(n,e,u?u.children:null,r,i):Er(n,e,t,r,i),l&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new En(u.outlet.component,a))}else a&&br(e,u,i),i.canActivateChecks.push(new is(r)),o.component?Er(n,null,u?u.children:null,r,i):Er(n,null,t,r,i);return i}function pm(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Gt(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Gt(n.url,e.url)||!Ye(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ma(n,e)||!Ye(n.queryParams,e.queryParams);case"paramsChange":default:return!ma(n,e)}}function br(n,e,t){let r=vn(n),i=n.value;Object.entries(r).forEach(([o,a])=>{i.component?e?br(a,e.children.getContext(o),t):br(a,null,t):br(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new En(e.outlet.component,i)):t.canDeactivateChecks.push(new En(null,i)):t.canDeactivateChecks.push(new En(null,i))}function Ur(n){return typeof n=="function"}function gm(n){return typeof n=="boolean"}function mm(n){return n&&Ur(n.canLoad)}function _m(n){return n&&Ur(n.canActivate)}function ym(n){return n&&Ur(n.canActivateChild)}function vm(n){return n&&Ur(n.canDeactivate)}function Im(n){return n&&Ur(n.canMatch)}function Td(n){return n instanceof ah||n?.name==="EmptyError"}var zi=Symbol("INITIAL_VALUE");function Rn(){return je(n=>Mi(n.map(e=>e.pipe(gn(1),dh(zi)))).pipe(X(e=>{for(let t of e)if(t!==!0){if(t===zi)return zi;if(t===!1||wm(t))return t}return!0}),Bt(e=>e!==zi),gn(1)))}function wm(n){return Wt(n)||n instanceof kr}function Em(n,e){return Ne(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=t;return a.length===0&&o.length===0?L(Re(x({},t),{guardsResult:!0})):Tm(a,r,i,n).pipe(Ne(u=>u&&gm(u)?Am(r,o,n,e):L(u)),X(u=>Re(x({},t),{guardsResult:u})))})}function Tm(n,e,t,r){return De(n).pipe(Ne(i=>Pm(i.component,i.route,t,e,r)),St(i=>i!==!0,!0))}function Am(n,e,t,r){return De(e).pipe(pn(i=>ch(bm(i.route.parent,r),Sm(i.route,r),Cm(n,i.path,t),Rm(n,i.route,t))),St(i=>i!==!0,!0))}function Sm(n,e){return n!==null&&e&&e(new ha(n)),L(!0)}function bm(n,e){return n!==null&&e&&e(new ua(n)),L(!0)}function Rm(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return L(!0);let i=r.map(o=>Lo(()=>{let a=Lr(e)??t,u=Cn(o,a),l=_m(u)?u.canActivate(e,n):Je(a,()=>u(e,n));return Ct(l).pipe(St())}));return L(i).pipe(Rn())}function Cm(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(a=>dm(a)).filter(a=>a!==null).map(a=>Lo(()=>{let u=a.guards.map(l=>{let f=Lr(a.node)??t,_=Cn(l,f),E=ym(_)?_.canActivateChild(r,n):Je(f,()=>_(r,n));return Ct(E).pipe(St())});return L(u).pipe(Rn())}));return L(o).pipe(Rn())}function Pm(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return L(!0);let a=o.map(u=>{let l=Lr(e)??i,f=Cn(u,l),_=vm(f)?f.canDeactivate(n,e,t,r):Je(l,()=>f(n,e,t,r));return Ct(_).pipe(St())});return L(a).pipe(Rn())}function Dm(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return L(!0);let o=i.map(a=>{let u=Cn(a,n),l=mm(u)?u.canLoad(e,t):Je(n,()=>u(e,t));return Ct(l)});return L(o).pipe(Rn(),Ad(r))}function Ad(n){return rh(le(e=>{if(typeof e!="boolean")throw rs(n,e)}),X(e=>e===!0))}function km(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return L(!0);let o=i.map(a=>{let u=Cn(a,n),l=Im(u)?u.canMatch(e,t):Je(n,()=>u(e,t));return Ct(l)});return L(o).pipe(Rn(),Ad(r))}var Nr=class{constructor(e){this.segmentGroup=e||null}},Or=class extends Error{constructor(e){super(),this.urlTree=e}};function yn(n){return mr(new Nr(n))}function Nm(n){return mr(new Ce(4e3,!1))}function Om(n){return mr(wd(!1,xe.GuardRejected))}var va=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return L(r);if(i.numberOfChildren>1||!i.children[U])return Nm(`${e.redirectTo}`);i=i.children[U]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let u=t,{queryParams:l,fragment:f,routeConfig:_,url:E,outlet:S,params:D,data:k,title:V}=i,N=Je(o,()=>u({params:D,data:k,queryParams:l,fragment:f,routeConfig:_,url:E,outlet:S,title:V}));if(N instanceof ht)throw new Or(N);t=N}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Or(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new ht(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let u=o.substring(1);r[i]=t[u]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([u,l])=>{a[u]=this.createSegmentGroup(e,l,r,i)}),new H(o,a)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Ce(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Ia={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xm(n,e,t,r,i){let o=Sd(n,e,t);return o.matched?(r=nm(e,r),km(r,e,t,i).pipe(X(a=>a===!0?o:x({},Ia)))):L(o)}function Sd(n,e,t){if(e.path==="**")return Vm(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?x({},Ia):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Dg)(t,n,e);if(!i)return x({},Ia);let o={};Object.entries(i.posParams??{}).forEach(([u,l])=>{o[u]=l.path});let a=i.consumed.length>0?x(x({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function Vm(n){return{matched:!0,parameters:n.length>0?id(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Yh(n,e,t,r){return t.length>0&&Fm(n,t,r)?{segmentGroup:new H(e,Lm(r,new H(t,n.children))),slicedSegments:[]}:t.length===0&&Um(n,t,r)?{segmentGroup:new H(n.segments,Mm(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new H(n.segments,n.children),slicedSegments:t}}function Mm(n,e,t,r){let i={};for(let o of t)if(as(n,e,o)&&!r[We(o)]){let a=new H([],{});i[We(o)]=a}return x(x({},r),i)}function Lm(n,e){let t={};t[U]=e;for(let r of n)if(r.path===""&&We(r)!==U){let i=new H([],{});t[We(r)]=i}return t}function Fm(n,e,t){return t.some(r=>as(n,e,r)&&We(r)!==U)}function Um(n,e,t){return t.some(r=>as(n,e,r))}function as(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function $m(n,e,t){return e.length===0&&!n.children[t]}var wa=class{};function qm(n,e,t,r,i,o,a="emptyOnly"){return new Ea(n,e,t,r,i,a,o).recognize()}var Bm=31,Ea=class{constructor(e,t,r,i,o,a,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new va(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Ce(4002,`'${e.segmentGroup}'`)}recognize(){let e=Yh(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(X(({children:t,rootSnapshot:r})=>{let i=new Oe(r,t),o=new ns("",i),a=Qg(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(a),{state:o,tree:a}}))}match(e){let t=new wn([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),U,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,U,t).pipe(X(r=>({children:r,rootSnapshot:t})),fn(r=>{if(r instanceof Or)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Nr?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(X(a=>a instanceof Oe?[a]:[]))}processChildren(e,t,r,i){let o=[];for(let a of Object.keys(r.children))a==="primary"?o.unshift(a):o.push(a);return De(o).pipe(pn(a=>{let u=r.children[a],l=rm(t,a);return this.processSegmentGroup(e,l,u,a,i)}),hh((a,u)=>(a.push(...u),a)),Fo(null),lh(),Ne(a=>{if(a===null)return yn(r);let u=bd(a);return jm(u),L(u)}))}processSegment(e,t,r,i,o,a,u){return De(t).pipe(pn(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,o,a,u).pipe(fn(f=>{if(f instanceof Nr)return L(null);throw f}))),St(l=>!!l),fn(l=>{if(Td(l))return $m(r,i,o)?L(new wa):yn(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,o,a,u,l){return We(r)!==a&&(a===U||!as(i,o,r))?yn(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,a,l):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,a,l):yn(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,a,u){let{matched:l,parameters:f,consumedSegments:_,positionalParamSegments:E,remainingSegments:S}=Sd(t,i,o);if(!l)return yn(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Bm&&(this.allowRedirects=!1));let D=new wn(o,f,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,Xh(i),We(i),i.component??i._loadedComponent??null,i,Zh(i)),k=ts(D,u,this.paramsInheritanceStrategy);D.params=Object.freeze(k.params),D.data=Object.freeze(k.data);let V=this.applyRedirects.applyRedirectCommands(_,i.redirectTo,E,D,e);return this.applyRedirects.lineralizeSegments(i,V).pipe(Ne(N=>this.processSegment(e,r,t,N.concat(S),a,!1,u)))}matchSegmentAgainstRoute(e,t,r,i,o,a){let u=xm(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),u.pipe(je(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(je(({routes:f})=>{let _=r._loadedInjector??e,{parameters:E,consumedSegments:S,remainingSegments:D}=l,k=new wn(S,E,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,Xh(r),We(r),r.component??r._loadedComponent??null,r,Zh(r)),V=ts(k,a,this.paramsInheritanceStrategy);k.params=Object.freeze(V.params),k.data=Object.freeze(V.data);let{segmentGroup:N,slicedSegments:G}=Yh(t,S,D,f);if(G.length===0&&N.hasChildren())return this.processChildren(_,f,N,k).pipe(X(K=>new Oe(k,K)));if(f.length===0&&G.length===0)return L(new Oe(k,[]));let Q=We(r)===o;return this.processSegment(_,f,N,G,Q?U:o,!0,k).pipe(X(K=>new Oe(k,K instanceof Oe?[K]:[])))}))):yn(t)))}getChildConfig(e,t,r){return t.children?L({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?L({routes:t._loadedRoutes,injector:t._loadedInjector}):Dm(e,t,r,this.urlSerializer).pipe(Ne(i=>i?this.configLoader.loadChildren(e,t).pipe(le(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):Om(t))):L({routes:[],injector:e})}};function jm(n){n.sort((e,t)=>e.value.outlet===U?-1:t.value.outlet===U?1:e.value.outlet.localeCompare(t.value.outlet))}function zm(n){let e=n.value.routeConfig;return e&&e.path===""}function bd(n){let e=[],t=new Set;for(let r of n){if(!zm(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=bd(r.children);e.push(new Oe(r.value,i))}return e.filter(r=>!t.has(r))}function Xh(n){return n.data||{}}function Zh(n){return n.resolve||{}}function Gm(n,e,t,r,i,o){return Ne(a=>qm(n,e,t,r,a.extractedUrl,i,o).pipe(X(({state:u,tree:l})=>Re(x({},a),{targetSnapshot:u,urlAfterRedirects:l}))))}function Wm(n,e){return Ne(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return L(t);let o=new Set(i.map(l=>l.route)),a=new Set;for(let l of o)if(!a.has(l))for(let f of Rd(l))a.add(f);let u=0;return De(a).pipe(pn(l=>o.has(l)?Km(l,r,n,e):(l.data=ts(l,l.parent,n).resolve,L(void 0))),le(()=>u++),Uo(1),Ne(l=>u===a.size?L(t):At))})}function Rd(n){let e=n.children.map(t=>Rd(t)).flat();return[n,...e]}function Km(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!vd(i)&&(o[Vr]=i.title),Hm(o,n,e,r).pipe(X(a=>(n._resolvedData=a,n.data=ts(n,n.parent,t).resolve,null)))}function Hm(n,e,t,r){let i=Zo(n);if(i.length===0)return L({});let o={};return De(i).pipe(Ne(a=>Qm(n[a],e,t,r).pipe(St(),le(u=>{if(u instanceof kr)throw rs(new An,u);o[a]=u}))),Uo(1),uh(o),fn(a=>Td(a)?At:mr(a)))}function Qm(n,e,t,r){let i=Lr(e)??r,o=Cn(n,i),a=o.resolve?o.resolve(e,t):Je(i,()=>o(e,t));return Ct(a)}function Yo(n){return je(e=>{let t=n(e);return t?De(t).pipe(X(()=>e)):L(e)})}var Cd=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===U);return r}getResolvedTitleForRoute(t){return t.data[Vr]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:()=>F(Jm),providedIn:"root"})}}return n})(),Jm=(()=>{class n extends Cd{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(ze(Gh))}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),$r=new _e("",{providedIn:"root",factory:()=>({})}),Ym=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=_h({type:n,selectors:[["ng-component"]],standalone:!0,features:[xh],decls:1,vars:0,template:function(r,i){r&1&&Ph(0,"router-outlet")},dependencies:[sm],encapsulation:2})}}return n})();function Sa(n){let e=n.children&&n.children.map(Sa),t=e?Re(x({},n),{children:e}):x({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==U&&(t.component=Ym),t}var xr=new _e(""),ba=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=F($i)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return L(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Ct(t.loadComponent()).pipe(X(Pd),le(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Li(()=>{this.componentLoaders.delete(t)})),i=new Oo(r,()=>new Tt).pipe(No());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return L({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=Xm(r,this.compiler,t,this.onLoadEndListener).pipe(Li(()=>{this.childrenLoaders.delete(r)})),a=new Oo(o,()=>new Tt).pipe(No());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Xm(n,e,t,r){return Ct(n.loadChildren()).pipe(X(Pd),Ne(i=>i instanceof bh||Array.isArray(i)?L(i):De(e.compileModuleAsync(i))),X(i=>{r&&r(n);let o,a,u=!1;return Array.isArray(i)?(a=i,u=!0):(o=i.create(t).injector,a=o.get(xr,[],{optional:!0,self:!0}).flat()),{routes:a.map(Sa),injector:o}}))}function Zm(n){return n&&typeof n=="object"&&"default"in n}function Pd(n){return Zm(n)?n.default:n}var Ra=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:()=>F(e_),providedIn:"root"})}}return n})(),e_=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Dd=new _e(""),kd=new _e("");function t_(n,e,t){let r=n.get(kd),i=n.get($h);return n.get(ut).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(f=>setTimeout(f));let o,a=new Promise(f=>{o=f}),u=i.startViewTransition(()=>(o(),n_(n))),{onViewTransitionCreated:l}=r;return l&&Je(n,()=>l({transition:u,from:e,to:t})),a})}function n_(n){return new Promise(e=>{Rh({read:()=>setTimeout(e)},{injector:n})})}var r_=new _e(""),Ca=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tt,this.transitionAbortSubject=new Tt,this.configLoader=F(ba),this.environmentInjector=F(yr),this.urlSerializer=F(Mr),this.rootContexts=F(Fr),this.location=F(Ir),this.inputBindingEnabled=F(os,{optional:!0})!==null,this.titleStrategy=F(Cd),this.options=F($r,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=F(Ra),this.createViewTransition=F(Dd,{optional:!0}),this.navigationErrorHandler=F(r_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>L(void 0),this.rootComponentType=null;let t=i=>this.events.next(new aa(i)),r=i=>this.events.next(new ca(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Re(x(x({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Fe({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Sr,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Bt(o=>o.id!==0),X(o=>Re(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),je(o=>{let a=!1,u=!1;return L(o).pipe(je(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",xe.SupersededByNewNavigation),At;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Re(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),_=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!f&&_!=="reload"){let E="";return this.events.next(new bt(l.id,this.urlSerializer.serialize(l.rawUrl),E,Ji.IgnoredSameUrlNavigation)),l.resolve(!1),At}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return L(l).pipe(je(E=>{let S=this.transitions?.getValue();return this.events.next(new Sn(E.id,this.urlSerializer.serialize(E.extractedUrl),E.source,E.restoredState)),S!==this.transitions?.getValue()?At:Promise.resolve(E)}),Gm(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),le(E=>{o.targetSnapshot=E.targetSnapshot,o.urlAfterRedirects=E.urlAfterRedirects,this.currentNavigation=Re(x({},this.currentNavigation),{finalUrl:E.urlAfterRedirects});let S=new Yi(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(S)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:E,extractedUrl:S,source:D,restoredState:k,extras:V}=l,N=new Sn(E,this.urlSerializer.serialize(S),D,k);this.events.next(N);let G=_d(this.rootComponentType).snapshot;return this.currentTransition=o=Re(x({},l),{targetSnapshot:G,urlAfterRedirects:S,extras:Re(x({},V),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=S,L(o)}else{let E="";return this.events.next(new bt(l.id,this.urlSerializer.serialize(l.extractedUrl),E,Ji.IgnoredByUrlHandlingStrategy)),l.resolve(!1),At}}),le(l=>{let f=new ra(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(f)}),X(l=>(this.currentTransition=o=Re(x({},l),{guards:hm(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),Em(this.environmentInjector,l=>this.events.next(l)),le(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw rs(this.urlSerializer,l.guardsResult);let f=new ia(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(f)}),Bt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",xe.GuardRejected),!1)),Yo(l=>{if(l.guards.canActivateChecks.length)return L(l).pipe(le(f=>{let _=new sa(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(_)}),je(f=>{let _=!1;return L(f).pipe(Wm(this.paramsInheritanceStrategy,this.environmentInjector),le({next:()=>_=!0,complete:()=>{_||this.cancelNavigationTransition(f,"",xe.NoDataFromResolver)}}))}),le(f=>{let _=new oa(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(_)}))}),Yo(l=>{let f=_=>{let E=[];_.routeConfig?.loadComponent&&!_.routeConfig._loadedComponent&&E.push(this.configLoader.loadComponent(_.routeConfig).pipe(le(S=>{_.component=S}),X(()=>{})));for(let S of _.children)E.push(...f(S));return E};return Mi(f(l.targetSnapshot.root)).pipe(Fo(null),gn(1))}),Yo(()=>this.afterPreactivation()),je(()=>{let{currentSnapshot:l,targetSnapshot:f}=o,_=this.createViewTransition?.(this.environmentInjector,l.root,f.root);return _?De(_).pipe(X(()=>o)):L(o)}),X(l=>{let f=om(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Re(x({},l),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),le(()=>{this.events.next(new Pr)}),lm(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),gn(1),le({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ke(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),fh(this.transitionAbortSubject.pipe(le(l=>{throw l}))),Li(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",xe.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),fn(l=>{if(u=!0,Ed(l))this.events.next(new lt(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),um(l)?this.events.next(new bn(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let f=new Cr(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let _=Je(this.environmentInjector,()=>this.navigationErrorHandler?.(f));if(_ instanceof kr){let{message:E,cancellationCode:S}=rs(this.urlSerializer,_);this.events.next(new lt(o.id,this.urlSerializer.serialize(o.extractedUrl),E,S)),this.events.next(new bn(_.redirectTo,_.navigationBehaviorOptions))}else{this.events.next(f);let E=t.errorHandler(l);o.resolve(!!E)}}catch(_){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(_)}}return At}))}))}cancelNavigationTransition(t,r,i){let o=new lt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function i_(n){return n!==Sr}var s_=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:()=>F(o_),providedIn:"root"})}}return n})(),Ta=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},o_=(()=>{class n extends Ta{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=qo(n)))(i||n)}})()}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Nd=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:()=>F(a_),providedIn:"root"})}}return n})(),a_=(()=>{class n extends Nd{constructor(){super(...arguments),this.location=F(Ir),this.urlSerializer=F(Mr),this.options=F($r,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=F(Ra),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ht,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=_d(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Sn)this.stateMemento=this.createStateMemento();else if(t instanceof bt)this.rawUrlTree=r.initialUrl;else if(t instanceof Yi){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Pr?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof lt&&(t.code===xe.GuardRejected||t.code===xe.NoDataFromResolver)?this.restoreHistory(r):t instanceof Cr?this.restoreHistory(r,!0):t instanceof Ke&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof ht?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,a=x(x({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",a)}else{let o=x(x({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=qo(n)))(i||n)}})()}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Tr=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Tr||{});function Od(n,e){n.events.pipe(Bt(t=>t instanceof Ke||t instanceof lt||t instanceof Cr||t instanceof bt),X(t=>t instanceof Ke||t instanceof bt?Tr.COMPLETE:(t instanceof lt?t.code===xe.Redirect||t.code===xe.SupersededByNewNavigation:!1)?Tr.REDIRECTING:Tr.FAILED),Bt(t=>t!==Tr.REDIRECTING),gn(1)).subscribe(()=>{e()})}function c_(n){throw n}var u_={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},l_={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Xe=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=F(Mh),this.stateManager=F(Nd),this.options=F($r,{optional:!0})||{},this.pendingTasks=F(Ih),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=F(Ca),this.urlSerializer=F(Mr),this.location=F(Ir),this.urlHandlingStrategy=F(Ra),this._events=new Tt,this.errorHandler=this.options.errorHandler||c_,this.navigated=!1,this.routeReuseStrategy=F(s_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=F(xr,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!F(os,{optional:!0}),this.eventsSubscription=new nh,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof lt&&r.code!==xe.Redirect&&r.code!==xe.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ke)this.navigated=!0;else if(r instanceof bn){let a=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),l=x({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||i_(i.source)},a);this.scheduleNavigation(u,Sr,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}d_(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Sr,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let l=x({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let u=this.parseUrl(t);this.scheduleNavigation(u,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Sa),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:l}=r,f=l?this.currentUrlTree.fragment:a,_=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":_=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":_=this.currentUrlTree.queryParams;break;default:_=o||null}_!==null&&(_=this.removeEmptyProps(_));let E;try{let S=i?i.snapshot:this.routerState.snapshot.root;E=fd(S)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),E=this.currentUrlTree.root}return pd(E,t,_,f??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Wt(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Sr,null,r)}navigate(t,r={skipLocationChange:!1}){return h_(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=x({},u_):r===!1?i=x({},l_):i=r,Wt(t))return Wh(this.currentUrlTree,t,i);let o=this.parseUrl(t);return Wh(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,a){if(this.disposed)return Promise.resolve(!1);let u,l,f;a?(u=a.resolve,l=a.reject,f=a.promise):f=new Promise((E,S)=>{u=E,l=S});let _=this.pendingTasks.add();return Od(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(_))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:u,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(E=>Promise.reject(E))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function h_(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Ce(4008,!1)}function d_(n){return!(n instanceof Pr)&&!(n instanceof bn)}var ed=(()=>{class n{constructor(t,r,i,o,a,u){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.onChanges=new Tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(f=>{f instanceof Ke&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Wt(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(t!==0||r||i||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Eh(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,o=this.el.nativeElement;r!==null?i.setAttribute(o,t,r):i.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:Wt(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||n)(Ge(Xe),Ge(Rt),vh("tabindex"),Ge(jo),Ge(Bo),Ge(vr))}}static{this.\u0275dir=Fi({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&Dh("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&Ch("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Bi],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Bi],replaceUrl:[2,"replaceUrl","replaceUrl",Bi],routerLink:"routerLink"},standalone:!0,features:[Sh,Ui]})}}return n})(),SE=(()=>{class n{get isActive(){return this._isActive}constructor(t,r,i,o,a){this.router=t,this.element=r,this.renderer=i,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new _n,this.routerEventsSubscription=t.events.subscribe(u=>{u instanceof Ke&&this.update()})}ngAfterContentInit(){L(this.links.changes,L(null)).pipe(_r()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=De(t).pipe(_r()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(t){let r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let r=f_(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>{let o=i.urlTree;return o?t.isActive(o,r):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static{this.\u0275fac=function(r){return new(r||n)(Ge(Xe),Ge(Bo),Ge(jo),Ge(qi),Ge(ed,8))}}static{this.\u0275dir=Fi({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,o){if(r&1&&kh(o,ed,5),r&2){let a;Nh(a=Oh())&&(i.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ui]})}}return n})();function f_(n){return!!n.paths}var ss=class{};var p_=(()=>{class n{constructor(t,r,i,o,a){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Bt(t=>t instanceof Ke),pn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=zo(o.providers,t,`Route: ${o.path}`));let a=o._injector??t,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(u,o.children??o._loadedRoutes))}return De(i).pipe(_r())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=L(null);let o=i.pipe(Ne(a=>a===null?L(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??t,a.routes))));if(r.loadComponent&&!r._loadedComponent){let a=this.loader.loadComponent(r);return De([o,a]).pipe(_r())}else return o})}static{this.\u0275fac=function(r){return new(r||n)(ze(Xe),ze($i),ze(yr),ze(ss),ze(ba))}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),xd=new _e(""),g_=(()=>{class n{constructor(t,r,i,o,a={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Sn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ke?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof bt&&t.code===Ji.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Xi&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Xi(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){Th()}}static{this.\u0275prov=ce({token:n,factory:n.\u0275fac})}}return n})();function bE(n,...e){return mn([{provide:xr,multi:!0,useValue:n},[],{provide:Rt,useFactory:Vd,deps:[Xe]},{provide:Ko,multi:!0,useFactory:Md},e.map(t=>t.\u0275providers)])}function Vd(n){return n.routerState.root}function qr(n,e){return{\u0275kind:n,\u0275providers:e}}function Md(){let n=F(jt);return e=>{let t=n.get(Fh);if(e!==t.components[0])return;let r=n.get(Xe),i=n.get(Ld);n.get(Pa)===1&&r.initialNavigation(),n.get(Fd,null,$o.Optional)?.setUpPreloading(),n.get(xd,null,$o.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Ld=new _e("",{factory:()=>new Tt}),Pa=new _e("",{providedIn:"root",factory:()=>1});function m_(){return qr(2,[{provide:Pa,useValue:0},{provide:Wo,multi:!0,deps:[jt],useFactory:e=>{let t=e.get(qh,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Xe),o=e.get(Ld);Od(i,()=>{r(!0)}),e.get(Ca).afterPreactivation=()=>(r(!0),o.closed?L(void 0):o),i.initialNavigation()}))}}])}function __(){return qr(3,[{provide:Wo,multi:!0,useFactory:()=>{let e=F(Xe);return()=>{e.setUpLocationChangeListener()}}},{provide:Pa,useValue:2}])}var Fd=new _e("");function y_(n){return qr(0,[{provide:Fd,useExisting:p_},{provide:ss,useExisting:n}])}function v_(){return qr(8,[Jh,{provide:os,useExisting:Jh}])}function I_(n){let e=[{provide:Dd,useValue:t_},{provide:kd,useValue:x({skipNextTransition:!!n?.skipInitialTransition},n)}];return qr(9,e)}var td=new _e("ROUTER_FORROOT_GUARD"),w_=[Ir,{provide:Mr,useClass:An},Xe,Fr,{provide:Rt,useFactory:Vd,deps:[Xe]},ba,[]],RE=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[w_,[],{provide:xr,multi:!0,useValue:t},{provide:td,useFactory:S_,deps:[[Xe,new Qe,new mh]]},{provide:$r,useValue:r||{}},r?.useHash?T_():A_(),E_(),r?.preloadingStrategy?y_(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?b_(r):[],r?.bindToComponentInputs?v_().\u0275providers:[],r?.enableViewTransitions?I_().\u0275providers:[],R_()]}}static forChild(t){return{ngModule:n,providers:[{provide:xr,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(ze(td,8))}}static{this.\u0275mod=yh({type:n})}static{this.\u0275inj=ph({})}}return n})();function E_(){return{provide:xd,useFactory:()=>{let n=F(zh),e=F(ut),t=F($r),r=F(Ca),i=F(Mr);return t.scrollOffset&&n.setOffset(t.scrollOffset),new g_(i,r,n,e,t)}}}function T_(){return{provide:vr,useClass:jh}}function A_(){return{provide:vr,useClass:Bh}}function S_(n){return"guarded"}function b_(n){return[n.initialNavigation==="disabled"?__().\u0275providers:[],n.initialNavigation==="enabledBlocking"?m_().\u0275providers:[]]}var nd=new _e("");function R_(){return[{provide:nd,useFactory:Md},{provide:Ko,multi:!0,useExisting:nd}]}var $d=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},C_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],l=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},qd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,l=i+2<n.length,f=l?n[i+2]:0,_=o>>2,E=(o&3)<<4|u>>4,S=(u&15)<<2|f>>6,D=f&63;l||(D=64,a||(S=64)),r.push(t[_],t[E],t[S],t[D])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($d(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):C_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let f=i<n.length?t[n.charAt(i)]:64;++i;let E=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||f==null||E==null)throw new ka;let S=o<<2|u>>4;if(r.push(S),f!==64){let D=u<<4&240|f>>2;if(r.push(D),E!==64){let k=f<<6&192|E;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},ka=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},P_=function(n){let e=$d(n);return qd.encodeByteArray(e,!0)},Br=function(n){return P_(n).replace(/\./g,"")},Oa=function(n){try{return qd.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function D_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var k_=()=>D_().__FIREBASE_DEFAULTS__,N_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},O_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Oa(n[1]);return e&&JSON.parse(e)},us=()=>{try{return k_()||N_()||O_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Bd=n=>{var e,t;return(t=(e=us())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},jd=n=>{let e=Bd(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},xa=()=>{var n;return(n=us())===null||n===void 0?void 0:n.config},zd=n=>{var e;return(e=us())===null||e===void 0?void 0:e[`_${n}`]};var cs=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Gd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Br(JSON.stringify(t)),Br(JSON.stringify(a)),""].join(".")}function Ve(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Wd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function x_(){var n;let e=(n=us())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Hd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Qd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Jd(){return!x_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Va(){try{return typeof indexedDB=="object"}catch{return!1}}function Yd(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var V_="FirebaseError",$e=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=V_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dt.prototype.create)}},dt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?M_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new $e(i,u,r)}};function M_(n,e){return n.replace(L_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var L_=/\{\$([^}]+)}/g;function Pn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Ud(o)&&Ud(a)){if(!Pn(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Ud(n){return n!==null&&typeof n=="object"}function Ma(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Xd(n,e){let t=new Na(n,e);return t.subscribe.bind(t)}var Na=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");F_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Da),i.error===void 0&&(i.error=Da),i.complete===void 0&&(i.complete=Da);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function F_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Da(){}var DE=4*60*60*1e3;function Ze(n){return n&&n._delegate?n._delegate:n}var qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Kt="[DEFAULT]";var La=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new cs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($_(e))try{this.getOrInitializeService({instanceIdentifier:Kt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Kt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return b(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Kt){return this.instances.has(e)}getOptions(e=Kt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:U_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kt){return this.component?this.component.multipleInstances?e:Kt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function U_(n){return n===Kt?void 0:n}function $_(n){return n.instantiationMode==="EAGER"}var ls=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new La(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var q_=[],q=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(q||{}),B_={debug:q.DEBUG,verbose:q.VERBOSE,info:q.INFO,warn:q.WARN,error:q.ERROR,silent:q.SILENT},j_=q.INFO,z_={[q.DEBUG]:"log",[q.VERBOSE]:"log",[q.INFO]:"info",[q.WARN]:"warn",[q.ERROR]:"error"},G_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=z_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Pt=class{constructor(e){this.name=e,this._logLevel=j_,this._logHandler=G_,this._userLogHandler=null,q_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?B_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,q.DEBUG,...e),this._logHandler(this,q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,q.VERBOSE,...e),this._logHandler(this,q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,q.INFO,...e),this._logHandler(this,q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,q.WARN,...e),this._logHandler(this,q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,q.ERROR,...e),this._logHandler(this,q.ERROR,...e)}};var W_=(n,e)=>e.some(t=>n instanceof t),Zd,ef;function K_(){return Zd||(Zd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H_(){return ef||(ef=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var tf=new WeakMap,Ua=new WeakMap,nf=new WeakMap,Fa=new WeakMap,qa=new WeakMap;function Q_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(et(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&tf.set(t,n)}).catch(()=>{}),qa.set(e,n),e}function J_(n){if(Ua.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Ua.set(n,e)}var $a={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ua.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function rf(n){$a=n($a)}function Y_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(hs(this),e,...t);return nf.set(r,e.sort?e.sort():[e]),et(r)}:H_().includes(n)?function(...e){return n.apply(hs(this),e),et(tf.get(this))}:function(...e){return et(n.apply(hs(this),e))}}function X_(n){return typeof n=="function"?Y_(n):(n instanceof IDBTransaction&&J_(n),W_(n,K_())?new Proxy(n,$a):n)}function et(n){if(n instanceof IDBRequest)return Q_(n);if(Fa.has(n))return Fa.get(n);let e=X_(n);return e!==n&&(Fa.set(n,e),qa.set(e,n)),e}var hs=n=>qa.get(n);function of(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=et(a);return r&&a.addEventListener("upgradeneeded",l=>{r(et(a.result),l.oldVersion,l.newVersion,et(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}var Z_=["get","getKey","getAll","getAllKeys","count"],ey=["put","add","delete","clear"],Ba=new Map;function sf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ba.get(e))return Ba.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=ey.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Z_.includes(t)))return;let o=function(a,...u){return b(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),f=l.store;return r&&(f=f.index(u.shift())),(yield Promise.all([f[t](...u),i&&l.done]))[0]})};return Ba.set(e,o),o}rf(n=>Re(x({},n),{get:(e,t,r)=>sf(e,t)||n.get(e,t,r),has:(e,t)=>!!sf(e,t)||n.has(e,t)}));var za=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ty(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function ty(n){let e=n.getComponent();return e?.type==="VERSION"}var Ga="@firebase/app",af="0.10.12";var ft=new Pt("@firebase/app"),ny="@firebase/app-compat",ry="@firebase/analytics-compat",iy="@firebase/analytics",sy="@firebase/app-check-compat",oy="@firebase/app-check",ay="@firebase/auth",cy="@firebase/auth-compat",uy="@firebase/database",ly="@firebase/data-connect",hy="@firebase/database-compat",dy="@firebase/functions",fy="@firebase/functions-compat",py="@firebase/installations",gy="@firebase/installations-compat",my="@firebase/messaging",_y="@firebase/messaging-compat",yy="@firebase/performance",vy="@firebase/performance-compat",Iy="@firebase/remote-config",wy="@firebase/remote-config-compat",Ey="@firebase/storage",Ty="@firebase/storage-compat",Ay="@firebase/firestore",Sy="@firebase/vertexai-preview",by="@firebase/firestore-compat",Ry="firebase",Cy="10.14.0";var Wa="[DEFAULT]",Py={[Ga]:"fire-core",[ny]:"fire-core-compat",[iy]:"fire-analytics",[ry]:"fire-analytics-compat",[oy]:"fire-app-check",[sy]:"fire-app-check-compat",[ay]:"fire-auth",[cy]:"fire-auth-compat",[uy]:"fire-rtdb",[ly]:"fire-data-connect",[hy]:"fire-rtdb-compat",[dy]:"fire-fn",[fy]:"fire-fn-compat",[py]:"fire-iid",[gy]:"fire-iid-compat",[my]:"fire-fcm",[_y]:"fire-fcm-compat",[yy]:"fire-perf",[vy]:"fire-perf-compat",[Iy]:"fire-rc",[wy]:"fire-rc-compat",[Ey]:"fire-gcs",[Ty]:"fire-gcs-compat",[Ay]:"fire-fst",[by]:"fire-fst-compat",[Sy]:"fire-vertex","fire-js":"fire-js",[Ry]:"fire-js-all"};var jr=new Map,Dy=new Map,Ka=new Map;function cf(n,e){try{n.container.addComponent(e)}catch(t){ft.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function kt(n){let e=n.name;if(Ka.has(e))return ft.debug(`There were multiple attempts to register component ${e}.`),!1;Ka.set(e,n);for(let t of jr.values())cf(t,n);for(let t of Dy.values())cf(t,n);return!0}function Ya(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Dn(n){return n.settings!==void 0}var ky={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dt=new dt("app","Firebase",ky);var Ha=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dt.create("app-deleted",{appName:this._name})}};var kn=Cy;function Xa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Wa,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Dt.create("bad-app-name",{appName:String(i)});if(t||(t=xa()),!t)throw Dt.create("no-options");let o=jr.get(i);if(o){if(Pn(t,o.options)&&Pn(r,o.config))return o;throw Dt.create("duplicate-app",{appName:i})}let a=new ls(i);for(let l of Ka.values())a.addComponent(l);let u=new Ha(t,r,a);return jr.set(i,u),u}function Gr(n=Wa){let e=jr.get(n);if(!e&&n===Wa&&xa())return Xa();if(!e)throw Dt.create("no-app",{appName:n});return e}function ds(){return Array.from(jr.values())}function de(n,e,t){var r;let i=(r=Py[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ft.warn(u.join(" "));return}kt(new qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Ny="firebase-heartbeat-database",Oy=1,zr="firebase-heartbeat-store",ja=null;function df(){return ja||(ja=of(Ny,Oy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Dt.create("idb-open",{originalErrorMessage:n.message})})),ja}function xy(n){return b(this,null,function*(){try{let t=(yield df()).transaction(zr),r=yield t.objectStore(zr).get(ff(n));return yield t.done,r}catch(e){if(e instanceof $e)ft.warn(e.message);else{let t=Dt.create("idb-get",{originalErrorMessage:e?.message});ft.warn(t.message)}}})}function uf(n,e){return b(this,null,function*(){try{let r=(yield df()).transaction(zr,"readwrite");yield r.objectStore(zr).put(e,ff(n)),yield r.done}catch(t){if(t instanceof $e)ft.warn(t.message);else{let r=Dt.create("idb-set",{originalErrorMessage:t?.message});ft.warn(r.message)}}})}function ff(n){return`${n.name}!${n.options.appId}`}var Vy=1024,My=30*24*60*60*1e3,Qa=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ja(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return b(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=lf();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=My}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ft.warn(r)}})}getHeartbeatsHeader(){return b(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=lf(),{heartbeatsToSend:r,unsentEntries:i}=Ly(this._heartbeatsCache.heartbeats),o=Br(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ft.warn(t),""}})}};function lf(){return new Date().toISOString().substring(0,10)}function Ly(n,e=Vy){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),hf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),hf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Ja=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return b(this,null,function*(){return Va()?Yd().then(()=>!0).catch(()=>!1):!1})}read(){return b(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield xy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return b(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return uf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return b(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return uf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function hf(n){return Br(JSON.stringify({version:2,heartbeats:n})).length}function Fy(n){kt(new qe("platform-logger",e=>new za(e),"PRIVATE")),kt(new qe("heartbeat",e=>new Qa(e),"PRIVATE")),de(Ga,af,n),de(Ga,af,"esm2017"),de("fire-js","")}Fy("");var Uy="firebase",$y="10.14.0";de(Uy,$y,"app");var On=new Go("ANGULARFIRE2_VERSION");function ec(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Kr=(n,e)=>{let t=e?[e]:ds(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Wr=class{constructor(){return Kr(qy)}},qy="app-check";function Nn(){}var fs=class{zone;delegate;constructor(e,t=sh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},Za=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nn,{},Nn,Nn)),t.pipe(le({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Hr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new fs(Zone.current)),this.insideAngular=t.run(()=>new fs(Zone.current,ih)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(ze(ut))};static \u0275prov=ce({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ps(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function By(n){return ps().ngZone.runOutsideAngular(()=>n())}function Ht(n){return ps().ngZone.run(()=>n())}function jy(n){return zy(ps())(n)}function zy(n){return function(t){return t=t.lift(new Za(n.ngZone)),t.pipe(Mo(n.outsideAngular),Vo(n.insideAngular))}}var Gy=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ht(()=>n.apply(void 0,r))},Nt=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Ht(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nn,{},Nn,Nn))),r[o]=Gy(r[o],t));let i=By(()=>n.apply(this,r));if(!e)if(i instanceof ko){let o=ps();return i.pipe(Mo(o.outsideAngular),Vo(o.insideAngular))}else return Ht(()=>i);return i instanceof ko?i.pipe(jy):i instanceof Promise?Ht(()=>new Promise((o,a)=>i.then(u=>Ht(()=>o(u)),u=>Ht(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Ht(()=>i)};var Qt=class{constructor(e){return e}},Qr=class{constructor(){return ds()}};function Wy(n){return n&&n.length===1?n[0]:new Qt(Gr())}var tc=new _e("angularfire2._apps"),Ky={provide:Qt,useFactory:Wy,deps:[[new Qe,tc]]},Hy={provide:Qr,deps:[[new Qe,tc]]};function Qy(n){return(e,t)=>{let r=t.get(wh);de("angularfire",On.full,"core"),de("angularfire",On.full,"app"),de("angular",Vh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Qt(i)}}function mT(n,...e){return mn([Ky,Hy,{provide:tc,useFactory:Qy(n),multi:!0,deps:[ut,jt,Hr,...e]}])}var _T=Nt(Xa,!0);function wf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ef=wf,Tf=new dt("auth","Firebase",wf());var ys=new Pt("@firebase/auth");function Yy(n,...e){ys.logLevel<=q.WARN&&ys.warn(`Auth (${kn}): ${n}`,...e)}function ms(n,...e){ys.logLevel<=q.ERROR&&ys.error(`Auth (${kn}): ${n}`,...e)}function pf(n,...e){throw fc(n,...e)}function dc(n,...e){return fc(n,...e)}function Af(n,e,t){let r=Object.assign(Object.assign({},Ef()),{[e]:t});return new dt("auth","Firebase",r).create(e,{appName:n.name})}function _s(n){return Af(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Tf.create(n,...e)}function W(n,e,...t){if(!n)throw fc(e,...t)}function Jr(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ms(e),new Error(e)}function vs(n,e){n||Jr(e)}function Xy(){return gf()==="http:"||gf()==="https:"}function gf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Zy(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xy()||Hd()||"connection"in navigator)?navigator.onLine:!0}function ev(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Yt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,vs(t>e,"Short delay should be less than long delay!"),this.isMobile=Wd()||Qd()}get(){return Zy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function tv(n,e){vs(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Is=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var nv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var rv=new Yt(3e4,6e4);function Sf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function As(o,a,u,l){return b(this,arguments,function*(n,e,t,r,i={}){return bf(n,i,()=>b(this,null,function*(){let f={},_={};r&&(e==="GET"?_=r:f={body:JSON.stringify(r)});let E=Ma(Object.assign({key:n.config.apiKey},_)).slice(1),S=yield n._getAdditionalHeaders();S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode);let D=Object.assign({method:e,headers:S},f);return Kd()||(D.referrerPolicy="no-referrer"),Is.fetch()(Rf(n,n.config.apiHost,t,E),D)}))})}function bf(n,e,t){return b(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},nv),e);try{let i=new ic(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw gs(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[l,f]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw gs(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw gs(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw gs(n,"user-disabled",a);let _=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Af(n,_,f);pf(n,_)}}catch(i){if(i instanceof $e)throw i;pf(n,"network-request-failed",{message:String(i)})}})}function Rf(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?tv(n.config,i):`${n.config.apiScheme}://${i}`}var ic=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dc(this.auth,"network-request-failed")),rv.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function gs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=dc(n,e,r);return i.customData._tokenResponse=t,i}function iv(n,e){return b(this,null,function*(){return As(n,"POST","/v1/accounts:delete",e)})}function Cf(n,e){return b(this,null,function*(){return As(n,"POST","/v1/accounts:lookup",e)})}function Yr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function pc(n,e=!1){return b(this,null,function*(){let t=Ze(n),r=yield t.getIdToken(e),i=Pf(r);W(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Yr(nc(i.auth_time)),issuedAtTime:Yr(nc(i.iat)),expirationTime:Yr(nc(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function nc(n){return Number(n)*1e3}function Pf(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ms("JWT malformed, contained fewer than 3 sections"),null;try{let i=Oa(t);return i?JSON.parse(i):(ms("Failed to decode base64 JWT payload"),null)}catch(i){return ms("Caught error parsing JWT payload as JSON",i?.toString()),null}}function mf(n){let e=Pf(n);return W(e,"internal-error"),W(typeof e.exp<"u","internal-error"),W(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function sc(n,e,t=!1){return b(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof $e&&sv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function sv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var oc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>b(this,null,function*(){yield this.iteration()}),t)}iteration(){return b(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Zr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yr(this.lastLoginAt),this.creationTime=Yr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ws(n){return b(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield sc(n,Cf(t,{idToken:r}));W(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Df(o.providerUserInfo):[],u=ov(n.providerData,a),l=n.isAnonymous,f=!(n.email&&o.passwordHash)&&!u?.length,_=l?f:!1,E={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Zr(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(n,E)})}function gc(n){return b(this,null,function*(){let e=Ze(n);yield ws(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function ov(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Df(n){return n.map(e=>{var{providerId:t}=e,r=xo(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function av(n,e){return b(this,null,function*(){let t=yield bf(n,{},()=>b(this,null,function*(){let r=Ma({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=Rf(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Is.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function cv(n,e){return b(this,null,function*(){return As(n,"POST","/v2/accounts:revokeToken",Sf(n,e))})}var Xr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){W(e.idToken,"internal-error"),W(typeof e.idToken<"u","internal-error"),W(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){W(e.length!==0,"internal-error");let t=mf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return b(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(W(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return b(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield av(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(W(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(W(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(W(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Jr("not implemented")}};function Ot(n,e){W(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ei=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=xo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new oc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Zr(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return b(this,null,function*(){let t=yield sc(this,this.stsTokenManager.getToken(this.auth,e));return W(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return pc(this,e)}reload(){return gc(this)}_assign(e){this!==e&&(W(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){W(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return b(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield ws(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return b(this,null,function*(){if(Dn(this.auth.app))return Promise.reject(_s(this.auth));let e=yield this.getIdToken();return yield sc(this,iv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,l,f,_;let E=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(i=t.email)!==null&&i!==void 0?i:void 0,D=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,k=(a=t.photoURL)!==null&&a!==void 0?a:void 0,V=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,G=(f=t.createdAt)!==null&&f!==void 0?f:void 0,Q=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:K,emailVerified:ae,isAnonymous:He,providerData:ue,stsTokenManager:I}=t;W(K&&I,e,"internal-error");let p=Xr.fromJSON(this.name,I);W(typeof K=="string",e,"internal-error"),Ot(E,e.name),Ot(S,e.name),W(typeof ae=="boolean",e,"internal-error"),W(typeof He=="boolean",e,"internal-error"),Ot(D,e.name),Ot(k,e.name),Ot(V,e.name),Ot(N,e.name),Ot(G,e.name),Ot(Q,e.name);let m=new n({uid:K,auth:e,email:S,emailVerified:ae,displayName:E,isAnonymous:He,photoURL:k,phoneNumber:D,tenantId:V,stsTokenManager:p,createdAt:G,lastLoginAt:Q});return ue&&Array.isArray(ue)&&(m.providerData=ue.map(y=>Object.assign({},y))),N&&(m._redirectEventId=N),m}static _fromIdTokenResponse(e,t,r=!1){return b(this,null,function*(){let i=new Xr;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield ws(o),o})}static _fromGetAccountInfoResponse(e,t,r){return b(this,null,function*(){let i=t.users[0];W(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Df(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new Xr;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(l,f),l})}};var _f=new Map;function Jt(n){vs(n instanceof Function,"Expected a class definition");let e=_f.get(n);return e?(vs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,_f.set(n,e),e)}var uv=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return b(this,null,function*(){return!0})}_set(t,r){return b(this,null,function*(){this.storage[t]=r})}_get(t){return b(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return b(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ac=uv;function rc(n,e,t){return`firebase:${n}:${e}:${t}`}var Es=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=rc(this.userKey,i.apiKey,o),this.fullPersistenceKey=rc("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return b(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ei._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return b(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return b(this,null,function*(){if(!t.length)return new n(Jt(ac),e,r);let i=(yield Promise.all(t.map(f=>b(this,null,function*(){if(yield f._isAvailable())return f})))).filter(f=>f),o=i[0]||Jt(ac),a=rc(r,e.config.apiKey,e.name),u=null;for(let f of t)try{let _=yield f._get(a);if(_){let E=ei._fromJSON(e,_);f!==o&&(u=E),o=f;break}}catch{}let l=i.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new n(o,e,r):(o=l[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(f=>b(this,null,function*(){if(f!==o)try{yield f._remove(a)}catch{}}))),new n(o,e,r))})}};function yf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gv(e))return"Blackberry";if(mv(e))return"Webos";if(hv(e))return"Safari";if((e.includes("chrome/")||dv(e))&&!e.includes("edge/"))return"Chrome";if(pv(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function lv(n=Ve()){return/firefox\//i.test(n)}function hv(n=Ve()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dv(n=Ve()){return/crios\//i.test(n)}function fv(n=Ve()){return/iemobile/i.test(n)}function pv(n=Ve()){return/android/i.test(n)}function gv(n=Ve()){return/blackberry/i.test(n)}function mv(n=Ve()){return/webos/i.test(n)}function kf(n,e=[]){let t;switch(n){case"Browser":t=yf(Ve());break;case"Worker":t=`${yf(Ve())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kn}/${r}`}var cc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let l=e(o);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return b(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function _v(t){return b(this,arguments,function*(n,e={}){return As(n,"GET","/v2/passwordPolicy",Sf(n,e))})}var yv=6,uc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:yv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsUppercaseLetter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(u=l.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var lc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ts(this),this.idTokenSubscription=new Ts(this),this.beforeStateQueue=new cc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Jt(t)),this._initializationPromise=this.queue(()=>b(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Es.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return b(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return b(this,null,function*(){try{let t=yield Cf(this,{idToken:e}),r=yield ei._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return b(this,null,function*(){var t;if(Dn(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===u)&&l?.user&&(i=l.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return W(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return b(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return b(this,null,function*(){try{yield ws(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=ev()}_delete(){return b(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return b(this,null,function*(){if(Dn(this.app))return Promise.reject(_s(this));let t=e?Ze(e):null;return t&&W(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return b(this,null,function*(){if(!this._deleted)return e&&W(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>b(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return b(this,null,function*(){return Dn(this.app)?Promise.reject(_s(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Dn(this.app)?Promise.reject(_s(this)):this.queue(()=>b(this,null,function*(){yield this.assertedPersistence.setPersistence(Jt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return b(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return b(this,null,function*(){let e=yield _v(this),t=new uc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return b(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield cv(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return b(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return b(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Jt(e)||this._popupRedirectResolver;W(t,this,"argument-error"),this.redirectPersistenceManager=yield Es.create(this,[Jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return b(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>b(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return b(this,null,function*(){if(e===this.currentUser)return this.queue(()=>b(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(W(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return b(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return W(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return b(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return b(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Yy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function vv(n){return Ze(n)}var Ts=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xd(t=>this.observer=t)}get next(){return W(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Iv={loadJS(){return b(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wv(n){Iv=n}function Ev(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Tv(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Jt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var PT=Ev("rcb"),DT=new Yt(3e4,6e4);var kT=new Yt(2e3,1e4);var NT=10*60*1e3;var OT=new Yt(3e4,6e4);var xT=new Yt(5e3,15e3);var VT=encodeURIComponent("fac");var vf="@firebase/auth",If="1.7.9";var hc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return b(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){W(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Av(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sv(n){kt(new qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;W(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kf(n)},f=new lc(r,i,o,l);return Tv(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),kt(new qe("auth-internal",e=>{let t=vv(e.getProvider("auth").getImmediate());return(r=>new hc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),de(vf,If,Av(n)),de(vf,If,"esm2017")}var bv=5*60,MT=zd("authIdTokenMaxAge")||bv;function Rv(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}wv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=dc("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",Rv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sv("Browser");var bI="auth";var Ss=class{constructor(){return Kr(bI)}};var Nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Of={};var mc,xf;(function(){var n;function e(I,p){function m(){}m.prototype=p.prototype,I.D=p.prototype,I.prototype=new m,I.prototype.constructor=I,I.C=function(y,v,T){for(var g=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)g[ot-2]=arguments[ot];return p.prototype[v].apply(y,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,p,m){m||(m=0);var y=Array(16);if(typeof p=="string")for(var v=0;16>v;++v)y[v]=p.charCodeAt(m++)|p.charCodeAt(m++)<<8|p.charCodeAt(m++)<<16|p.charCodeAt(m++)<<24;else for(v=0;16>v;++v)y[v]=p[m++]|p[m++]<<8|p[m++]<<16|p[m++]<<24;p=I.g[0],m=I.g[1],v=I.g[2];var T=I.g[3],g=p+(T^m&(v^T))+y[0]+3614090360&4294967295;p=m+(g<<7&4294967295|g>>>25),g=T+(v^p&(m^v))+y[1]+3905402710&4294967295,T=p+(g<<12&4294967295|g>>>20),g=v+(m^T&(p^m))+y[2]+606105819&4294967295,v=T+(g<<17&4294967295|g>>>15),g=m+(p^v&(T^p))+y[3]+3250441966&4294967295,m=v+(g<<22&4294967295|g>>>10),g=p+(T^m&(v^T))+y[4]+4118548399&4294967295,p=m+(g<<7&4294967295|g>>>25),g=T+(v^p&(m^v))+y[5]+1200080426&4294967295,T=p+(g<<12&4294967295|g>>>20),g=v+(m^T&(p^m))+y[6]+2821735955&4294967295,v=T+(g<<17&4294967295|g>>>15),g=m+(p^v&(T^p))+y[7]+4249261313&4294967295,m=v+(g<<22&4294967295|g>>>10),g=p+(T^m&(v^T))+y[8]+1770035416&4294967295,p=m+(g<<7&4294967295|g>>>25),g=T+(v^p&(m^v))+y[9]+2336552879&4294967295,T=p+(g<<12&4294967295|g>>>20),g=v+(m^T&(p^m))+y[10]+4294925233&4294967295,v=T+(g<<17&4294967295|g>>>15),g=m+(p^v&(T^p))+y[11]+2304563134&4294967295,m=v+(g<<22&4294967295|g>>>10),g=p+(T^m&(v^T))+y[12]+1804603682&4294967295,p=m+(g<<7&4294967295|g>>>25),g=T+(v^p&(m^v))+y[13]+4254626195&4294967295,T=p+(g<<12&4294967295|g>>>20),g=v+(m^T&(p^m))+y[14]+2792965006&4294967295,v=T+(g<<17&4294967295|g>>>15),g=m+(p^v&(T^p))+y[15]+1236535329&4294967295,m=v+(g<<22&4294967295|g>>>10),g=p+(v^T&(m^v))+y[1]+4129170786&4294967295,p=m+(g<<5&4294967295|g>>>27),g=T+(m^v&(p^m))+y[6]+3225465664&4294967295,T=p+(g<<9&4294967295|g>>>23),g=v+(p^m&(T^p))+y[11]+643717713&4294967295,v=T+(g<<14&4294967295|g>>>18),g=m+(T^p&(v^T))+y[0]+3921069994&4294967295,m=v+(g<<20&4294967295|g>>>12),g=p+(v^T&(m^v))+y[5]+3593408605&4294967295,p=m+(g<<5&4294967295|g>>>27),g=T+(m^v&(p^m))+y[10]+38016083&4294967295,T=p+(g<<9&4294967295|g>>>23),g=v+(p^m&(T^p))+y[15]+3634488961&4294967295,v=T+(g<<14&4294967295|g>>>18),g=m+(T^p&(v^T))+y[4]+3889429448&4294967295,m=v+(g<<20&4294967295|g>>>12),g=p+(v^T&(m^v))+y[9]+568446438&4294967295,p=m+(g<<5&4294967295|g>>>27),g=T+(m^v&(p^m))+y[14]+3275163606&4294967295,T=p+(g<<9&4294967295|g>>>23),g=v+(p^m&(T^p))+y[3]+4107603335&4294967295,v=T+(g<<14&4294967295|g>>>18),g=m+(T^p&(v^T))+y[8]+1163531501&4294967295,m=v+(g<<20&4294967295|g>>>12),g=p+(v^T&(m^v))+y[13]+2850285829&4294967295,p=m+(g<<5&4294967295|g>>>27),g=T+(m^v&(p^m))+y[2]+4243563512&4294967295,T=p+(g<<9&4294967295|g>>>23),g=v+(p^m&(T^p))+y[7]+1735328473&4294967295,v=T+(g<<14&4294967295|g>>>18),g=m+(T^p&(v^T))+y[12]+2368359562&4294967295,m=v+(g<<20&4294967295|g>>>12),g=p+(m^v^T)+y[5]+4294588738&4294967295,p=m+(g<<4&4294967295|g>>>28),g=T+(p^m^v)+y[8]+2272392833&4294967295,T=p+(g<<11&4294967295|g>>>21),g=v+(T^p^m)+y[11]+1839030562&4294967295,v=T+(g<<16&4294967295|g>>>16),g=m+(v^T^p)+y[14]+4259657740&4294967295,m=v+(g<<23&4294967295|g>>>9),g=p+(m^v^T)+y[1]+2763975236&4294967295,p=m+(g<<4&4294967295|g>>>28),g=T+(p^m^v)+y[4]+1272893353&4294967295,T=p+(g<<11&4294967295|g>>>21),g=v+(T^p^m)+y[7]+4139469664&4294967295,v=T+(g<<16&4294967295|g>>>16),g=m+(v^T^p)+y[10]+3200236656&4294967295,m=v+(g<<23&4294967295|g>>>9),g=p+(m^v^T)+y[13]+681279174&4294967295,p=m+(g<<4&4294967295|g>>>28),g=T+(p^m^v)+y[0]+3936430074&4294967295,T=p+(g<<11&4294967295|g>>>21),g=v+(T^p^m)+y[3]+3572445317&4294967295,v=T+(g<<16&4294967295|g>>>16),g=m+(v^T^p)+y[6]+76029189&4294967295,m=v+(g<<23&4294967295|g>>>9),g=p+(m^v^T)+y[9]+3654602809&4294967295,p=m+(g<<4&4294967295|g>>>28),g=T+(p^m^v)+y[12]+3873151461&4294967295,T=p+(g<<11&4294967295|g>>>21),g=v+(T^p^m)+y[15]+530742520&4294967295,v=T+(g<<16&4294967295|g>>>16),g=m+(v^T^p)+y[2]+3299628645&4294967295,m=v+(g<<23&4294967295|g>>>9),g=p+(v^(m|~T))+y[0]+4096336452&4294967295,p=m+(g<<6&4294967295|g>>>26),g=T+(m^(p|~v))+y[7]+1126891415&4294967295,T=p+(g<<10&4294967295|g>>>22),g=v+(p^(T|~m))+y[14]+2878612391&4294967295,v=T+(g<<15&4294967295|g>>>17),g=m+(T^(v|~p))+y[5]+4237533241&4294967295,m=v+(g<<21&4294967295|g>>>11),g=p+(v^(m|~T))+y[12]+1700485571&4294967295,p=m+(g<<6&4294967295|g>>>26),g=T+(m^(p|~v))+y[3]+2399980690&4294967295,T=p+(g<<10&4294967295|g>>>22),g=v+(p^(T|~m))+y[10]+4293915773&4294967295,v=T+(g<<15&4294967295|g>>>17),g=m+(T^(v|~p))+y[1]+2240044497&4294967295,m=v+(g<<21&4294967295|g>>>11),g=p+(v^(m|~T))+y[8]+1873313359&4294967295,p=m+(g<<6&4294967295|g>>>26),g=T+(m^(p|~v))+y[15]+4264355552&4294967295,T=p+(g<<10&4294967295|g>>>22),g=v+(p^(T|~m))+y[6]+2734768916&4294967295,v=T+(g<<15&4294967295|g>>>17),g=m+(T^(v|~p))+y[13]+1309151649&4294967295,m=v+(g<<21&4294967295|g>>>11),g=p+(v^(m|~T))+y[4]+4149444226&4294967295,p=m+(g<<6&4294967295|g>>>26),g=T+(m^(p|~v))+y[11]+3174756917&4294967295,T=p+(g<<10&4294967295|g>>>22),g=v+(p^(T|~m))+y[2]+718787259&4294967295,v=T+(g<<15&4294967295|g>>>17),g=m+(T^(v|~p))+y[9]+3951481745&4294967295,I.g[0]=I.g[0]+p&4294967295,I.g[1]=I.g[1]+(v+(g<<21&4294967295|g>>>11))&4294967295,I.g[2]=I.g[2]+v&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,p){p===void 0&&(p=I.length);for(var m=p-this.blockSize,y=this.B,v=this.h,T=0;T<p;){if(v==0)for(;T<=m;)i(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<p;)if(y[v++]=I.charCodeAt(T++),v==this.blockSize){i(this,y),v=0;break}}else for(;T<p;)if(y[v++]=I[T++],v==this.blockSize){i(this,y),v=0;break}}this.h=v,this.o+=p},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var p=1;p<I.length-8;++p)I[p]=0;var m=8*this.o;for(p=I.length-8;p<I.length;++p)I[p]=m&255,m/=256;for(this.u(I),I=Array(16),p=m=0;4>p;++p)for(var y=0;32>y;y+=8)I[m++]=this.g[p]>>>y&255;return I};function o(I,p){var m=u;return Object.prototype.hasOwnProperty.call(m,I)?m[I]:m[I]=p(I)}function a(I,p){this.h=p;for(var m=[],y=!0,v=I.length-1;0<=v;v--){var T=I[v]|0;y&&T==p||(m[v]=T,y=!1)}this.g=m}var u={};function l(I){return-128<=I&&128>I?o(I,function(p){return new a([p|0],0>p?-1:0)}):new a([I|0],0>I?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return E;if(0>I)return N(f(-I));for(var p=[],m=1,y=0;I>=m;y++)p[y]=I/m|0,m*=4294967296;return new a(p,0)}function _(I,p){if(I.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(I.charAt(0)=="-")return N(_(I.substring(1),p));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=f(Math.pow(p,8)),y=E,v=0;v<I.length;v+=8){var T=Math.min(8,I.length-v),g=parseInt(I.substring(v,v+T),p);8>T?(T=f(Math.pow(p,T)),y=y.j(T).add(f(g))):(y=y.j(m),y=y.add(f(g)))}return y}var E=l(0),S=l(1),D=l(16777216);n=a.prototype,n.m=function(){if(V(this))return-N(this).m();for(var I=0,p=1,m=0;m<this.g.length;m++){var y=this.i(m);I+=(0<=y?y:4294967296+y)*p,p*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k(this))return"0";if(V(this))return"-"+N(this).toString(I);for(var p=f(Math.pow(I,6)),m=this,y="";;){var v=ae(m,p).g;m=G(m,v.j(p));var T=((0<m.g.length?m.g[0]:m.h)>>>0).toString(I);if(m=v,k(m))return T+y;for(;6>T.length;)T="0"+T;y=T+y}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function k(I){if(I.h!=0)return!1;for(var p=0;p<I.g.length;p++)if(I.g[p]!=0)return!1;return!0}function V(I){return I.h==-1}n.l=function(I){return I=G(this,I),V(I)?-1:k(I)?0:1};function N(I){for(var p=I.g.length,m=[],y=0;y<p;y++)m[y]=~I.g[y];return new a(m,~I.h).add(S)}n.abs=function(){return V(this)?N(this):this},n.add=function(I){for(var p=Math.max(this.g.length,I.g.length),m=[],y=0,v=0;v<=p;v++){var T=y+(this.i(v)&65535)+(I.i(v)&65535),g=(T>>>16)+(this.i(v)>>>16)+(I.i(v)>>>16);y=g>>>16,T&=65535,g&=65535,m[v]=g<<16|T}return new a(m,m[m.length-1]&-2147483648?-1:0)};function G(I,p){return I.add(N(p))}n.j=function(I){if(k(this)||k(I))return E;if(V(this))return V(I)?N(this).j(N(I)):N(N(this).j(I));if(V(I))return N(this.j(N(I)));if(0>this.l(D)&&0>I.l(D))return f(this.m()*I.m());for(var p=this.g.length+I.g.length,m=[],y=0;y<2*p;y++)m[y]=0;for(y=0;y<this.g.length;y++)for(var v=0;v<I.g.length;v++){var T=this.i(y)>>>16,g=this.i(y)&65535,ot=I.i(v)>>>16,Yn=I.i(v)&65535;m[2*y+2*v]+=g*Yn,Q(m,2*y+2*v),m[2*y+2*v+1]+=T*Yn,Q(m,2*y+2*v+1),m[2*y+2*v+1]+=g*ot,Q(m,2*y+2*v+1),m[2*y+2*v+2]+=T*ot,Q(m,2*y+2*v+2)}for(y=0;y<p;y++)m[y]=m[2*y+1]<<16|m[2*y];for(y=p;y<2*p;y++)m[y]=0;return new a(m,0)};function Q(I,p){for(;(I[p]&65535)!=I[p];)I[p+1]+=I[p]>>>16,I[p]&=65535,p++}function K(I,p){this.g=I,this.h=p}function ae(I,p){if(k(p))throw Error("division by zero");if(k(I))return new K(E,E);if(V(I))return p=ae(N(I),p),new K(N(p.g),N(p.h));if(V(p))return p=ae(I,N(p)),new K(N(p.g),p.h);if(30<I.g.length){if(V(I)||V(p))throw Error("slowDivide_ only works with positive integers.");for(var m=S,y=p;0>=y.l(I);)m=He(m),y=He(y);var v=ue(m,1),T=ue(y,1);for(y=ue(y,2),m=ue(m,2);!k(y);){var g=T.add(y);0>=g.l(I)&&(v=v.add(m),T=g),y=ue(y,1),m=ue(m,1)}return p=G(I,v.j(p)),new K(v,p)}for(v=E;0<=I.l(p);){for(m=Math.max(1,Math.floor(I.m()/p.m())),y=Math.ceil(Math.log(m)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),T=f(m),g=T.j(p);V(g)||0<g.l(I);)m-=y,T=f(m),g=T.j(p);k(T)&&(T=S),v=v.add(T),I=G(I,g)}return new K(v,I)}n.A=function(I){return ae(this,I).h},n.and=function(I){for(var p=Math.max(this.g.length,I.g.length),m=[],y=0;y<p;y++)m[y]=this.i(y)&I.i(y);return new a(m,this.h&I.h)},n.or=function(I){for(var p=Math.max(this.g.length,I.g.length),m=[],y=0;y<p;y++)m[y]=this.i(y)|I.i(y);return new a(m,this.h|I.h)},n.xor=function(I){for(var p=Math.max(this.g.length,I.g.length),m=[],y=0;y<p;y++)m[y]=this.i(y)^I.i(y);return new a(m,this.h^I.h)};function He(I){for(var p=I.g.length+1,m=[],y=0;y<p;y++)m[y]=I.i(y)<<1|I.i(y-1)>>>31;return new a(m,I.h)}function ue(I,p){var m=p>>5;p%=32;for(var y=I.g.length-m,v=[],T=0;T<y;T++)v[T]=0<p?I.i(T+m)>>>p|I.i(T+m+1)<<32-p:I.i(T+m);return new a(v,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xf=Of.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=_,mc=Of.Integer=a}).apply(typeof Nf<"u"?Nf:typeof self<"u"?self:typeof window<"u"?window:{});var bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pt={};var _c,RI,xn,yc,ti,Rs,vc,Ic,wc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,h){return s==Array.prototype||s==Object.prototype||(s[c]=h.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof bs=="object"&&bs];for(var c=0;c<s.length;++c){var h=s[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var h=r;s=s.split(".");for(var d=0;d<s.length-1;d++){var w=s[d];if(!(w in h))break e;h=h[w]}s=s[s.length-1],d=h[s],c=c(d),c!=d&&c!=null&&e(h,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var h=0,d=!1,w={next:function(){if(!d&&h<s.length){var A=h++;return{value:c(A,s[A]),done:!1}}return d=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,h){return h})}});var a=a||{},u=this||self;function l(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function f(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function _(s,c,h){return s.call.apply(s.bind,arguments)}function E(s,c,h){if(!s)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,d),s.apply(c,w)}}return function(){return s.apply(c,arguments)}}function S(s,c,h){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:E,S.apply(null,arguments)}function D(s,c){var h=Array.prototype.slice.call(arguments,1);return function(){var d=h.slice();return d.push.apply(d,arguments),s.apply(this,d)}}function k(s,c){function h(){}h.prototype=c.prototype,s.aa=c.prototype,s.prototype=new h,s.prototype.constructor=s,s.Qb=function(d,w,A){for(var P=Array(arguments.length-2),J=2;J<arguments.length;J++)P[J-2]=arguments[J];return c.prototype[w].apply(d,P)}}function V(s){let c=s.length;if(0<c){let h=Array(c);for(let d=0;d<c;d++)h[d]=s[d];return h}return[]}function N(s,c){for(let h=1;h<arguments.length;h++){let d=arguments[h];if(l(d)){let w=s.length||0,A=d.length||0;s.length=w+A;for(let P=0;P<A;P++)s[w+P]=d[P]}else s.push(d)}}class G{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function Q(s){return/^[\s\xa0]*$/.test(s)}function K(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ae(s){return ae[" "](s),s}ae[" "]=function(){};var He=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function ue(s,c,h){for(let d in s)c.call(h,s[d],d,s)}function I(s,c){for(let h in s)c.call(void 0,s[h],h,s)}function p(s){let c={};for(let h in s)c[h]=s[h];return c}let m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(s,c){let h,d;for(let w=1;w<arguments.length;w++){d=arguments[w];for(h in d)s[h]=d[h];for(let A=0;A<m.length;A++)h=m[A],Object.prototype.hasOwnProperty.call(d,h)&&(s[h]=d[h])}}function v(s){var c=1;s=s.split(":");let h=[];for(;0<c&&s.length;)h.push(s.shift()),c--;return s.length&&h.push(s.join(":")),h}function T(s){u.setTimeout(()=>{throw s},0)}function g(){var s=so;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ot{constructor(){this.h=this.g=null}add(c,h){let d=Yn.get();d.set(c,h),this.h?this.h.next=d:this.g=d,this.h=d}}var Yn=new G(()=>new Qp,s=>s.reset());class Qp{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Xn,Zn=!1,so=new ot,tl=()=>{let s=u.Promise.resolve(void 0);Xn=()=>{s.then(Jp)}};var Jp=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(h){T(h)}var c=Yn;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Zn=!1};function vt(){this.s=this.s,this.C=this.C}vt.prototype.s=!1,vt.prototype.ma=function(){this.s||(this.s=!0,this.N())},vt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ye(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var Yp=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let h=()=>{};u.addEventListener("test",h,c),u.removeEventListener("test",h,c)}catch{}return s}();function er(s,c){if(ye.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var h=this.type=s.type,d=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(He){e:{try{ae(c.nodeName);var w=!0;break e}catch{}w=!1}w||(c=null)}}else h=="mouseover"?c=s.fromElement:h=="mouseout"&&(c=s.toElement);this.relatedTarget=c,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Xp[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&er.aa.h.call(this)}}k(er,ye);var Xp={2:"touch",3:"pen",4:"mouse"};er.prototype.h=function(){er.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var tr="closure_listenable_"+(1e6*Math.random()|0),Zp=0;function eg(s,c,h,d,w){this.listener=s,this.proxy=null,this.src=c,this.type=h,this.capture=!!d,this.ha=w,this.key=++Zp,this.da=this.fa=!1}function vi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Ii(s){this.src=s,this.g={},this.h=0}Ii.prototype.add=function(s,c,h,d,w){var A=s.toString();s=this.g[A],s||(s=this.g[A]=[],this.h++);var P=ao(s,c,d,w);return-1<P?(c=s[P],h||(c.fa=!1)):(c=new eg(c,this.src,A,!!d,w),c.fa=h,s.push(c)),c};function oo(s,c){var h=c.type;if(h in s.g){var d=s.g[h],w=Array.prototype.indexOf.call(d,c,void 0),A;(A=0<=w)&&Array.prototype.splice.call(d,w,1),A&&(vi(c),s.g[h].length==0&&(delete s.g[h],s.h--))}}function ao(s,c,h,d){for(var w=0;w<s.length;++w){var A=s[w];if(!A.da&&A.listener==c&&A.capture==!!h&&A.ha==d)return w}return-1}var co="closure_lm_"+(1e6*Math.random()|0),uo={};function nl(s,c,h,d,w){if(d&&d.once)return il(s,c,h,d,w);if(Array.isArray(c)){for(var A=0;A<c.length;A++)nl(s,c[A],h,d,w);return null}return h=po(h),s&&s[tr]?s.K(c,h,f(d)?!!d.capture:!!d,w):rl(s,c,h,!1,d,w)}function rl(s,c,h,d,w,A){if(!c)throw Error("Invalid event type");var P=f(w)?!!w.capture:!!w,J=ho(s);if(J||(s[co]=J=new Ii(s)),h=J.add(c,h,d,P,A),h.proxy)return h;if(d=tg(),h.proxy=d,d.src=s,d.listener=h,s.addEventListener)Yp||(w=P),w===void 0&&(w=!1),s.addEventListener(c.toString(),d,w);else if(s.attachEvent)s.attachEvent(ol(c.toString()),d);else if(s.addListener&&s.removeListener)s.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return h}function tg(){function s(h){return c.call(s.src,s.listener,h)}let c=ng;return s}function il(s,c,h,d,w){if(Array.isArray(c)){for(var A=0;A<c.length;A++)il(s,c[A],h,d,w);return null}return h=po(h),s&&s[tr]?s.L(c,h,f(d)?!!d.capture:!!d,w):rl(s,c,h,!0,d,w)}function sl(s,c,h,d,w){if(Array.isArray(c))for(var A=0;A<c.length;A++)sl(s,c[A],h,d,w);else d=f(d)?!!d.capture:!!d,h=po(h),s&&s[tr]?(s=s.i,c=String(c).toString(),c in s.g&&(A=s.g[c],h=ao(A,h,d,w),-1<h&&(vi(A[h]),Array.prototype.splice.call(A,h,1),A.length==0&&(delete s.g[c],s.h--)))):s&&(s=ho(s))&&(c=s.g[c.toString()],s=-1,c&&(s=ao(c,h,d,w)),(h=-1<s?c[s]:null)&&lo(h))}function lo(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[tr])oo(c.i,s);else{var h=s.type,d=s.proxy;c.removeEventListener?c.removeEventListener(h,d,s.capture):c.detachEvent?c.detachEvent(ol(h),d):c.addListener&&c.removeListener&&c.removeListener(d),(h=ho(c))?(oo(h,s),h.h==0&&(h.src=null,c[co]=null)):vi(s)}}}function ol(s){return s in uo?uo[s]:uo[s]="on"+s}function ng(s,c){if(s.da)s=!0;else{c=new er(c,this);var h=s.listener,d=s.ha||s.src;s.fa&&lo(s),s=h.call(d,c)}return s}function ho(s){return s=s[co],s instanceof Ii?s:null}var fo="__closure_events_fn_"+(1e9*Math.random()>>>0);function po(s){return typeof s=="function"?s:(s[fo]||(s[fo]=function(c){return s.handleEvent(c)}),s[fo])}function ve(){vt.call(this),this.i=new Ii(this),this.M=this,this.F=null}k(ve,vt),ve.prototype[tr]=!0,ve.prototype.removeEventListener=function(s,c,h,d){sl(this,s,c,h,d)};function Se(s,c){var h,d=s.F;if(d)for(h=[];d;d=d.F)h.push(d);if(s=s.M,d=c.type||c,typeof c=="string")c=new ye(c,s);else if(c instanceof ye)c.target=c.target||s;else{var w=c;c=new ye(d,s),y(c,w)}if(w=!0,h)for(var A=h.length-1;0<=A;A--){var P=c.g=h[A];w=wi(P,d,!0,c)&&w}if(P=c.g=s,w=wi(P,d,!0,c)&&w,w=wi(P,d,!1,c)&&w,h)for(A=0;A<h.length;A++)P=c.g=h[A],w=wi(P,d,!1,c)&&w}ve.prototype.N=function(){if(ve.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var h=s.g[c],d=0;d<h.length;d++)vi(h[d]);delete s.g[c],s.h--}}this.F=null},ve.prototype.K=function(s,c,h,d){return this.i.add(String(s),c,!1,h,d)},ve.prototype.L=function(s,c,h,d){return this.i.add(String(s),c,!0,h,d)};function wi(s,c,h,d){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var w=!0,A=0;A<c.length;++A){var P=c[A];if(P&&!P.da&&P.capture==h){var J=P.listener,me=P.ha||P.src;P.fa&&oo(s.i,P),w=J.call(me,d)!==!1&&w}}return w&&!d.defaultPrevented}function al(s,c,h){if(typeof s=="function")h&&(s=S(s,h));else if(s&&typeof s.handleEvent=="function")s=S(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function cl(s){s.g=al(()=>{s.g=null,s.i&&(s.i=!1,cl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class rg extends vt{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:cl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nr(s){vt.call(this),this.h=s,this.g={}}k(nr,vt);var ul=[];function ll(s){ue(s.g,function(c,h){this.g.hasOwnProperty(h)&&lo(c)},s),s.g={}}nr.prototype.N=function(){nr.aa.N.call(this),ll(this)},nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var go=u.JSON.stringify,ig=u.JSON.parse,sg=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function mo(){}mo.prototype.h=null;function hl(s){return s.h||(s.h=s.i())}function dl(){}var rr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _o(){ye.call(this,"d")}k(_o,ye);function yo(){ye.call(this,"c")}k(yo,ye);var Ft={},fl=null;function Ei(){return fl=fl||new ve}Ft.La="serverreachability";function pl(s){ye.call(this,Ft.La,s)}k(pl,ye);function ir(s){let c=Ei();Se(c,new pl(c))}Ft.STAT_EVENT="statevent";function gl(s,c){ye.call(this,Ft.STAT_EVENT,s),this.stat=c}k(gl,ye);function be(s){let c=Ei();Se(c,new gl(c,s))}Ft.Ma="timingevent";function ml(s,c){ye.call(this,Ft.Ma,s),this.size=c}k(ml,ye);function sr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function or(){this.g=!0}or.prototype.xa=function(){this.g=!1};function og(s,c,h,d,w,A){s.info(function(){if(s.g)if(A)for(var P="",J=A.split("&"),me=0;me<J.length;me++){var z=J[me].split("=");if(1<z.length){var Ie=z[0];z=z[1];var we=Ie.split("_");P=2<=we.length&&we[1]=="type"?P+(Ie+"="+z+"&"):P+(Ie+"=redacted&")}}else P=null;else P=A;return"XMLHTTP REQ ("+d+") [attempt "+w+"]: "+c+`
`+h+`
`+P})}function ag(s,c,h,d,w,A,P){s.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+w+"]: "+c+`
`+h+`
`+A+" "+P})}function un(s,c,h,d){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+ug(s,h)+(d?" "+d:"")})}function cg(s,c){s.info(function(){return"TIMEOUT: "+c})}or.prototype.info=function(){};function ug(s,c){if(!s.g)return c;if(!c)return null;try{var h=JSON.parse(c);if(h){for(s=0;s<h.length;s++)if(Array.isArray(h[s])){var d=h[s];if(!(2>d.length)){var w=d[1];if(Array.isArray(w)&&!(1>w.length)){var A=w[0];if(A!="noop"&&A!="stop"&&A!="close")for(var P=1;P<w.length;P++)w[P]=""}}}}return go(h)}catch{return c}}var Ti={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_l={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vo;function Ai(){}k(Ai,mo),Ai.prototype.g=function(){return new XMLHttpRequest},Ai.prototype.i=function(){return{}},vo=new Ai;function It(s,c,h,d){this.j=s,this.i=c,this.l=h,this.R=d||1,this.U=new nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yl}function yl(){this.i=null,this.g="",this.h=!1}var vl={},Io={};function wo(s,c,h){s.L=1,s.v=Ci(at(c)),s.m=h,s.P=!0,Il(s,null)}function Il(s,c){s.F=Date.now(),Si(s),s.A=at(s.v);var h=s.A,d=s.R;Array.isArray(d)||(d=[String(d)]),xl(h.i,"t",d),s.C=0,h=s.j.J,s.h=new yl,s.g=Xl(s.j,h?c:null,!s.m),0<s.O&&(s.M=new rg(S(s.Y,s,s.g),s.O)),c=s.U,h=s.g,d=s.ca;var w="readystatechange";Array.isArray(w)||(w&&(ul[0]=w.toString()),w=ul);for(var A=0;A<w.length;A++){var P=nl(h,w[A],d||c.handleEvent,!1,c.h||c);if(!P)break;c.g[P.key]=P}c=s.H?p(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),ir(),og(s.i,s.u,s.A,s.l,s.R,s.m)}It.prototype.ca=function(s){s=s.target;let c=this.M;c&&ct(s)==3?c.j():this.Y(s)},It.prototype.Y=function(s){try{if(s==this.g)e:{let we=ct(this.g);var c=this.g.Ba();let dn=this.g.Z();if(!(3>we)&&(we!=3||this.g&&(this.h.h||this.g.oa()||ql(this.g)))){this.J||we!=4||c==7||(c==8||0>=dn?ir(3):ir(2)),Eo(this);var h=this.g.Z();this.X=h;t:if(wl(this)){var d=ql(this.g);s="";var w=d.length,A=ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ut(this),ar(this);var P="";break t}this.h.i=new u.TextDecoder}for(c=0;c<w;c++)this.h.h=!0,s+=this.h.i.decode(d[c],{stream:!(A&&c==w-1)});d.length=0,this.h.g+=s,this.C=0,P=this.h.g}else P=this.g.oa();if(this.o=h==200,ag(this.i,this.u,this.A,this.l,this.R,we,h),this.o){if(this.T&&!this.K){t:{if(this.g){var J,me=this.g;if((J=me.g?me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(J)){var z=J;break t}}z=null}if(h=z)un(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,To(this,h);else{this.o=!1,this.s=3,be(12),Ut(this),ar(this);break e}}if(this.P){h=!0;let Be;for(;!this.J&&this.C<P.length;)if(Be=lg(this,P),Be==Io){we==4&&(this.s=4,be(14),h=!1),un(this.i,this.l,null,"[Incomplete Response]");break}else if(Be==vl){this.s=4,be(15),un(this.i,this.l,P,"[Invalid Chunk]"),h=!1;break}else un(this.i,this.l,Be,null),To(this,Be);if(wl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),we!=4||P.length!=0||this.h.h||(this.s=1,be(16),h=!1),this.o=this.o&&h,!h)un(this.i,this.l,P,"[Invalid Chunked Response]"),Ut(this),ar(this);else if(0<P.length&&!this.W){this.W=!0;var Ie=this.j;Ie.g==this&&Ie.ba&&!Ie.M&&(Ie.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),Po(Ie),Ie.M=!0,be(11))}}else un(this.i,this.l,P,null),To(this,P);we==4&&Ut(this),this.o&&!this.J&&(we==4?Hl(this.j,this):(this.o=!1,Si(this)))}else Rg(this.g),h==400&&0<P.indexOf("Unknown SID")?(this.s=3,be(12)):(this.s=0,be(13)),Ut(this),ar(this)}}}catch{}finally{}};function wl(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function lg(s,c){var h=s.C,d=c.indexOf(`
`,h);return d==-1?Io:(h=Number(c.substring(h,d)),isNaN(h)?vl:(d+=1,d+h>c.length?Io:(c=c.slice(d,d+h),s.C=d+h,c)))}It.prototype.cancel=function(){this.J=!0,Ut(this)};function Si(s){s.S=Date.now()+s.I,El(s,s.I)}function El(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=sr(S(s.ba,s),c)}function Eo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}It.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(cg(this.i,this.A),this.L!=2&&(ir(),be(17)),Ut(this),this.s=2,ar(this)):El(this,this.S-s)};function ar(s){s.j.G==0||s.J||Hl(s.j,s)}function Ut(s){Eo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,ll(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function To(s,c){try{var h=s.j;if(h.G!=0&&(h.g==s||Ao(h.h,s))){if(!s.K&&Ao(h.h,s)&&h.G==3){try{var d=h.Da.g.parse(c)}catch{d=null}if(Array.isArray(d)&&d.length==3){var w=d;if(w[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<s.F)Oi(h),ki(h);else break e;Co(h),be(18)}}else h.za=w[1],0<h.za-h.T&&37500>w[2]&&h.F&&h.v==0&&!h.C&&(h.C=sr(S(h.Za,h),6e3));if(1>=Sl(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else qt(h,11)}else if((s.K||h.g==s)&&Oi(h),!Q(c))for(w=h.Da.g.parse(c),c=0;c<w.length;c++){let z=w[c];if(h.T=z[0],z=z[1],h.G==2)if(z[0]=="c"){h.K=z[1],h.ia=z[2];let Ie=z[3];Ie!=null&&(h.la=Ie,h.j.info("VER="+h.la));let we=z[4];we!=null&&(h.Aa=we,h.j.info("SVER="+h.Aa));let dn=z[5];dn!=null&&typeof dn=="number"&&0<dn&&(d=1.5*dn,h.L=d,h.j.info("backChannelRequestTimeoutMs_="+d)),d=h;let Be=s.g;if(Be){let Vi=Be.g?Be.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vi){var A=d.h;A.g||Vi.indexOf("spdy")==-1&&Vi.indexOf("quic")==-1&&Vi.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(So(A,A.h),A.h=null))}if(d.D){let Do=Be.g?Be.g.getResponseHeader("X-HTTP-Session-Id"):null;Do&&(d.ya=Do,ee(d.I,d.D,Do))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-s.F,h.j.info("Handshake RTT: "+h.R+"ms")),d=h;var P=s;if(d.qa=Yl(d,d.J?d.ia:null,d.W),P.K){bl(d.h,P);var J=P,me=d.L;me&&(J.I=me),J.B&&(Eo(J),Si(J)),d.g=P}else Wl(d);0<h.i.length&&Ni(h)}else z[0]!="stop"&&z[0]!="close"||qt(h,7);else h.G==3&&(z[0]=="stop"||z[0]=="close"?z[0]=="stop"?qt(h,7):Ro(h):z[0]!="noop"&&h.l&&h.l.ta(z),h.v=0)}}ir(4)}catch{}}var hg=class{constructor(s,c){this.g=s,this.map=c}};function Tl(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Al(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Sl(s){return s.h?1:s.g?s.g.size:0}function Ao(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function So(s,c){s.g?s.g.add(c):s.h=c}function bl(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Tl.prototype.cancel=function(){if(this.i=Rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Rl(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let h of s.g.values())c=c.concat(h.D);return c}return V(s.i)}function dg(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(l(s)){for(var c=[],h=s.length,d=0;d<h;d++)c.push(s[d]);return c}c=[],h=0;for(d in s)c[h++]=s[d];return c}function fg(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(l(s)||typeof s=="string"){var c=[];s=s.length;for(var h=0;h<s;h++)c.push(h);return c}c=[],h=0;for(let d in s)c[h++]=d;return c}}}function Cl(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(l(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var h=fg(s),d=dg(s),w=d.length,A=0;A<w;A++)c.call(void 0,d[A],h&&h[A],s)}var Pl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pg(s,c){if(s){s=s.split("&");for(var h=0;h<s.length;h++){var d=s[h].indexOf("="),w=null;if(0<=d){var A=s[h].substring(0,d);w=s[h].substring(d+1)}else A=s[h];c(A,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function $t(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof $t){this.h=s.h,bi(this,s.j),this.o=s.o,this.g=s.g,Ri(this,s.s),this.l=s.l;var c=s.i,h=new lr;h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),Dl(this,h),this.m=s.m}else s&&(c=String(s).match(Pl))?(this.h=!1,bi(this,c[1]||"",!0),this.o=cr(c[2]||""),this.g=cr(c[3]||"",!0),Ri(this,c[4]),this.l=cr(c[5]||"",!0),Dl(this,c[6]||"",!0),this.m=cr(c[7]||"")):(this.h=!1,this.i=new lr(null,this.h))}$t.prototype.toString=function(){var s=[],c=this.j;c&&s.push(ur(c,kl,!0),":");var h=this.g;return(h||c=="file")&&(s.push("//"),(c=this.o)&&s.push(ur(c,kl,!0),"@"),s.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&s.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&s.push("/"),s.push(ur(h,h.charAt(0)=="/"?_g:mg,!0))),(h=this.i.toString())&&s.push("?",h),(h=this.m)&&s.push("#",ur(h,vg)),s.join("")};function at(s){return new $t(s)}function bi(s,c,h){s.j=h?cr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Ri(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Dl(s,c,h){c instanceof lr?(s.i=c,Ig(s.i,s.h)):(h||(c=ur(c,yg)),s.i=new lr(c,s.h))}function ee(s,c,h){s.i.set(c,h)}function Ci(s){return ee(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function cr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function ur(s,c,h){return typeof s=="string"?(s=encodeURI(s).replace(c,gg),h&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function gg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var kl=/[#\/\?@]/g,mg=/[#\?:]/g,_g=/[#\?]/g,yg=/[#\?@]/g,vg=/#/g;function lr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function wt(s){s.g||(s.g=new Map,s.h=0,s.i&&pg(s.i,function(c,h){s.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=lr.prototype,n.add=function(s,c){wt(this),this.i=null,s=ln(this,s);var h=this.g.get(s);return h||this.g.set(s,h=[]),h.push(c),this.h+=1,this};function Nl(s,c){wt(s),c=ln(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Ol(s,c){return wt(s),c=ln(s,c),s.g.has(c)}n.forEach=function(s,c){wt(this),this.g.forEach(function(h,d){h.forEach(function(w){s.call(c,w,d,this)},this)},this)},n.na=function(){wt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),h=[];for(let d=0;d<c.length;d++){let w=s[d];for(let A=0;A<w.length;A++)h.push(c[d])}return h},n.V=function(s){wt(this);let c=[];if(typeof s=="string")Ol(this,s)&&(c=c.concat(this.g.get(ln(this,s))));else{s=Array.from(this.g.values());for(let h=0;h<s.length;h++)c=c.concat(s[h])}return c},n.set=function(s,c){return wt(this),this.i=null,s=ln(this,s),Ol(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function xl(s,c,h){Nl(s,c),0<h.length&&(s.i=null,s.g.set(ln(s,c),V(h)),s.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var h=0;h<c.length;h++){var d=c[h];let A=encodeURIComponent(String(d)),P=this.V(d);for(d=0;d<P.length;d++){var w=A;P[d]!==""&&(w+="="+encodeURIComponent(String(P[d]))),s.push(w)}}return this.i=s.join("&")};function ln(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Ig(s,c){c&&!s.j&&(wt(s),s.i=null,s.g.forEach(function(h,d){var w=d.toLowerCase();d!=w&&(Nl(this,d),xl(this,w,h))},s)),s.j=c}function wg(s,c){let h=new or;if(u.Image){let d=new Image;d.onload=D(Et,h,"TestLoadImage: loaded",!0,c,d),d.onerror=D(Et,h,"TestLoadImage: error",!1,c,d),d.onabort=D(Et,h,"TestLoadImage: abort",!1,c,d),d.ontimeout=D(Et,h,"TestLoadImage: timeout",!1,c,d),u.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=s}else c(!1)}function Eg(s,c){let h=new or,d=new AbortController,w=setTimeout(()=>{d.abort(),Et(h,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:d.signal}).then(A=>{clearTimeout(w),A.ok?Et(h,"TestPingServer: ok",!0,c):Et(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(w),Et(h,"TestPingServer: error",!1,c)})}function Et(s,c,h,d,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),d(h)}catch{}}function Tg(){this.g=new sg}function Ag(s,c,h){let d=h||"";try{Cl(s,function(w,A){let P=w;f(w)&&(P=go(w)),c.push(d+A+"="+encodeURIComponent(P))})}catch(w){throw c.push(d+"type="+encodeURIComponent("_badmap")),w}}function hr(s){this.l=s.Ub||null,this.j=s.eb||!1}k(hr,mo),hr.prototype.g=function(){return new Pi(this.l,this.j)},hr.prototype.i=function(s){return function(){return s}}({});function Pi(s,c){ve.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Pi,ve),n=Pi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,fr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,fr(this)),this.g&&(this.readyState=3,fr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vl(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vl(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?dr(this):fr(this),this.readyState==3&&Vl(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,dr(this))},n.Qa=function(s){this.g&&(this.response=s,dr(this))},n.ga=function(){this.g&&dr(this)};function dr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,fr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,s.push(h[0]+": "+h[1]),h=c.next();return s.join(`\r
`)};function fr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Ml(s){let c="";return ue(s,function(h,d){c+=d,c+=":",c+=h,c+=`\r
`}),c}function bo(s,c,h){e:{for(d in h){var d=!1;break e}d=!0}d||(h=Ml(h),typeof s=="string"?h!=null&&encodeURIComponent(String(h)):ee(s,c,h))}function te(s){ve.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(te,ve);var Sg=/^https?$/i,bg=["POST","PUT"];n=te.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,h,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vo.g(),this.v=this.o?hl(this.o):hl(vo),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(A){Ll(this,A);return}if(s=h||"",h=new Map(this.headers),d)if(Object.getPrototypeOf(d)===Object.prototype)for(var w in d)h.set(w,d[w]);else if(typeof d.keys=="function"&&typeof d.get=="function")for(let A of d.keys())h.set(A,d.get(A));else throw Error("Unknown input type for opt_headers: "+String(d));d=Array.from(h.keys()).find(A=>A.toLowerCase()=="content-type"),w=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(bg,c,void 0))||d||w||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,P]of h)this.g.setRequestHeader(A,P);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$l(this),this.u=!0,this.g.send(s),this.u=!1}catch(A){Ll(this,A)}};function Ll(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,Fl(s),Di(s)}function Fl(s){s.A||(s.A=!0,Se(s,"complete"),Se(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Se(this,"complete"),Se(this,"abort"),Di(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Di(this,!0)),te.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ul(this):this.bb())},n.bb=function(){Ul(this)};function Ul(s){if(s.h&&typeof a<"u"&&(!s.v[1]||ct(s)!=4||s.Z()!=2)){if(s.u&&ct(s)==4)al(s.Ea,0,s);else if(Se(s,"readystatechange"),ct(s)==4){s.h=!1;try{let P=s.Z();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var d;if(d=P===0){var w=String(s.D).match(Pl)[1]||null;!w&&u.self&&u.self.location&&(w=u.self.location.protocol.slice(0,-1)),d=!Sg.test(w?w.toLowerCase():"")}h=d}if(h)Se(s,"complete"),Se(s,"success");else{s.m=6;try{var A=2<ct(s)?s.g.statusText:""}catch{A=""}s.l=A+" ["+s.Z()+"]",Fl(s)}}finally{Di(s)}}}}function Di(s,c){if(s.g){$l(s);let h=s.g,d=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Se(s,"ready");try{h.onreadystatechange=d}catch{}}}function $l(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function ct(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),ig(c)}};function ql(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Rg(s){let c={};s=(s.g&&2<=ct(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let d=0;d<s.length;d++){if(Q(s[d]))continue;var h=v(s[d]);let w=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let A=c[w]||[];c[w]=A,A.push(h)}I(c,function(d){return d.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pr(s,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[s]||c}function Bl(s){this.Aa=0,this.i=[],this.j=new or,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pr("baseRetryDelayMs",5e3,s),this.cb=pr("retryDelaySeedMs",1e4,s),this.Wa=pr("forwardChannelMaxRetries",2,s),this.wa=pr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Tl(s&&s.concurrentRequestLimit),this.Da=new Tg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Bl.prototype,n.la=8,n.G=1,n.connect=function(s,c,h,d){be(0),this.W=s,this.H=c||{},h&&d!==void 0&&(this.H.OSID=h,this.H.OAID=d),this.F=this.X,this.I=Yl(this,null,this.W),Ni(this)};function Ro(s){if(jl(s),s.G==3){var c=s.U++,h=at(s.I);if(ee(h,"SID",s.K),ee(h,"RID",c),ee(h,"TYPE","terminate"),gr(s,h),c=new It(s,s.j,c),c.L=2,c.v=Ci(at(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=c.v,h=!0),h||(c.g=Xl(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Si(c)}Jl(s)}function ki(s){s.g&&(Po(s),s.g.cancel(),s.g=null)}function jl(s){ki(s),s.u&&(u.clearTimeout(s.u),s.u=null),Oi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Ni(s){if(!Al(s.h)&&!s.s){s.s=!0;var c=s.Ga;Xn||tl(),Zn||(Xn(),Zn=!0),so.add(c,s),s.B=0}}function Cg(s,c){return Sl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=sr(S(s.Ga,s,c),Ql(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let w=new It(this,this.j,s),A=this.o;if(this.S&&(A?(A=p(A),y(A,this.S)):A=this.S),this.m!==null||this.O||(w.H=A,A=null),this.P)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var d=this.i[h];if("__data__"in d.map&&(d=d.map.__data__,typeof d=="string")){d=d.length;break t}d=void 0}if(d===void 0)break;if(c+=d,4096<c){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=Gl(this,w,c),h=at(this.I),ee(h,"RID",s),ee(h,"CVER",22),this.D&&ee(h,"X-HTTP-Session-Id",this.D),gr(this,h),A&&(this.O?c="headers="+encodeURIComponent(String(Ml(A)))+"&"+c:this.m&&bo(h,this.m,A)),So(this.h,w),this.Ua&&ee(h,"TYPE","init"),this.P?(ee(h,"$req",c),ee(h,"SID","null"),w.T=!0,wo(w,h,null)):wo(w,h,c),this.G=2}}else this.G==3&&(s?zl(this,s):this.i.length==0||Al(this.h)||zl(this))};function zl(s,c){var h;c?h=c.l:h=s.U++;let d=at(s.I);ee(d,"SID",s.K),ee(d,"RID",h),ee(d,"AID",s.T),gr(s,d),s.m&&s.o&&bo(d,s.m,s.o),h=new It(s,s.j,h,s.B+1),s.m===null&&(h.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Gl(s,h,1e3),h.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),So(s.h,h),wo(h,d,c)}function gr(s,c){s.H&&ue(s.H,function(h,d){ee(c,d,h)}),s.l&&Cl({},function(h,d){ee(c,d,h)})}function Gl(s,c,h){h=Math.min(s.i.length,h);var d=s.l?S(s.l.Na,s.l,s):null;e:{var w=s.i;let A=-1;for(;;){let P=["count="+h];A==-1?0<h?(A=w[0].g,P.push("ofs="+A)):A=0:P.push("ofs="+A);let J=!0;for(let me=0;me<h;me++){let z=w[me].g,Ie=w[me].map;if(z-=A,0>z)A=Math.max(0,w[me].g-100),J=!1;else try{Ag(Ie,P,"req"+z+"_")}catch{d&&d(Ie)}}if(J){d=P.join("&");break e}}}return s=s.i.splice(0,h),c.D=s,d}function Wl(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Xn||tl(),Zn||(Xn(),Zn=!0),so.add(c,s),s.v=0}}function Co(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=sr(S(s.Fa,s),Ql(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Kl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=sr(S(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,be(10),ki(this),Kl(this))};function Po(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Kl(s){s.g=new It(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=at(s.qa);ee(c,"RID","rpc"),ee(c,"SID",s.K),ee(c,"AID",s.T),ee(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&ee(c,"TO",s.ja),ee(c,"TYPE","xmlhttp"),gr(s,c),s.m&&s.o&&bo(c,s.m,s.o),s.L&&(s.g.I=s.L);var h=s.g;s=s.ia,h.L=1,h.v=Ci(at(c)),h.m=null,h.P=!0,Il(h,s)}n.Za=function(){this.C!=null&&(this.C=null,ki(this),Co(this),be(19))};function Oi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Hl(s,c){var h=null;if(s.g==c){Oi(s),Po(s),s.g=null;var d=2}else if(Ao(s.h,c))h=c.D,bl(s.h,c),d=1;else return;if(s.G!=0){if(c.o)if(d==1){h=c.m?c.m.length:0,c=Date.now()-c.F;var w=s.B;d=Ei(),Se(d,new ml(d,h)),Ni(s)}else Wl(s);else if(w=c.s,w==3||w==0&&0<c.X||!(d==1&&Cg(s,c)||d==2&&Co(s)))switch(h&&0<h.length&&(c=s.h,c.i=c.i.concat(h)),w){case 1:qt(s,5);break;case 4:qt(s,10);break;case 3:qt(s,6);break;default:qt(s,2)}}}function Ql(s,c){let h=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(h*=2),h*c}function qt(s,c){if(s.j.info("Error code "+c),c==2){var h=S(s.fb,s),d=s.Xa;let w=!d;d=new $t(d||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||bi(d,"https"),Ci(d),w?wg(d.toString(),h):Eg(d.toString(),h)}else be(2);s.G=0,s.l&&s.l.sa(c),Jl(s),jl(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))};function Jl(s){if(s.G=0,s.ka=[],s.l){let c=Rl(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ka,c),N(s.ka,s.i),s.h.i.length=0,V(s.i),s.i.length=0),s.l.ra()}}function Yl(s,c,h){var d=h instanceof $t?at(h):new $t(h);if(d.g!="")c&&(d.g=c+"."+d.g),Ri(d,d.s);else{var w=u.location;d=w.protocol,c=c?c+"."+w.hostname:w.hostname,w=+w.port;var A=new $t(null);d&&bi(A,d),c&&(A.g=c),w&&Ri(A,w),h&&(A.l=h),d=A}return h=s.D,c=s.ya,h&&c&&ee(d,h,c),ee(d,"VER",s.la),gr(s,d),d}function Xl(s,c,h){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new te(new hr({eb:h})):new te(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zl(){}n=Zl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function xi(){}xi.prototype.g=function(s,c){return new ke(s,c)};function ke(s,c){ve.call(this),this.g=new Bl(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!Q(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!Q(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new hn(this)}k(ke,ve),ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ke.prototype.close=function(){Ro(this.g)},ke.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var h={};h.__data__=s,s=h}else this.u&&(h={},h.__data__=go(s),s=h);c.i.push(new hg(c.Ya++,s)),c.G==3&&Ni(c)},ke.prototype.N=function(){this.g.l=null,delete this.j,Ro(this.g),delete this.g,ke.aa.N.call(this)};function eh(s){_o.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let h in c){s=h;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}k(eh,_o);function th(){yo.call(this),this.status=1}k(th,yo);function hn(s){this.g=s}k(hn,Zl),hn.prototype.ua=function(){Se(this.g,"a")},hn.prototype.ta=function(s){Se(this.g,new eh(s))},hn.prototype.sa=function(s){Se(this.g,new th)},hn.prototype.ra=function(){Se(this.g,"b")},xi.prototype.createWebChannel=xi.prototype.g,ke.prototype.send=ke.prototype.o,ke.prototype.open=ke.prototype.m,ke.prototype.close=ke.prototype.close,wc=pt.createWebChannelTransport=function(){return new xi},Ic=pt.getStatEventTarget=function(){return Ei()},vc=pt.Event=Ft,Rs=pt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ti.NO_ERROR=0,Ti.TIMEOUT=8,Ti.HTTP_ERROR=6,ti=pt.ErrorCode=Ti,_l.COMPLETE="complete",yc=pt.EventType=_l,dl.EventType=rr,rr.OPEN="a",rr.CLOSE="b",rr.ERROR="c",rr.MESSAGE="d",ve.prototype.listen=ve.prototype.K,xn=pt.WebChannel=dl,RI=pt.FetchXmlHttpFactory=hr,te.prototype.listenOnce=te.prototype.L,te.prototype.getLastError=te.prototype.Ka,te.prototype.getLastErrorCode=te.prototype.Ba,te.prototype.getStatus=te.prototype.Z,te.prototype.getResponseJson=te.prototype.Oa,te.prototype.getResponseText=te.prototype.oa,te.prototype.send=te.prototype.ea,te.prototype.setWithCredentials=te.prototype.Ha,_c=pt.XhrIo=te}).apply(typeof bs<"u"?bs:typeof self<"u"?self:typeof window<"u"?window:{});var Vf="@firebase/firestore";var fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};fe.UNAUTHENTICATED=new fe(null),fe.GOOGLE_CREDENTIALS=new fe("google-credentials-uid"),fe.FIRST_PARTY=new fe("first-party-uid"),fe.MOCK_USER=new fe("mock-user");var Jn="10.14.0";var tn=new Pt("@firebase/firestore");function ni(){return tn.logLevel}function O(n,...e){if(tn.logLevel<=q.DEBUG){let t=e.map(zu);tn.debug(`Firestore (${Jn}): ${n}`,...t)}}function nn(n,...e){if(tn.logLevel<=q.ERROR){let t=e.map(zu);tn.error(`Firestore (${Jn}): ${n}`,...t)}}function Os(n,...e){if(tn.logLevel<=q.WARN){let t=e.map(zu);tn.warn(`Firestore (${Jn}): ${n}`,...t)}}function zu(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${Jn}) INTERNAL ASSERTION FAILED: `+n;throw nn(e),new Error(e)}function re(n,e){n||B()}function Z(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends $e{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var gt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var xs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Sc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fe.UNAUTHENTICATED))}shutdown(){}},bc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Rc=class{constructor(e){this.t=e,this.currentUser=fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){re(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),o=new gt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new gt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=o;e.enqueueRetryable(()=>b(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},u=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new gt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(re(typeof r.accessToken=="string"),new xs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return re(e===null||typeof e=="string"),new fe(e)}},Cc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=fe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Pc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Cc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Dc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},kc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){re(this.o===void 0);let r=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(re(typeof t.token=="string"),this.R=t.token,new Dc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function CI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Vs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=CI(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function Y(n,e){return n<e?-1:n>e?1:0}function Fn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ae=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ne=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ae(0,0))}static max(){return new n(new Ae(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ms=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},pe=class n extends Ms{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},PI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Me=class n extends Ms{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return PI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new M(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new M(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var $=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var Nc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Nc.UNKNOWN_ID=-1;function DI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ne.fromTimestamp(r===1e9?new Ae(t+1,0):new Ae(t,r));return new rn(i,$.empty(),e)}function kI(n){return new rn(n.readTime,n.key,-1)}var rn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ne.min(),$.empty(),-1)}static max(){return new n(ne.max(),$.empty(),-1)}};function NI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var OI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Oc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function rp(n){return b(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==OI)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},l=>r(l))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let l=0;l<o;l++){let f=l;t(e[f]).next(_=>{a[f]=_,++u,u===o&&r(a)},_=>i(_))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function xI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function eo(n){return n.name==="IndexedDbTransactionError"}var VI=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Gu(n){return n==null}function ci(n){return n===0&&1/n==-1/0}function MI(n){return typeof n=="number"&&Number.isInteger(n)&&!ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var LI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],LA=[...LI,"documentOverlays"],FI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],UI=FI,$I=[...UI,"indexConfiguration","indexState","indexEntries"];var FA=[...$I,"globals"];function Mf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ip(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Le=class n{constructor(e,t){this.comparator=e,this.root=t||it.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,it.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,it.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mn(this.root,e,this.comparator,!0)}},Mn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},it=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};it.EMPTY=null,it.RED=!0,it.BLACK=!1;it.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,o){return this}insert(e,t,r){return new it(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Pe=class n{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ls(this.data.getIterator())}getIteratorFrom(e){return new Ls(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ls=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var rt=class n{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new n([])}unionWith(e){let t=new Pe(Me.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var xc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var _t=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new xc("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};_t.EMPTY_BYTE_STRING=new _t("");var qI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xt(n){if(re(!!n),typeof n=="string"){let e=0,t=qI.exec(n);if(re(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:oe(n.seconds),nanos:oe(n.nanos)}}function oe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Un(n){return typeof n=="string"?_t.fromBase64String(n):_t.fromUint8Array(n)}function Wu(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function sp(n){let e=n.mapValue.fields.__previous_value__;return Wu(e)?sp(e):e}function Fs(n){let e=xt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ae(e.seconds,e.nanos)}var Vc=class{constructor(e,t,r,i,o,a,u,l,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=f}},Mc=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Cs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function $n(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Wu(n)?4:ap(n)?9007199254740991:op(n)?10:11:B()}function st(n,e){if(n===e)return!0;let t=$n(n);if(t!==$n(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Fs(n).isEqual(Fs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=xt(i.timestampValue),u=xt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Un(i.bytesValue).isEqual(Un(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return oe(i.geoPointValue.latitude)===oe(o.geoPointValue.latitude)&&oe(i.geoPointValue.longitude)===oe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return oe(i.integerValue)===oe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=oe(i.doubleValue),u=oe(o.doubleValue);return a===u?ci(a)===ci(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Fn(n.arrayValue.values||[],e.arrayValue.values||[],st);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Mf(a)!==Mf(u))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!st(a[l],u[l])))return!1;return!0}(n,e);default:return B()}}function ui(n,e){return(n.values||[]).find(t=>st(t,e))!==void 0}function qn(n,e){if(n===e)return 0;let t=$n(n),r=$n(e);if(t!==r)return Y(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=oe(o.integerValue||o.doubleValue),l=oe(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return Lf(n.timestampValue,e.timestampValue);case 4:return Lf(Fs(n),Fs(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(o,a){let u=Un(o),l=Un(a);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),l=a.split("/");for(let f=0;f<u.length&&f<l.length;f++){let _=Y(u[f],l[f]);if(_!==0)return _}return Y(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=Y(oe(o.latitude),oe(a.latitude));return u!==0?u:Y(oe(o.longitude),oe(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Ff(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,l,f,_;let E=o.fields||{},S=a.fields||{},D=(u=E.value)===null||u===void 0?void 0:u.arrayValue,k=(l=S.value)===null||l===void 0?void 0:l.arrayValue,V=Y(((f=D?.values)===null||f===void 0?void 0:f.length)||0,((_=k?.values)===null||_===void 0?void 0:_.length)||0);return V!==0?V:Ff(D,k)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Cs.mapValue&&a===Cs.mapValue)return 0;if(o===Cs.mapValue)return 1;if(a===Cs.mapValue)return-1;let u=o.fields||{},l=Object.keys(u),f=a.fields||{},_=Object.keys(f);l.sort(),_.sort();for(let E=0;E<l.length&&E<_.length;++E){let S=Y(l[E],_[E]);if(S!==0)return S;let D=qn(u[l[E]],f[_[E]]);if(D!==0)return D}return Y(l.length,_.length)}(n.mapValue,e.mapValue);default:throw B()}}function Lf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=xt(n),r=xt(e),i=Y(t.seconds,r.seconds);return i!==0?i:Y(t.nanos,r.nanos)}function Ff(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=qn(t[i],r[i]);if(o)return o}return Y(t.length,r.length)}function Bn(n){return Lc(n)}function Lc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=xt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Un(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return $.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Lc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Lc(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Fc(n){return!!n&&"integerValue"in n}function Ku(n){return!!n&&"arrayValue"in n}function ks(n){return!!n&&"mapValue"in n}function op(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ii(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return gi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ii(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ii(n.arrayValue.values[t]);return e}return Object.assign({},n)}function ap(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var nt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ks(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ii(t)}setAll(e){let t=Me.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=ii(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());ks(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return st(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ks(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){gi(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ii(this.value))}};function cp(n){let e=[];return gi(n.fields,(t,r)=>{let i=new Me([t]);if(ks(r)){let o=cp(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new rt(e)}var jn=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,ne.min(),ne.min(),ne.min(),nt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ne.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ne.min(),ne.min(),nt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ne.min(),ne.min(),nt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var zn=class{constructor(e,t){this.position=e,this.inclusive=t}};function Uf(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=$.comparator($.fromName(a.referenceValue),t.key):r=qn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function $f(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!st(n.position[t],e.position[t]))return!1;return!0}var Gn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function BI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Us=class{},ge=class n extends Us{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $c(e,t,r):t==="array-contains"?new jc(e,r):t==="in"?new zc(e,r):t==="not-in"?new Gc(e,r):t==="array-contains-any"?new Wc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new qc(e,r):new Bc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(qn(t,this.value)):t!==null&&$n(this.value)===$n(t)&&this.matchesComparison(qn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Vt=class n extends Us{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return up(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function up(n){return n.op==="and"}function lp(n){return jI(n)&&up(n)}function jI(n){for(let e of n.filters)if(e instanceof Vt)return!1;return!0}function Uc(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+Bn(n.value);if(lp(n))return n.filters.map(e=>Uc(e)).join(",");{let e=n.filters.map(t=>Uc(t)).join(",");return`${n.op}(${e})`}}function hp(n,e){return n instanceof ge?function(r,i){return i instanceof ge&&r.op===i.op&&r.field.isEqual(i.field)&&st(r.value,i.value)}(n,e):n instanceof Vt?function(r,i){return i instanceof Vt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&hp(a,i.filters[u]),!0):!1}(n,e):void B()}function dp(n){return n instanceof ge?function(t){return`${t.field.canonicalString()} ${t.op} ${Bn(t.value)}`}(n):n instanceof Vt?function(t){return t.op.toString()+" {"+t.getFilters().map(dp).join(" ,")+"}"}(n):"Filter"}var $c=class extends ge{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},qc=class extends ge{constructor(e,t){super(e,"in",t),this.keys=fp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Bc=class extends ge{constructor(e,t){super(e,"not-in",t),this.keys=fp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function fp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}var jc=class extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ku(t)&&ui(t.arrayValue,this.value)}},zc=class extends ge{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ui(this.value.arrayValue,t)}},Gc=class extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(ui(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!ui(this.value.arrayValue,t)}},Wc=class extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ku(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ui(this.value.arrayValue,r))}};var Kc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function qf(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Kc(n,e,t,r,i,o,a)}function Hu(n){let e=Z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Uc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Gu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Bn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Bn(r)).join(",")),e.ue=t}return e.ue}function Qu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!BI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$f(n.startAt,e.startAt)&&$f(n.endAt,e.endAt)}var Wn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function zI(n,e,t,r,i,o,a,u){return new Wn(n,e,t,r,i,o,a,u)}function GI(n){return new Wn(n)}function Bf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function WI(n){return n.collectionGroup!==null}function si(n){let e=Z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Pe(Me.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(f=>{f.isInequality()&&(u=u.add(f.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Gn(o,r))}),t.has(Me.keyField().canonicalString())||e.ce.push(new Gn(Me.keyField(),r))}return e.ce}function Zt(n){let e=Z(n);return e.le||(e.le=KI(e,si(n))),e.le}function KI(n,e){if(n.limitType==="F")return qf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Gn(i.field,o)});let t=n.endAt?new zn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zn(n.startAt.position,n.startAt.inclusive):null;return qf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Hc(n,e,t){return new Wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pp(n,e){return Qu(Zt(n),Zt(e))&&n.limitType===e.limitType}function gp(n){return`${Hu(Zt(n))}|lt:${n.limitType}`}function ri(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>dp(i)).join(", ")}]`),Gu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Bn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Bn(i)).join(",")),`Target(${r})`}(Zt(n))}; limitType=${n.limitType})`}function Ju(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):$.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of si(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,l){let f=Uf(a,u,l);return a.inclusive?f<=0:f<0}(r.startAt,si(r),i)||r.endAt&&!function(a,u,l){let f=Uf(a,u,l);return a.inclusive?f>=0:f>0}(r.endAt,si(r),i))}(n,e)}function HI(n){return(e,t)=>{let r=!1;for(let i of si(n)){let o=QI(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function QI(n,e,t){let r=n.field.isKeyField()?$.comparator(e.key,t.key):function(o,a,u){let l=a.data.field(o),f=u.data.field(o);return l!==null&&f!==null?qn(l,f):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var Mt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gi(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return ip(this.inner)}size(){return this.innerSize}};var JI=new Le($.comparator);function $s(){return JI}var mp=new Le($.comparator);function Ps(...n){let e=mp;for(let t of n)e=e.insert(t.key,t);return e}function _p(n){let e=mp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Xt(){return oi()}function yp(){return oi()}function oi(){return new Mt(n=>n.toString(),(n,e)=>n.isEqual(e))}var YI=new Le($.comparator),XI=new Pe($.comparator);function Te(...n){let e=XI;for(let t of n)e=e.add(t);return e}var ZI=new Pe(Y);function ew(){return ZI}function Yu(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function vp(n){return{integerValue:""+n}}function Ip(n,e){return MI(e)?vp(e):Yu(n,e)}var Kn=class{constructor(){this._=void 0}};function tw(n,e,t){return n instanceof Hn?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Wu(o)&&(o=sp(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof sn?Ep(n,e):n instanceof on?Tp(n,e):function(i,o){let a=wp(i,o),u=jf(a)+jf(i.Pe);return Fc(a)&&Fc(i.Pe)?vp(u):Yu(i.serializer,u)}(n,e)}function nw(n,e,t){return n instanceof sn?Ep(n,e):n instanceof on?Tp(n,e):t}function wp(n,e){return n instanceof an?function(r){return Fc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Hn=class extends Kn{},sn=class extends Kn{constructor(e){super(),this.elements=e}};function Ep(n,e){let t=Ap(e);for(let r of n.elements)t.some(i=>st(i,r))||t.push(r);return{arrayValue:{values:t}}}var on=class extends Kn{constructor(e){super(),this.elements=e}};function Tp(n,e){let t=Ap(e);for(let r of n.elements)t=t.filter(i=>!st(i,r));return{arrayValue:{values:t}}}var an=class extends Kn{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function jf(n){return oe(n.integerValue||n.doubleValue)}function Ap(n){return Ku(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Qc=class{constructor(e,t){this.field=e,this.transform=t}};function rw(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof sn&&i instanceof sn||r instanceof on&&i instanceof on?Fn(r.elements,i.elements,st):r instanceof an&&i instanceof an?st(r.Pe,i.Pe):r instanceof Hn&&i instanceof Hn}(n.transform,e.transform)}var Jc=class{constructor(e,t){this.version=e,this.transformResults=t}},en=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ns(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Qn=class{};function Sp(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new qs(n.key,en.none()):new cn(n.key,n.data,en.none());{let t=n.data,r=nt.empty(),i=new Pe(Me.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new yt(n.key,r,new rt(i.toArray()),en.none())}}function iw(n,e,t){n instanceof cn?function(i,o,a){let u=i.value.clone(),l=Gf(i.fieldTransforms,o,a.transformResults);u.setAll(l),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof yt?function(i,o,a){if(!Ns(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Gf(i.fieldTransforms,o,a.transformResults),l=o.data;l.setAll(bp(i)),l.setAll(u),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ai(n,e,t,r){return n instanceof cn?function(o,a,u,l){if(!Ns(o.precondition,a))return u;let f=o.value.clone(),_=Wf(o.fieldTransforms,l,a);return f.setAll(_),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof yt?function(o,a,u,l){if(!Ns(o.precondition,a))return u;let f=Wf(o.fieldTransforms,l,a),_=a.data;return _.setAll(bp(o)),_.setAll(f),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(E=>E.field))}(n,e,t,r):function(o,a,u){return Ns(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function sw(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=wp(r.transform,i||null);o!=null&&(t===null&&(t=nt.empty()),t.set(r.field,o))}return t||null}function zf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fn(r,i,(o,a)=>rw(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var cn=class extends Qn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},yt=class extends Qn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function bp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Gf(n,e,t){let r=new Map;re(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,nw(a,u,t[i]))}return r}function Wf(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,tw(o,a,e))}return r}var qs=class extends Qn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Yc=class extends Qn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Xc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&iw(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=yp();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let l=Sp(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Te())}isEqual(e){return this.batchId===e.batchId&&Fn(this.mutations,e.mutations,(t,r)=>zf(t,r))&&Fn(this.baseMutations,e.baseMutations,(t,r)=>zf(t,r))}},Zc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){re(e.mutations.length===r.length);let i=function(){return YI}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var eu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ie,j;function ow(n){switch(n){default:return B();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function aw(n){if(n===void 0)return nn("GRPC error has no .code"),R.UNKNOWN;switch(n){case ie.OK:return R.OK;case ie.CANCELLED:return R.CANCELLED;case ie.UNKNOWN:return R.UNKNOWN;case ie.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ie.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ie.INTERNAL:return R.INTERNAL;case ie.UNAVAILABLE:return R.UNAVAILABLE;case ie.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ie.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ie.NOT_FOUND:return R.NOT_FOUND;case ie.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ie.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ie.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ie.ABORTED:return R.ABORTED;case ie.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ie.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ie.DATA_LOSS:return R.DATA_LOSS;default:return B()}}(j=ie||(ie={}))[j.OK=0]="OK",j[j.CANCELLED=1]="CANCELLED",j[j.UNKNOWN=2]="UNKNOWN",j[j.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",j[j.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",j[j.NOT_FOUND=5]="NOT_FOUND",j[j.ALREADY_EXISTS=6]="ALREADY_EXISTS",j[j.PERMISSION_DENIED=7]="PERMISSION_DENIED",j[j.UNAUTHENTICATED=16]="UNAUTHENTICATED",j[j.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",j[j.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",j[j.ABORTED=10]="ABORTED",j[j.OUT_OF_RANGE=11]="OUT_OF_RANGE",j[j.UNIMPLEMENTED=12]="UNIMPLEMENTED",j[j.INTERNAL=13]="INTERNAL",j[j.UNAVAILABLE=14]="UNAVAILABLE",j[j.DATA_LOSS=15]="DATA_LOSS";var $A=new mc([4294967295,4294967295],0);var tu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function nu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uw(n,e){return nu(n,e.toTimestamp())}function Ln(n){return re(!!n),ne.fromTimestamp(function(t){let r=xt(t);return new Ae(r.seconds,r.nanos)}(n))}function Rp(n,e){return ru(n,e).canonicalString()}function ru(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function lw(n){let e=pe.fromString(n);return re(yw(e)),e}function iu(n,e){return Rp(n.databaseId,e.path)}function hw(n){let e=lw(n);return e.length===4?pe.emptyPath():fw(e)}function dw(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function fw(n){return re(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Kf(n,e,t){return{name:iu(n,e),fields:t.value.mapValue.fields}}function pw(n,e){let t;if(e instanceof cn)t={update:Kf(n,e.key,e.value)};else if(e instanceof qs)t={delete:iu(n,e.key)};else if(e instanceof yt)t={update:Kf(n,e.key,e.data),updateMask:_w(e.fieldMask)};else{if(!(e instanceof Yc))return B();t={verify:iu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof Hn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof sn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof on)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof an)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:uw(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B()}(n,e.precondition)),t}function gw(n,e){return n&&n.length>0?(re(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?Ln(i.updateTime):Ln(o);return a.isEqual(ne.min())&&(a=Ln(o)),new Jc(a,i.transformResults||[])}(t,e))):[]}function mw(n){let e=hw(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){re(r===1);let _=t.from[0];_.allDescendants?i=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=function(E){let S=Cp(E);return S instanceof Vt&&lp(S)?S.getFilters():[S]}(t.where));let a=[];t.orderBy&&(a=function(E){return E.map(S=>function(k){return new Gn(Vn(k.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(S))}(t.orderBy));let u=null;t.limit&&(u=function(E){let S;return S=typeof E=="object"?E.value:E,Gu(S)?null:S}(t.limit));let l=null;t.startAt&&(l=function(E){let S=!!E.before,D=E.values||[];return new zn(D,S)}(t.startAt));let f=null;return t.endAt&&(f=function(E){let S=!E.before,D=E.values||[];return new zn(D,S)}(t.endAt)),zI(e,i,a,o,u,"F",l,f)}function Cp(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Vn(t.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Vn(t.unaryFilter.field);return ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Vn(t.unaryFilter.field);return ge.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Vn(t.unaryFilter.field);return ge.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return ge.create(Vn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Vt.create(t.compositeFilter.filters.map(r=>Cp(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function Vn(n){return Me.fromServerFormat(n.fieldPath)}function _w(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function yw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var su=class{constructor(e){this.ct=e}};function vw(n){let e=mw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Hc(e,e.limit,"L"):e}var Bs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(oe(e.integerValue));else if("doubleValue"in e){let r=oe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ci(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=xt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Un(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?ap(e)?this.dt(t,Number.MAX_SAFE_INTEGER):op(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(oe(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),$.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Bs.vt=new Bs;var ou=class{constructor(){this.un=new au}addToCollectionParentIndex(e,t){return this.un.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(rn.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(rn.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},au=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Pe(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pe(pe.comparator)).toArray()}};var qA=new Uint8Array(0);var tt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};tt.DEFAULT_COLLECTION_PERCENTILE=10,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tt.DEFAULT=new tt(41943040,tt.DEFAULT_COLLECTION_PERCENTILE,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tt.DISABLED=new tt(-1,0,0);var li=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var cu=class{constructor(){this.changes=new Mt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var uu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var lu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ai(r.mutation,i,rt.empty(),Ae.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Te()){let i=Xt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=Ps();return o.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Xt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Te()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=$s(),a=oi(),u=function(){return oi()}();return t.forEach((l,f)=>{let _=r.get(f.key);i.has(f.key)&&(_===void 0||_.mutation instanceof yt)?o=o.insert(f.key,f):_!==void 0?(a.set(f.key,_.mutation.getFieldMask()),ai(_.mutation,f,_.mutation.getFieldMask(),Ae.now())):a.set(f.key,rt.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((f,_)=>a.set(f,_)),t.forEach((f,_)=>{var E;return u.set(f,new uu(_,(E=a.get(f))!==null&&E!==void 0?E:null))}),u))}recalculateAndSaveOverlays(e,t){let r=oi(),i=new Le((a,u)=>a-u),o=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(l=>{let f=t.get(l);if(f===null)return;let _=r.get(l)||rt.empty();_=u.applyToLocalView(f,_),r.set(l,_);let E=(i.get(u.batchId)||Te()).add(l);i=i.insert(u.batchId,E)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),f=l.key,_=l.value,E=yp();_.forEach(S=>{if(!o.has(S)){let D=Sp(t.get(S),r.get(S));D!==null&&E.set(S,D),o=o.add(S)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,E))}return C.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return $.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):WI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):C.resolve(Xt()),u=-1,l=o;return a.next(f=>C.forEach(f,(_,E)=>(u<E.largestBatchId&&(u=E.largestBatchId),o.get(_)?C.resolve():this.remoteDocumentCache.getEntry(e,_).next(S=>{l=l.insert(_,S)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,l,f,Te())).next(_=>({batchId:u,changes:_p(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=Ps();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=Ps();return this.indexManager.getCollectionParents(e,o).next(u=>C.forEach(u,l=>{let f=function(E,S){return new Wn(S,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(_=>{_.forEach((E,S)=>{a=a.insert(E,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((l,f)=>{let _=f.getKey();a.get(_)===null&&(a=a.insert(_,jn.newInvalidDocument(_)))});let u=Ps();return a.forEach((l,f)=>{let _=o.get(l);_!==void 0&&ai(_.mutation,f,rt.empty(),Ae.now()),Ju(t,f)&&(u=u.insert(l,f))}),u})}};var hu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return C.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ln(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:vw(i.bundledQuery),readTime:Ln(i.readTime)}}(t)),C.resolve()}};var du=class{constructor(){this.overlays=new Le($.comparator),this.Ir=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Xt();return C.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),C.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){let i=Xt(),o=t.length+1,a=new $(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let l=u.getNext().value,f=l.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&l.largestBatchId>r&&i.set(l.getKey(),l)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Le((f,_)=>f-_),a=this.overlays.getIterator();for(;a.hasNext();){let f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let _=o.get(f.largestBatchId);_===null&&(_=Xt(),o=o.insert(f.largestBatchId,_)),_.set(f.getKey(),f)}}let u=Xt(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((f,_)=>u.set(f,_)),!(u.size()>=i)););return C.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eu(t,r));let o=this.Ir.get(t);o===void 0&&(o=Te(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var fu=class{constructor(){this.sessionToken=_t.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var hi=class{constructor(){this.Tr=new Pe(se.Er),this.dr=new Pe(se.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new se(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new se(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new $(new pe([])),r=new se(t,e),i=new se(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new $(new pe([])),r=new se(t,e),i=new se(t,e+1),o=Te();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new se(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},se=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return $.comparator(e.key,t.key)||Y(e.wr,t.wr)}static Ar(e,t){return Y(e.wr,t.wr)||$.comparator(e.key,t.key)}};var pu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Pe(se.Er)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Xc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new se(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return C.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new se(t,0),i=new se(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),C.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pe(Y);return t.forEach(i=>{let o=new se(i,0),a=new se(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),C.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;$.isDocumentKey(o)||(o=o.child(""));let a=new se(new $(o),0),u=new Pe(Y);return this.br.forEachWhile(l=>{let f=l.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(u=u.add(l.wr)),!0)},a),C.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){re(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return C.forEach(t.mutations,i=>{let o=new se(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new se(t,0),i=this.br.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var gu=class{constructor(e){this.Mr=e,this.docs=function(){return new Le($.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():jn.newInvalidDocument(t))}getEntries(e,t){let r=$s();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():jn.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=$s(),a=t.path,u=new $(a.child("")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:f,value:{document:_}}=l.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||NI(kI(_),r)<=0||(i.has(_.key)||Ju(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return C.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new mu(this)}getSize(e){return C.resolve(this.size)}},mu=class extends cu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var _u=class{constructor(e){this.persistence=e,this.Nr=new Mt(t=>Hu(t),Qu),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new hi,this.targetCount=0,this.kr=li.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),C.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new li(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Kn(t),C.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),C.waitFor(o).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),C.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this.Br.containsKey(t))}};var yu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new VI(0),this.Kr=!1,this.Kr=!0,this.$r=new fu,this.referenceDelegate=e(this),this.Ur=new _u(this),this.indexManager=new ou,this.remoteDocumentCache=function(i){return new gu(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new su(t),this.Gr=new hu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new du,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new pu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new vu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return C.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},vu=class extends Oc{constructor(e){super(),this.currentSequenceNumber=e}},Iu=class n{constructor(e){this.persistence=e,this.Jr=new hi,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),C.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.Xr,r=>{let i=$.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,ne.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return C.or([()=>C.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var wu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Te(),i=Te();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Eu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Tu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Jd()?8:xI(Ve())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Eu;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ni()<=q.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",ri(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),C.resolve()):(ni()<=q.DEBUG&&O("QueryEngine","Query:",ri(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ni()<=q.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",ri(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zt(t))):C.resolve())}Yi(e,t){if(Bf(t))return C.resolve(null);let r=Zt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Hc(t,null,"F"),r=Zt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Te(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let f=this.ts(t,u);return this.ns(t,f,a,l.readTime)?this.Yi(e,Hc(t,null,"F")):this.rs(e,f,t,l)}))})))}Zi(e,t,r,i){return Bf(t)||i.isEqual(ne.min())?C.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?C.resolve(null):(ni()<=q.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ri(t)),this.rs(e,a,t,DI(i,-1)).next(u=>u))})}ts(e,t){let r=new Pe(HI(e));return t.forEach((i,o)=>{Ju(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return ni()<=q.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",ri(t)),this.Ji.getDocumentsMatchingQuery(e,t,rn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Au=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Le(Y),this._s=new Mt(o=>Hu(o),Qu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Iw(n,e,t,r){return new Au(n,e,t,r)}function Pp(n,e){return b(this,null,function*(){let t=Z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],l=Te();for(let f of i){a.push(f.batchId);for(let _ of f.mutations)l=l.add(_.key)}for(let f of o){u.push(f.batchId);for(let _ of f.mutations)l=l.add(_.key)}return t.localDocuments.getDocuments(r,l).next(f=>({hs:f,removedBatchIds:a,addedBatchIds:u}))})})})}function ww(n,e){let t=Z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,l,f,_){let E=f.batch,S=E.keys(),D=C.resolve();return S.forEach(k=>{D=D.next(()=>_.getEntry(l,k)).next(V=>{let N=f.docVersions.get(k);re(N!==null),V.version.compareTo(N)<0&&(E.applyToRemoteDocument(V,f),V.isValidDocument()&&(V.setReadTime(f.commitVersion),_.addEntry(V)))})}),D.next(()=>u.mutationQueue.removeMutationBatch(l,E))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=Te();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(l=l.add(u.batch.mutations[f].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Ew(n){let e=Z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Tw(n,e){let t=Z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var js=class{constructor(){this.activeTargetIds=ew()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Su=class{constructor(){this.so=new js,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new js,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var bu=class{_o(e){}shutdown(){}};var zs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ds=null;function Ec(){return Ds===null?Ds=function(){return 268435456+Math.round(2147483648*Math.random())}():Ds++,"0x"+Ds.toString(16)}var Aw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ru=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ee="WebChannelConnection",Cu=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=Ec(),l=this.xo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${u}:`,l,i);let f={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(f,o,a),this.No(t,l,f,i).then(_=>(O("RestConnection",`Received RPC '${t}' ${u}: `,_),_),_=>{throw Os("RestConnection",`RPC '${t}' ${u} failed with error: `,_,"url: ",l,"request:",i),_})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jn}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=Aw[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=Ec();return new Promise((a,u)=>{let l=new _c;l.setWithCredentials(!0),l.listenOnce(yc.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ti.NO_ERROR:let _=l.getResponseJson();O(Ee,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(_)),a(_);break;case ti.TIMEOUT:O(Ee,`RPC '${e}' ${o} timed out`),u(new M(R.DEADLINE_EXCEEDED,"Request time out"));break;case ti.HTTP_ERROR:let E=l.getStatus();if(O(Ee,`RPC '${e}' ${o} failed with status:`,E,"response text:",l.getResponseText()),E>0){let S=l.getResponseJson();Array.isArray(S)&&(S=S[0]);let D=S?.error;if(D&&D.status&&D.message){let k=function(N){let G=N.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(G)>=0?G:R.UNKNOWN}(D.status);u(new M(k,D.message))}else u(new M(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new M(R.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{O(Ee,`RPC '${e}' ${o} completed.`)}});let f=JSON.stringify(i);O(Ee,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",f,r,15)})}Bo(e,t,r){let i=Ec(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=wc(),u=Ic(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(l.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let _=o.join("");O(Ee,`Creating RPC '${e}' stream ${i}: ${_}`,l);let E=a.createWebChannel(_,l),S=!1,D=!1,k=new Ru({Io:N=>{D?O(Ee,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(S||(O(Ee,`Opening RPC '${e}' stream ${i} transport.`),E.open(),S=!0),O(Ee,`RPC '${e}' stream ${i} sending:`,N),E.send(N))},To:()=>E.close()}),V=(N,G,Q)=>{N.listen(G,K=>{try{Q(K)}catch(ae){setTimeout(()=>{throw ae},0)}})};return V(E,xn.EventType.OPEN,()=>{D||(O(Ee,`RPC '${e}' stream ${i} transport opened.`),k.yo())}),V(E,xn.EventType.CLOSE,()=>{D||(D=!0,O(Ee,`RPC '${e}' stream ${i} transport closed`),k.So())}),V(E,xn.EventType.ERROR,N=>{D||(D=!0,Os(Ee,`RPC '${e}' stream ${i} transport errored:`,N),k.So(new M(R.UNAVAILABLE,"The operation could not be completed")))}),V(E,xn.EventType.MESSAGE,N=>{var G;if(!D){let Q=N.data[0];re(!!Q);let K=Q,ae=K.error||((G=K[0])===null||G===void 0?void 0:G.error);if(ae){O(Ee,`RPC '${e}' stream ${i} received error:`,ae);let He=ae.status,ue=function(m){let y=ie[m];if(y!==void 0)return aw(y)}(He),I=ae.message;ue===void 0&&(ue=R.INTERNAL,I="Unknown error status: "+He+" with message "+ae.message),D=!0,k.So(new M(ue,I)),E.close()}else O(Ee,`RPC '${e}' stream ${i} received:`,Q),k.bo(Q)}}),V(u,vc.STAT_EVENT,N=>{N.stat===Rs.PROXY?O(Ee,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Rs.NOPROXY&&O(Ee,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}};function Tc(){return typeof document<"u"?document:null}function to(n){return new tu(n,!0)}var Gs=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Pu=class{constructor(e,t,r,i,o,a,u,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Gs(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return b(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return b(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return b(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(nn(t.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new M(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>b(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var Du=class extends Pu{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return re(!!e.streamToken),this.lastStreamToken=e.streamToken,re(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=gw(e.writeResults,e.commitTime),r=Ln(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=dw(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>pw(this.serializer,r))};this.a_(t)}};var ku=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,ru(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(R.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,ru(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(R.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Nu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(nn(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Ou=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>b(this,null,function*(){_i(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(l){return b(this,null,function*(){let f=Z(l);f.L_.add(4),yield mi(f),f.q_.set("Unknown"),f.L_.delete(4),yield no(f)})}(this))}))}),this.q_=new Nu(r,i)}};function no(n){return b(this,null,function*(){if(_i(n))for(let e of n.B_)yield e(!0)})}function mi(n){return b(this,null,function*(){for(let e of n.B_)yield e(!1)})}function _i(n){return Z(n).L_.size===0}function Dp(n,e,t){return b(this,null,function*(){if(!eo(e))throw e;n.L_.add(1),yield mi(n),n.q_.set("Offline"),t||(t=()=>Ew(n.localStore)),n.asyncQueue.enqueueRetryable(()=>b(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield no(n)}))})}function kp(n,e){return e().catch(t=>Dp(n,t,e))}function ro(n){return b(this,null,function*(){let e=Z(n),t=Lt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Sw(e);)try{let i=yield Tw(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,bw(e,i)}catch(i){yield Dp(e,i)}Np(e)&&Op(e)})}function Sw(n){return _i(n)&&n.O_.length<10}function bw(n,e){n.O_.push(e);let t=Lt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Np(n){return _i(n)&&!Lt(n).n_()&&n.O_.length>0}function Op(n){Lt(n).start()}function Rw(n){return b(this,null,function*(){Lt(n).p_()})}function Cw(n){return b(this,null,function*(){let e=Lt(n);for(let t of n.O_)e.m_(t.mutations)})}function Pw(n,e,t){return b(this,null,function*(){let r=n.O_.shift(),i=Zc.from(r,e,t);yield kp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ro(n)})}function Dw(n,e){return b(this,null,function*(){e&&Lt(n).V_&&(yield function(r,i){return b(this,null,function*(){if(function(a){return ow(a)&&a!==R.ABORTED}(i.code)){let o=r.O_.shift();Lt(r).s_(),yield kp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield ro(r)}})}(n,e)),Np(n)&&Op(n)})}function Hf(n,e){return b(this,null,function*(){let t=Z(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=_i(t);t.L_.add(3),yield mi(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield no(t)})}function kw(n,e){return b(this,null,function*(){let t=Z(n);e?(t.L_.delete(2),yield no(t)):e||(t.L_.add(2),yield mi(t),t.q_.set("Unknown"))})}function Lt(n){return n.U_||(n.U_=function(t,r,i){let o=Z(t);return o.w_(),new Du(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Rw.bind(null,n),mo:Dw.bind(null,n),f_:Cw.bind(null,n),g_:Pw.bind(null,n)}),n.B_.push(e=>b(this,null,function*(){e?(n.U_.s_(),yield ro(n)):(yield n.U_.stop(),n.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var xu=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new gt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function xp(n,e){if(nn("AsyncQueue",`${e}: ${n}`),eo(n))return new M(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Vu=class{constructor(){this.queries=Qf(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=Z(t),o=i.queries;i.queries=Qf(),o.forEach((a,u)=>{for(let l of u.j_)l.onError(r)})})(this,new M(R.ABORTED,"Firestore shutting down"))}};function Qf(){return new Mt(n=>gp(n),pp)}function Nw(n){n.Y_.forEach(e=>{e.next()})}var Jf,Yf;(Yf=Jf||(Jf={})).ea="default",Yf.Cache="cache";var Mu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Mt(u=>gp(u),pp),this.Ma=new Map,this.xa=new Set,this.Oa=new Le($.comparator),this.Na=new Map,this.La=new hi,this.Ba={},this.ka=new Map,this.qa=li.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Ow(n,e,t){return b(this,null,function*(){let r=Lw(n);try{let i=yield function(a,u){let l=Z(a),f=Ae.now(),_=u.reduce((D,k)=>D.add(k.key),Te()),E,S;return l.persistence.runTransaction("Locally write mutations","readwrite",D=>{let k=$s(),V=Te();return l.cs.getEntries(D,_).next(N=>{k=N,k.forEach((G,Q)=>{Q.isValidDocument()||(V=V.add(G))})}).next(()=>l.localDocuments.getOverlayedDocuments(D,k)).next(N=>{E=N;let G=[];for(let Q of u){let K=sw(Q,E.get(Q.key).overlayedDocument);K!=null&&G.push(new yt(Q.key,K,cp(K.value.mapValue),en.exists(!0)))}return l.mutationQueue.addMutationBatch(D,f,G,u)}).next(N=>{S=N;let G=N.applyToLocalDocumentSet(E,V);return l.documentOverlayCache.saveOverlays(D,N.batchId,G)})}).then(()=>({batchId:S.batchId,changes:_p(E)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,l){let f=a.Ba[a.currentUser.toKey()];f||(f=new Le(Y)),f=f.insert(u,l),a.Ba[a.currentUser.toKey()]=f}(r,i.batchId,t),yield io(r,i.changes),yield ro(r.remoteStore)}catch(i){let o=xp(i,"Failed to persist write");t.reject(o)}})}function Xf(n,e,t){let r=Z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let l=Z(a);l.onlineState=u;let f=!1;l.queries.forEach((_,E)=>{for(let S of E.j_)S.Z_(u)&&(f=!0)}),f&&Nw(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function xw(n,e){return b(this,null,function*(){let t=Z(n),r=e.batch.batchId;try{let i=yield ww(t.localStore,e);Mp(t,r,null),Vp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield io(t,i)}catch(i){yield rp(i)}})}function Vw(n,e,t){return b(this,null,function*(){let r=Z(n);try{let i=yield function(a,u){let l=Z(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let _;return l.mutationQueue.lookupMutationBatch(f,u).next(E=>(re(E!==null),_=E.keys(),l.mutationQueue.removeMutationBatch(f,E))).next(()=>l.mutationQueue.performConsistencyCheck(f)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(f,_,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,_)).next(()=>l.localDocuments.getDocuments(f,_))})}(r.localStore,e);Mp(r,e,t),Vp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield io(r,i)}catch(i){yield rp(i)}})}function Vp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Mp(n,e,t){let r=Z(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function io(n,e,t){return b(this,null,function*(){let r=Z(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,l)=>{a.push(r.Ka(l,e,t).then(f=>{var _;if((f||t)&&r.isPrimaryClient){let E=f?!f.fromCache:(_=t?.targetChanges.get(l.targetId))===null||_===void 0?void 0:_.current;r.sharedClientState.updateQueryState(l.targetId,E?"current":"not-current")}if(f){i.push(f);let E=wu.Wi(l.targetId,f);o.push(E)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(l,f){return b(this,null,function*(){let _=Z(l);try{yield _.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>C.forEach(f,S=>C.forEach(S.$i,D=>_.persistence.referenceDelegate.addReference(E,S.targetId,D)).next(()=>C.forEach(S.Ui,D=>_.persistence.referenceDelegate.removeReference(E,S.targetId,D)))))}catch(E){if(!eo(E))throw E;O("LocalStore","Failed to update sequence numbers: "+E)}for(let E of f){let S=E.targetId;if(!E.fromCache){let D=_.os.get(S),k=D.snapshotVersion,V=D.withLastLimboFreeSnapshotVersion(k);_.os=_.os.insert(S,V)}}})}(r.localStore,o))})}function Mw(n,e){return b(this,null,function*(){let t=Z(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield Pp(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(l=>{l.reject(new M(R.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield io(t,r.hs)}})}function Lw(n){let e=Z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xw.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Vw.bind(null,e),e}var Zf=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return b(this,null,function*(){this.serializer=to(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return Iw(this.persistence,new Tu,t.initialUser,this.serializer)}Ga(t){return new yu(Iu.Zr,this.serializer)}Wa(t){return new Su}terminate(){return b(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Fw=(()=>{class n{initialize(t,r){return b(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Xf(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mw.bind(null,this.syncEngine),yield kw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Vu}()}createDatastore(t){let r=to(t.databaseInfo.databaseId),i=function(a){return new Cu(a)}(t.databaseInfo);return function(a,u,l,f){return new ku(a,u,l,f)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,a,u,l){return new Ou(i,o,a,u,l)}(this.localStore,this.datastore,t.asyncQueue,r=>Xf(this.syncEngine,r,0),function(){return zs.D()?new zs:new bu}())}createSyncEngine(t,r){return function(o,a,u,l,f,_,E){let S=new Mu(o,a,u,l,f,_);return E&&(S.Qa=!0),S}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return b(this,null,function*(){var t,r;yield function(o){return b(this,null,function*(){let a=Z(o);O("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield mi(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Lu=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=fe.UNAUTHENTICATED,this.clientId=Vs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>b(this,null,function*(){O("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(O("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new gt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>b(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=xp(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ac(n,e){return b(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>b(this,null,function*(){r.isEqual(i)||(yield Pp(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function ep(n,e){return b(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Uw(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Hf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Hf(e.remoteStore,i)),n._onlineComponents=e})}function Uw(n){return b(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ac(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Os("Error using user provided cache. Falling back to memory cache: "+t),yield Ac(n,new Zf)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield Ac(n,new Zf);return n._offlineComponents})}function $w(n){return b(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield ep(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield ep(n,new Fw))),n._onlineComponents})}function qw(n){return $w(n).then(e=>e.syncEngine)}function Lp(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var tp=new Map;function Bw(n,e,t){if(!t)throw new M(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jw(n,e,t,r){if(e===!0&&r===!0)throw new M(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function np(n){if(!$.isDocumentKey(n))throw new M(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Xu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function Fu(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Xu(n);throw new M(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Ws=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lp((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},di=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ws({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ws(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Sc;switch(r.type){case"firstParty":return new Pc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return b(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=tp.get(t);r&&(O("ComponentProvider","Removing Datastore"),tp.delete(t),r.terminate())}(this),Promise.resolve()}};function Fp(n,e,t,r={}){var i;let o=(n=Fu(n,di))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&Os("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,l;if(typeof r.mockUserToken=="string")u=r.mockUserToken,l=fe.MOCK_USER;else{u=Gd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new M(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new fe(f)}n._authCredentials=new bc(new xs(u,l))}}var Uu=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},mt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},fi=class n extends Uu{constructor(e,t,r){super(e,t,GI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new mt(this.firestore,null,new $(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Up(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=Vs.newId()),Bw("doc","path",e),n instanceof di){let r=pe.fromString(e,...t);return np(r),new mt(n,null,new $(r))}{if(!(n instanceof mt||n instanceof fi))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return np(r),new mt(n.firestore,n instanceof fi?n.converter:null,new $(r))}}var Ks=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Gs(this,"async_queue_retry"),this.Vu=()=>{let r=Tc();r&&O("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Tc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Tc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new gt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return b(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!eo(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw nn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=xu.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&B()}verifyOperationInProgress(){}wu(){return b(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};var Hs=class extends di{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ks,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return b(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ks(e),this._firestoreClient=void 0,yield e}})}};function $p(n,e){let t=typeof n=="object"?n:Gr(),r=typeof n=="string"?n:e||"(default)",i=Ya(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=jd("firestore");o&&Fp(i,...o)}return i}function zw(n){if(n._terminated)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Gw(n),n._firestoreClient}function Gw(n){var e,t,r;let i=n._freezeSettings(),o=function(u,l,f,_){return new Vc(u,l,f,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Lp(_.experimentalLongPollingOptions),_.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Lu(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(u){let l=u?._online.build();return{_offline:u?._offline.build(l),_online:l}}(n._componentsProvider))}var Qs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(_t.fromBase64String(e))}catch(t){throw new M(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Js=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var pi=class{constructor(e){this._methodName=e}};var Ys=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var Xs=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var Ww=/^__.*__$/,$u=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new yt(e,this.data,this.fieldMask,t,this.fieldTransforms):new cn(e,this.data,t,this.fieldTransforms)}};function qp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var qu=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Zs(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(qp(this.Cu)&&Ww.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Bu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||to(e)}Qu(e,t,r,i=!1){return new qu({Cu:e,methodName:t,qu:r,path:Me.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Kw(n){let e=n._freezeSettings(),t=to(n._databaseId);return new Bu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Hw(n,e,t,r,i,o={}){let a=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);Gp("Data must be an object, but it was:",a,r);let u=jp(r,a),l,f;if(o.merge)l=new rt(a.fieldMask),f=a.fieldTransforms;else if(o.mergeFields){let _=[];for(let E of o.mergeFields){let S=Qw(e,E,t);if(!a.contains(S))throw new M(R.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);Xw(_,S)||_.push(S)}l=new rt(_),f=a.fieldTransforms.filter(E=>l.covers(E.field))}else l=null,f=a.fieldTransforms;return new $u(new nt(u),l,f)}var ju=class n extends pi{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new an(e.serializer,Ip(e.serializer,this.$u));return new Qc(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function Bp(n,e){if(zp(n=Ze(n)))return Gp("Unsupported field value:",e,n),jp(n,e);if(n instanceof pi)return function(r,i){if(!qp(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let l=Bp(u,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ip(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Ae.fromDate(r);return{timestampValue:nu(i.serializer,o)}}if(r instanceof Ae){let o=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:nu(i.serializer,o)}}if(r instanceof Ys)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qs)return{bytesValue:cw(i.serializer,r._byteString)};if(r instanceof mt){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Rp(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Xs)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw u.Bu("VectorValues must only contain numeric values.");return Yu(u.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Xu(r)}`)}(n,e)}function jp(n,e){let t={};return ip(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gi(n,(r,i)=>{let o=Bp(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function zp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ae||n instanceof Ys||n instanceof Qs||n instanceof mt||n instanceof pi||n instanceof Xs)}function Gp(n,e,t){if(!zp(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Xu(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Qw(n,e,t){if((e=Ze(e))instanceof Js)return e._internalPath;if(typeof e=="string")return Yw(n,e);throw Zs("Field path arguments must be of type string or ",n,!1,void 0,t)}var Jw=new RegExp("[~\\*/\\[\\]]");function Yw(n,e,t){if(e.search(Jw)>=0)throw Zs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Js(...e.split("."))._internalPath}catch{throw Zs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Zs(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(o||a)&&(l+=" (found",o&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new M(R.INVALID_ARGUMENT,u+n+l)}function Xw(n,e){return n.some(t=>t.isEqual(e))}function Zw(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function Wp(n,e,t){n=Fu(n,mt);let r=Fu(n.firestore,Hs),i=Zw(n.converter,e,t);return eE(r,[Hw(Kw(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,en.none())])}function eE(n,e){return function(r,i){let o=new gt;return r.asyncQueue.enqueueAndForget(()=>b(this,null,function*(){return Ow(yield qw(r),i,o)})),o.promise}(zw(n),e)}function Kp(n){return new ju("increment",n)}(function(e,t=!0){(function(i){Jn=i})(kn),kt(new qe("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new Hs(new Rc(r.getProvider("auth-internal")),new kc(r.getProvider("app-check-internal")),function(f,_){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new M(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mc(f.options.projectId,_)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),de(Vf,"4.7.3",e),de(Vf,"4.7.3","esm2017")})();var yi=class{constructor(e){return e}},Hp="firestore",Zu=class{constructor(){return Kr(Hp)}};var el=new _e("angularfire2.firestore-instances");function tE(n,e){let t=ec(Hp,n,e);return t&&new yi(t)}function nE(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new yi(r)}}var rE={provide:Zu,deps:[[new Qe,el]]},iE={provide:yi,useFactory:tE,deps:[[new Qe,el],Qt]};function lb(n,...e){return de("angularfire",On.full,"fst"),mn([iE,rE,{provide:el,useFactory:nE(n),multi:!0,deps:[ut,jt,Hr,Qr,[new Qe,Ss],[new Qe,Wr],...e]}])}var hb=Nt(Up,!0);var db=Nt($p,!0);var fb=Nt(Kp,!0);var pb=Nt(Wp,!0);export{sm as a,Xe as b,ed as c,SE as d,bE as e,RE as f,mT as g,_T as h,yi as i,lb as j,hb as k,db as l,fb as m,pb as n};
